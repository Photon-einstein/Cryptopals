<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2704px" preserveAspectRatio="none" style="width:3297px;height:2704px;background:#FFFFFF;" version="1.1" viewBox="0 0 3297 2704" width="3297px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="2692.5412" style="stroke:#181818;stroke-width:0.5;" width="1815" x="16" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="859.5" y="19.897">Client Environment</text><rect fill="#ADD8E6" height="2692.5412" style="stroke:#181818;stroke-width:0.5;" width="1363" x="1833" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131" x="2449" y="19.897">Server Environment</text><rect fill="#FFFFFF" height="2564.6993" style="stroke:#181818;stroke-width:1.0;" width="10" x="76.5" y="71.7739"/><rect fill="#FFFFFF" height="2556.9933" style="stroke:#181818;stroke-width:1.0;" width="10" x="517.5" y="95.4799"/><rect fill="#FFFFFF" height="2091.403" style="stroke:#181818;stroke-width:1.0;" width="10" x="522.5" y="515.3642"/><rect fill="#FFFFFF" height="179.2361" style="stroke:#181818;stroke-width:1.0;" width="10" x="527.5" y="2298.4312"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="948.5" y="127.186"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="953.5" y="259.363"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="953.5" y="378.1871"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="948.5" y="1902.4"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="1317.5" y="170.745"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="301.4221"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="420.2461"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="1782.4289"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="1945.959"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="2068.4891"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="2131.9011"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="2195.3131"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="1738" y="547.0702"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1738" y="2335.1372"/><rect fill="#FFFFFF" height="1043.4166" style="stroke:#181818;stroke-width:1.0;" width="10" x="1877.5" y="651.8943"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="2303.5" y="802.4243"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2308.5" y="934.6014"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2308.5" y="1053.4255"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="2303.5" y="1202.4556"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="2672.5" y="845.9834"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="976.6604"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1095.4845"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1246.0146"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1368.5447"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1431.9567"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1495.3687"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="3101" y="739.0123"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="3101" y="1590.4868"/><rect fill="none" height="100.0999" style="stroke:#000000;stroke-width:1.5;" width="568" x="10" y="2499.6673"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="81" x2="81" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="522" x2="522" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="953" x2="953" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1322" x2="1322" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1534" x2="1534" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1743" x2="1743" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1882" x2="1882" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2308" x2="2308" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2677" x2="2677" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2893" x2="2893" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3106" x2="3106" y1="61.7739" y2="2661.4732"/><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="20" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="27" y="49.672">main (runClient)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="20" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="27" y="2682.4392">main (runClient)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="477" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="484" y="49.672">Client (Bob)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="477" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="484" y="2682.4392">Client (Bob)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="149" x="879" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="886" y="49.672">Client:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="149" x="879" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="886" y="2682.4392">Client:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="1236" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="1243" y="49.672">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="1236" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="1243" y="2682.4392">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="1419" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="1426" y="49.672">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="1419" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="1426" y="2682.4392">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1659" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="1666" y="49.672">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1659" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="1666" y="2682.4392">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="1837" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1844" y="49.672">Server (API)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="1837" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1844" y="2682.4392">Server (API)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="2232" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2239" y="49.672">Server:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="2232" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2239" y="2682.4392">Server:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="177" x="2589" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="2596" y="49.672">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="177" x="2589" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="2596" y="2682.4392">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="2776" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="2783" y="49.672">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="2776" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="2783" y="2682.4392">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="3020" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="3027" y="49.672">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="3020" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="3027" y="2682.4392">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="2564.6993" style="stroke:#181818;stroke-width:1.0;" width="10" x="76.5" y="71.7739"/><rect fill="#FFFFFF" height="2556.9933" style="stroke:#181818;stroke-width:1.0;" width="10" x="517.5" y="95.4799"/><rect fill="#FFFFFF" height="2091.403" style="stroke:#181818;stroke-width:1.0;" width="10" x="522.5" y="515.3642"/><rect fill="#FFFFFF" height="179.2361" style="stroke:#181818;stroke-width:1.0;" width="10" x="527.5" y="2298.4312"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="948.5" y="127.186"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="953.5" y="259.363"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="953.5" y="378.1871"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="948.5" y="1902.4"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="1317.5" y="170.745"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="301.4221"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="420.2461"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="1782.4289"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="1945.959"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="2068.4891"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="2131.9011"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1529" y="2195.3131"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="1738" y="547.0702"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1738" y="2335.1372"/><rect fill="#FFFFFF" height="1043.4166" style="stroke:#181818;stroke-width:1.0;" width="10" x="1877.5" y="651.8943"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="2303.5" y="802.4243"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2308.5" y="934.6014"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2308.5" y="1053.4255"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="2303.5" y="1202.4556"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="2672.5" y="845.9834"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="976.6604"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1095.4845"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1246.0146"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1368.5447"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1431.9567"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2888" y="1495.3687"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="3101" y="739.0123"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="3101" y="1590.4868"/><polygon fill="#181818" points="505.5,91.4799,515.5,95.4799,505.5,99.4799,509.5,95.4799" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="511.5" y1="95.4799" y2="95.4799"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="93.5" y="89.6709">Create Client("Bob", debugFlag)</text><polygon fill="#181818" points="936.5,123.186,946.5,127.186,936.5,131.186,940.5,127.186" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="527.5" x2="942.5" y1="127.186" y2="127.186"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="534.5" y="121.377">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="1305.5,166.745,1315.5,170.745,1305.5,174.745,1309.5,170.745" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1311.5" y1="170.745" y2="170.745"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340" x="965.5" y="164.936">loadDhParameters(getDhParametersFilenameLocation())</text><path d="M1332,140.186 L1332,185.186 L1647,185.186 L1647,150.186 L1637,140.186 L1332,140.186 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1637,140.186 L1637,150.186 L1647,150.186 L1637,140.186 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="1338" y="159.083">Client DHParamsLoader reads "rfc3526-group-17"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1338" y="176.789">p and g from file</text><polygon fill="#181818" points="969.5,210.304,959.5,214.304,969.5,218.304,965.5,214.304" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1321.5" y1="214.304" y2="214.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="975.5" y="208.495">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1005.5" y1="246.363" y2="246.363"/><line style="stroke:#181818;stroke-width:1.0;" x1="1005.5" x2="1005.5" y1="246.363" y2="259.363"/><line style="stroke:#181818;stroke-width:1.0;" x1="964.5" x2="1005.5" y1="259.363" y2="259.363"/><polygon fill="#181818" points="974.5,255.363,964.5,259.363,974.5,263.363,970.5,259.363" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="970.5" y="240.554">generatePrivateKey()</text><path d="M1108,227.304 L1108,272.304 L1410,272.304 L1410,237.304 L1400,227.304 L1108,227.304 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1400,227.304 L1400,237.304 L1410,237.304 L1400,227.304 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="1114" y="246.201">Client uses OpenSSL's BN_rand_range to get 'a'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1114" y="263.907">Ensures 1 &lt; a &lt; p-1</text><polygon fill="#181818" points="1517,297.4221,1527,301.4221,1517,305.4221,1521,301.4221" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="963.5" x2="1523" y1="301.4221" y2="301.4221"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="970.5" y="295.6131">hexToUniqueBIGNUM(p)</text><polygon fill="#181818" points="969.5,329.1281,959.5,333.1281,969.5,337.1281,965.5,333.1281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1533" y1="333.1281" y2="333.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="975.5" y="327.3191">UniqueBIGNUM</text><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1005.5" y1="365.1871" y2="365.1871"/><line style="stroke:#181818;stroke-width:1.0;" x1="1005.5" x2="1005.5" y1="365.1871" y2="378.1871"/><line style="stroke:#181818;stroke-width:1.0;" x1="964.5" x2="1005.5" y1="378.1871" y2="378.1871"/><polygon fill="#181818" points="974.5,374.1871,964.5,378.1871,974.5,382.1871,970.5,378.1871" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="970.5" y="359.3781">generatePublicKey()</text><path d="M1102,346.1281 L1102,391.1281 L1301,391.1281 L1301,356.1281 L1291,346.1281 L1102,346.1281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1291,346.1281 L1291,356.1281 L1301,356.1281 L1291,346.1281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1108" y="365.0251">Client computes A = (g^a) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="1108" y="382.7311">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="1517,416.2461,1527,420.2461,1517,424.2461,1521,420.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="963.5" x2="1523" y1="420.2461" y2="420.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="970.5" y="414.4371">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="969.5,447.9521,959.5,451.9521,969.5,455.9521,965.5,451.9521" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1533" y1="451.9521" y2="451.9521"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="975.5" y="446.1431">Public Key A (hex)</text><polygon fill="#181818" points="538.5,479.6582,528.5,483.6582,538.5,487.6582,534.5,483.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="532.5" x2="952.5" y1="483.6582" y2="483.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="544.5" y="477.8492">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="510.5,511.3642,520.5,515.3642,510.5,519.3642,514.5,515.3642" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="516.5" y1="515.3642" y2="515.3642"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="93.5" y="509.5552">diffieHellmanKeyExchange(productionPort)</text><polygon fill="#181818" points="1726,543.0702,1736,547.0702,1726,551.0702,1730,547.0702" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="1732" y1="547.0702" y2="547.0702"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="539.5" y="541.2612">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="543.5,595.4822,533.5,599.4822,543.5,603.4822,539.5,599.4822" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537.5" x2="1742" y1="599.4822" y2="599.4822"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="549.5" y="593.6732">clientNonceHex</text><path d="M277,560.0702 L277,623.0702 L512,623.0702 L512,570.0702 L502,560.0702 L277,560.0702 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M502,560.0702 L502,570.0702 L512,570.0702 L502,560.0702 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="283" y="578.9672">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="283" y="596.6732">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="283" y="614.3792">groupName, publicKeyA</text><polygon fill="#181818" points="1865.5,647.8943,1875.5,651.8943,1865.5,655.8943,1869.5,651.8943" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="1871.5" y1="651.8943" y2="651.8943"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="539.5" y="646.0853">HTTP POST /keyExchange (ClientHello JSON)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1887.5" x2="1929.5" y1="688.9533" y2="688.9533"/><line style="stroke:#181818;stroke-width:1.0;" x1="1929.5" x2="1929.5" y1="688.9533" y2="701.9533"/><line style="stroke:#181818;stroke-width:1.0;" x1="1888.5" x2="1929.5" y1="701.9533" y2="701.9533"/><polygon fill="#181818" points="1898.5,697.9533,1888.5,701.9533,1898.5,705.9533,1894.5,701.9533" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="1894.5" y="683.1443">Parse ClientHello JSON</text><path d="M2041,664.8943 L2041,709.8943 L2278,709.8943 L2278,674.8943 L2268,664.8943 L2041,664.8943 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2268,664.8943 L2268,674.8943 L2278,674.8943 L2268,664.8943 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="2047" y="683.7913">Server extracts clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="2047" y="701.4973">publicKeyA from client request.</text><polygon fill="#181818" points="3089,735.0123,3099,739.0123,3089,743.0123,3093,739.0123" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1887.5" x2="3095" y1="739.0123" y2="739.0123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="1894.5" y="733.2033">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="1898.5,766.7183,1888.5,770.7183,1898.5,774.7183,1894.5,770.7183" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1892.5" x2="3105" y1="770.7183" y2="770.7183"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="1904.5" y="764.9093">serverNonceHex</text><polygon fill="#181818" points="2291.5,798.4243,2301.5,802.4243,2291.5,806.4243,2295.5,802.4243" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1887.5" x2="2297.5" y1="802.4243" y2="802.4243"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="1894.5" y="796.6153">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="2660.5,841.9834,2670.5,845.9834,2660.5,849.9834,2664.5,845.9834" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2666.5" y1="845.9834" y2="845.9834"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340" x="2320.5" y="840.1744">loadDhParameters(getDhParametersFilenameLocation())</text><path d="M2687,815.4243 L2687,860.4243 L3006,860.4243 L3006,825.4243 L2996,815.4243 L2687,815.4243 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2996,815.4243 L2996,825.4243 L3006,825.4243 L2996,815.4243 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="2693" y="834.3214">Server DHParamsLoader reads "rfc3526-group-17"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="2693" y="852.0274">p and g from file (must match client's)</text><polygon fill="#181818" points="2324.5,885.5424,2314.5,889.5424,2324.5,893.5424,2320.5,889.5424" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2676.5" y1="889.5424" y2="889.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="2330.5" y="883.7334">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2360.5" y1="921.6014" y2="921.6014"/><line style="stroke:#181818;stroke-width:1.0;" x1="2360.5" x2="2360.5" y1="921.6014" y2="934.6014"/><line style="stroke:#181818;stroke-width:1.0;" x1="2319.5" x2="2360.5" y1="934.6014" y2="934.6014"/><polygon fill="#181818" points="2329.5,930.6014,2319.5,934.6014,2329.5,938.6014,2325.5,934.6014" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="2325.5" y="915.7924">generatePrivateKey()</text><path d="M2463,902.5424 L2463,947.5424 L2770,947.5424 L2770,912.5424 L2760,902.5424 L2463,902.5424 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2760,902.5424 L2760,912.5424 L2770,912.5424 L2760,902.5424 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="2469" y="921.4394">Server uses OpenSSL's BN_rand_range to get 'b'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="2469" y="939.1454">Ensures 1 &lt; b &lt; p-1</text><polygon fill="#181818" points="2876,972.6604,2886,976.6604,2876,980.6604,2880,976.6604" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2318.5" x2="2882" y1="976.6604" y2="976.6604"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="2325.5" y="970.8514">hexToUniqueBIGNUM(p)</text><polygon fill="#181818" points="2324.5,1004.3665,2314.5,1008.3665,2324.5,1012.3665,2320.5,1008.3665" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2892" y1="1008.3665" y2="1008.3665"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="2330.5" y="1002.5575">UniqueBIGNUM</text><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2360.5" y1="1040.4255" y2="1040.4255"/><line style="stroke:#181818;stroke-width:1.0;" x1="2360.5" x2="2360.5" y1="1040.4255" y2="1053.4255"/><line style="stroke:#181818;stroke-width:1.0;" x1="2319.5" x2="2360.5" y1="1053.4255" y2="1053.4255"/><polygon fill="#181818" points="2329.5,1049.4255,2319.5,1053.4255,2329.5,1057.4255,2325.5,1053.4255" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="2325.5" y="1034.6165">generatePublicKey()</text><path d="M2457,1021.3665 L2457,1066.3665 L2659,1066.3665 L2659,1031.3665 L2649,1021.3665 L2457,1021.3665 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2649,1021.3665 L2649,1031.3665 L2659,1031.3665 L2649,1021.3665 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="2463" y="1040.2635">Server computes B = (g^b) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="2463" y="1057.9695">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="2876,1091.4845,2886,1095.4845,2876,1099.4845,2880,1095.4845" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2318.5" x2="2882" y1="1095.4845" y2="1095.4845"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="2325.5" y="1089.6755">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2324.5,1123.1905,2314.5,1127.1905,2324.5,1131.1905,2320.5,1127.1905" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2892" y1="1127.1905" y2="1127.1905"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="2330.5" y="1121.3815">Public Key B (hex)</text><polygon fill="#181818" points="1898.5,1154.8965,1888.5,1158.8965,1898.5,1162.8965,1894.5,1158.8965" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1892.5" x2="2307.5" y1="1158.8965" y2="1158.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="1904.5" y="1153.0875">Server:DiffieHellman instance ready</text><polygon fill="#181818" points="2291.5,1198.4556,2301.5,1202.4556,2291.5,1206.4556,2295.5,1202.4556" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1887.5" x2="2297.5" y1="1202.4556" y2="1202.4556"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="1894.5" y="1196.6466">deriveSharedSecret(publicKeyA, serverNonceHex, clientNonceHex)</text><path d="M2318,1171.8965 L2318,1216.8965 L2732,1216.8965 L2732,1181.8965 L2722,1171.8965 L2318,1171.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2722,1171.8965 L2722,1181.8965 L2732,1181.8965 L2722,1171.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="2324" y="1190.7936">Server computes shared secret s' = (publicKeyA ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="2324" y="1208.4996">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="2876,1242.0146,2886,1246.0146,2876,1250.0146,2880,1246.0146" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2882" y1="1246.0146" y2="1246.0146"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="2320.5" y="1240.2056">hexToUniqueBIGNUM(publicKeyA)</text><polygon fill="#181818" points="2324.5,1303.2796,2314.5,1307.2796,2324.5,1311.2796,2320.5,1307.2796" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2892" y1="1307.2796" y2="1307.2796"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="2330.5" y="1301.4706">UniqueBIGNUM</text><path d="M2903,1259.0146 L2903,1339.0146 L3290,1339.0146 L3290,1269.0146 L3280,1259.0146 L2903,1259.0146 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3280,1259.0146 L3280,1269.0146 L3290,1269.0146 L3280,1259.0146 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="2909" y="1277.9116">Converts s' to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="2909" y="1295.6176">Converts nonces to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="2909" y="1313.3236">Concatenates s' || clientNonce || serverNonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366" x="2909" y="1331.0297">Hashes concatenated data with SHA256 to get symmetric key</text><polygon fill="#181818" points="2876,1364.5447,2886,1368.5447,2876,1372.5447,2880,1368.5447" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2882" y1="1368.5447" y2="1368.5447"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="2320.5" y="1362.7357">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="2324.5,1396.2507,2314.5,1400.2507,2324.5,1404.2507,2320.5,1400.2507" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2892" y1="1400.2507" y2="1400.2507"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="2330.5" y="1394.4417">serverNonceBytes</text><polygon fill="#181818" points="2876,1427.9567,2886,1431.9567,2876,1435.9567,2880,1431.9567" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2882" y1="1431.9567" y2="1431.9567"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="2320.5" y="1426.1477">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="2324.5,1459.6627,2314.5,1463.6627,2324.5,1467.6627,2320.5,1463.6627" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2892" y1="1463.6627" y2="1463.6627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="2330.5" y="1457.8537">clientNonceBytes</text><polygon fill="#181818" points="2876,1491.3687,2886,1495.3687,2876,1499.3687,2880,1495.3687" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2313.5" x2="2882" y1="1495.3687" y2="1495.3687"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="2320.5" y="1489.5597">toHexString(keyMaterial)</text><polygon fill="#181818" points="2324.5,1523.0748,2314.5,1527.0748,2324.5,1531.0748,2320.5,1527.0748" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2318.5" x2="2892" y1="1527.0748" y2="1527.0748"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="2330.5" y="1521.2658">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="1898.5,1554.7808,1888.5,1558.7808,1898.5,1562.7808,1894.5,1558.7808" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1892.5" x2="2307.5" y1="1558.7808" y2="1558.7808"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="1904.5" y="1552.9718">_derivedSymmetricKeyHex (symmetric key)</text><polygon fill="#181818" points="3089,1586.4868,3099,1590.4868,3089,1594.4868,3093,1590.4868" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1887.5" x2="3095" y1="1590.4868" y2="1590.4868"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="479" x="1894.5" y="1584.6778">encryptMessageAes256CbcMode(confirmationMsg, symmetricKey, generatedIv)</text><polygon fill="#181818" points="1898.5,1638.8988,1888.5,1642.8988,1898.5,1646.8988,1894.5,1642.8988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1892.5" x2="3105" y1="1642.8988" y2="1642.8988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1904.5" y="1637.0898">ciphertext, ivHex</text><path d="M1598,1603.4868 L1598,1666.4868 L1872,1666.4868 L1872,1613.4868 L1862,1603.4868 L1598,1603.4868 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1862,1603.4868 L1862,1613.4868 L1872,1613.4868 L1862,1603.4868 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="1604" y="1622.3838">Server constructs JSON response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="1604" y="1640.0898">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="1604" y="1657.7958">encrypted confirmation (ciphertext, ivHex)</text><polygon fill="#181818" points="543.5,1691.3109,533.5,1695.3109,543.5,1699.3109,539.5,1695.3109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537.5" x2="1881.5" y1="1695.3109" y2="1695.3109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="549.5" y="1689.5019">HTTP 201 OK (ServerHello JSON)</text><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="574.5" y1="1732.3699" y2="1732.3699"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="574.5" y1="1732.3699" y2="1745.3699"/><line style="stroke:#181818;stroke-width:1.0;" x1="533.5" x2="574.5" y1="1745.3699" y2="1745.3699"/><polygon fill="#181818" points="543.5,1741.3699,533.5,1745.3699,543.5,1749.3699,539.5,1745.3699" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="539.5" y="1726.5609">Parse ServerHello JSON response</text><path d="M748,1708.3109 L748,1753.3109 L1021,1753.3109 L1021,1718.3109 L1011,1708.3109 L748,1708.3109 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011,1708.3109 L1011,1718.3109 L1021,1718.3109 L1011,1708.3109 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="754" y="1727.2079">Client extracts sessionId, serverNonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="754" y="1744.9139">groupName, publicKeyB, ciphertext, ivHex</text><polygon fill="#181818" points="1517,1778.4289,1527,1782.4289,1517,1786.4289,1521,1782.4289" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="1523" y1="1782.4289" y2="1782.4289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="539.5" y="1776.6199">hexToBytes(ivHex)</text><polygon fill="#181818" points="543.5,1810.1349,533.5,1814.1349,543.5,1818.1349,539.5,1814.1349" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537.5" x2="1533" y1="1814.1349" y2="1814.1349"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="549.5" y="1808.3259">iv (vector&lt;uint8_t&gt;)</text><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="574.5" y1="1845.8409" y2="1845.8409"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="574.5" y1="1845.8409" y2="1858.8409"/><line style="stroke:#181818;stroke-width:1.0;" x1="533.5" x2="574.5" y1="1858.8409" y2="1858.8409"/><polygon fill="#181818" points="543.5,1854.8409,533.5,1858.8409,543.5,1862.8409,539.5,1858.8409" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="539.5" y="1840.0319">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="936.5,1898.4,946.5,1902.4,936.5,1906.4,940.5,1902.4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="942.5" y1="1902.4" y2="1902.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="539.5" y="1896.591">deriveSharedSecret(publicKeyB, serverNonceHex, clientNonceHex)</text><path d="M963,1871.8409 L963,1916.8409 L1370,1916.8409 L1370,1881.8409 L1360,1871.8409 L963,1871.8409 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1360,1871.8409 L1360,1881.8409 L1370,1881.8409 L1360,1871.8409 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386" x="969" y="1890.738">Client computes shared secret s = (publicKeyB ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="969" y="1908.444">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="1517,1941.959,1527,1945.959,1517,1949.959,1521,1945.959" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1523" y1="1945.959" y2="1945.959"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="965.5" y="1940.15">hexToUniqueBIGNUM(publicKeyB)</text><polygon fill="#181818" points="969.5,2003.224,959.5,2007.224,969.5,2011.224,965.5,2007.224" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1533" y1="2007.224" y2="2007.224"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="975.5" y="2001.415">UniqueBIGNUM</text><path d="M1544,1958.959 L1544,2038.959 L1843,2038.959 L1843,1968.959 L1833,1958.959 L1544,1958.959 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1833,1958.959 L1833,1968.959 L1843,1968.959 L1833,1958.959 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1550" y="1977.856">Converts s to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="1550" y="1995.562">Converts nonces to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="1550" y="2013.268">Concatenates s || clientNonce || serverNonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="1550" y="2030.9741">Hashes concatenated data with SHA256</text><polygon fill="#181818" points="1517,2064.4891,1527,2068.4891,1517,2072.4891,1521,2068.4891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1523" y1="2068.4891" y2="2068.4891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="965.5" y="2062.6801">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="969.5,2096.1951,959.5,2100.1951,969.5,2104.1951,965.5,2100.1951" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1533" y1="2100.1951" y2="2100.1951"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="975.5" y="2094.3861">serverNonceBytes</text><polygon fill="#181818" points="1517,2127.9011,1527,2131.9011,1517,2135.9011,1521,2131.9011" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1523" y1="2131.9011" y2="2131.9011"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="965.5" y="2126.0921">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="969.5,2159.6071,959.5,2163.6071,969.5,2167.6071,965.5,2163.6071" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1533" y1="2163.6071" y2="2163.6071"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="975.5" y="2157.7981">clientNonceBytes</text><polygon fill="#181818" points="1517,2191.3131,1527,2195.3131,1517,2199.3131,1521,2195.3131" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="958.5" x2="1523" y1="2195.3131" y2="2195.3131"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="965.5" y="2189.5041">toHexString(keyMaterial)</text><polygon fill="#181818" points="969.5,2223.0192,959.5,2227.0192,969.5,2231.0192,965.5,2227.0192" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="963.5" x2="1533" y1="2227.0192" y2="2227.0192"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="975.5" y="2221.2102">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="543.5,2254.7252,533.5,2258.7252,543.5,2262.7252,539.5,2258.7252" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537.5" x2="952.5" y1="2258.7252" y2="2258.7252"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="549.5" y="2252.9162">_derivedSymmetricKeyHex</text><line style="stroke:#181818;stroke-width:1.0;" x1="532.5" x2="579.5" y1="2285.4312" y2="2285.4312"/><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="579.5" y1="2285.4312" y2="2298.4312"/><line style="stroke:#181818;stroke-width:1.0;" x1="538.5" x2="579.5" y1="2298.4312" y2="2298.4312"/><polygon fill="#181818" points="548.5,2294.4312,538.5,2298.4312,548.5,2302.4312,544.5,2298.4312" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="544.5" y="2279.6222">confirmationServerResponse(...)</text><polygon fill="#181818" points="1726,2331.1372,1736,2335.1372,1726,2339.1372,1730,2335.1372" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="537.5" x2="1732" y1="2335.1372" y2="2335.1372"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="544.5" y="2329.3282">decryptMessageAes256CbcMode(ciphertext, derivedKey, iv)</text><polygon fill="#181818" points="548.5,2362.8432,538.5,2366.8432,548.5,2370.8432,544.5,2366.8432" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="542.5" x2="1742" y1="2366.8432" y2="2366.8432"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="554.5" y="2361.0342">decryptedPlaintext</text><line style="stroke:#181818;stroke-width:1.0;" x1="537.5" x2="579.5" y1="2412.7553" y2="2412.7553"/><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="579.5" y1="2412.7553" y2="2425.7553"/><line style="stroke:#181818;stroke-width:1.0;" x1="538.5" x2="579.5" y1="2425.7553" y2="2425.7553"/><polygon fill="#181818" points="548.5,2421.7553,538.5,2425.7553,548.5,2429.7553,544.5,2425.7553" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="544.5" y="2406.9463">Parse decryptedPlaintext (JSON)</text><path d="M748,2379.8432 L748,2442.8432 L991,2442.8432 L991,2389.8432 L981,2379.8432 L748,2379.8432 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M981,2379.8432 L981,2389.8432 L991,2389.8432 L981,2379.8432 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="754" y="2398.7402">Compares extracted fields</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="754" y="2416.4463">(sessionId, clientId, nonces, message)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="754" y="2434.1523">with expected values.</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="537.5" x2="579.5" y1="2476.6673" y2="2476.6673"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="579.5" y1="2476.6673" y2="2489.6673"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="532.5" x2="579.5" y1="2489.6673" y2="2489.6673"/><polygon fill="#181818" points="542.5,2485.6673,532.5,2489.6673,542.5,2493.6673,538.5,2489.6673" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="544.5" y="2470.8583">(bool validationResult, string decryptedMessage)</text><path d="M10,2499.6673 L73,2499.6673 L73,2509.3733 L63,2519.3733 L10,2519.3733 L10,2499.6673 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="100.0999" style="stroke:#000000;stroke-width:1.5;" width="568" x="10" y="2499.6673"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="25" y="2514.5643">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="139" x="88" y="2513.4262">[validationResult == true]</text><polygon fill="#181818" points="97.5,2539.0793,87.5,2543.0793,97.5,2547.0793,93.5,2543.0793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="91.5" x2="521.5" y1="2543.0793" y2="2543.0793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407" x="103.5" y="2537.2703">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="578" y1="2552.0793" y2="2552.0793"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141" x="15" y="2563.8382">[validationResult == false]</text><polygon fill="#181818" points="97.5,2587.7672,87.5,2591.7672,97.5,2595.7672,93.5,2591.7672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="91.5" x2="521.5" y1="2591.7672" y2="2591.7672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="103.5" y="2585.9582">Logs "Diffie Hellman key exchange failed"</text><line style="stroke:#181818;stroke-width:1.0;" x1="86.5" x2="128.5" y1="2635.4732" y2="2635.4732"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="128.5" y1="2635.4732" y2="2648.4732"/><line style="stroke:#181818;stroke-width:1.0;" x1="81.5" x2="128.5" y1="2648.4732" y2="2648.4732"/><polygon fill="#181818" points="91.5,2644.4732,81.5,2648.4732,91.5,2652.4732,87.5,2648.4732" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="93.5" y="2629.6642">Program ends</text><!--SRC=[lLbjRzis4FxkNq5u62m3JhPsQ3SKRO4eSUQiSMBKoOTzgK5Bj2nCRoCbnndwutSKzK9AfApOsGB4y0llUFVSyUxXQHtlqV0oy4cKeccqysaSXV1-Y7wuzRrj-YS9WlXfWE0lmJJr7J_1i78OOZz25iqY8JeU8ipG7BviBosKMtQy5il45wQ57wxypSOdCzWun94aS3KpYymMcEAGtSRO9LIH4LyP9UU4CUoHwJwbs4dzEBh6ZX_uwREaP3wzDifF8uS-9rpmCMtAJHy797BHEjuF1ciEyvBG7Q4wcEqW8-qzYlNMnU9682U-W8-cjHhmn0ywy4gHDdYbZ0cyGh8RFB582ruXhmTF_2Y3nvNlS4f4WWtuAphxNA2CFg1BIlYluhCrX4GRJf1Brfbt7M1lNCiNcJSe92iTLxDQYuAWPTPI85efa9G9s41b06-kjZcy92MKMHv9vS_NVa0YU7yREvZ3O8t7kTBMLb8W-5yKms-K9qxrLMqBKWEAm2sNeI7TEB-yU_l-pADnbfoz-NMeY2O80zeUsj0uH1img_gLHu7lftXRg3vJ4VnAqen6h3GWTn65ECb5NMBooeWZgFH8H2Z8B6Wk-eKyMmQ8UeAJCSBGVKAYvV9sn91zjwBWEN_n24fZs3158pnIHASHooY8lK4V4OP_W4yFZzuHE0BWoPRi7-B7oFyx8_RDxtUFSoiPLq8DRyf3K-lZEXfeoxggrIsKIrKQ-Fi1dwq3tpaTToSEaom542_G9sHvt_0O_OWIPULZApHXxAx8Fdavs0ALXtX6zjOgALquX-2MH-nOr0KU2BI19nO4TNmSzhNbIYNJj43aHop5aKFoa_myq4QoLHDTMGLOEzqxMvxZLa9ZDykhzIAcQRiuIZ6hz4qVfOouv3KxzYXEjhvp5uDXLiHVb_u_H9iZKCfhfQ1AyTZ9t-Hg85Xwk431eCgmW6pIGIkv028ANZ7qn_B-3Ws5rjMMivUwq3tvwRROyCQTo5jFgZLvURo3uZL1LTvS39JaQq1KDMNmPlRmi42B- -K3-kcl6dDaYTKy6d5kOGEdkgzNTjHQ6rj0QMKbCBN2GwUme194j6fs28My9LJkYwuW5a8IGjLXwNdxK7RP_i8Cqg1JP56jlyWa6HkMlrUIgP5GbQukOtlH0OEPKa6ijOi2fRAg4-Y1SUi6JJYG4utSE8Os6Ea3iiACfT3yKwSySYCsRics2hgCcKGofBXqaWnZn5MoqHMTBjBHB-Rz8Uz5HjOZhGgPbAmRfAGJNhtZFKYAmNkvRQhwo_OfGQibBSQeDLLhmlgoW3R8p6l7io8vjY0vwpR9wKzsZWvYF_Bp6j6Ko93T84CdnRJjOQFGwswxJPxKcJG7op_K2dz7bbjCYRia3WNmweOuQNIQIOF6zEqE7LdLp2YMMmBxSbCG6_44aphqDvHKnShMPrs_ZEkio3tAHMLIvmbh9i7BwuKsh_g2Unb7804q2724Caln4re_0yhcXJa_OGSNGv-6Zft7QuI-VvVJWd-KigObFSDi2t9EhSH5BawnOAtBsSNRT-_Bdi2UGsXy58uUiCmJmsTpNomrdrydTf9EkmNOuVZriDfqwawnMjBvcbQdl1ml8MQHPq7Gvg22-ZXu7PjNebgvop8lu03A1FXW8JOMMeDcP2afE1xqwj2cUm4HSy1Yd7X16AJwvTgPnownu3niV1hc_7VEl4cT-s39fEhixitkf9i3J2QtSD3XVZH1_gxtvQ5z8rLgjteh1RQMm5VgsSnFDrHc1lxnwvXqQAGRg3rfdF8SCAWGCZp8QdanDjpIf4Z8b_7y-lhsvpVe_Wkon9hcdRK5HtLhRGuDghjgKv4AXAPC5_BLPTK0J-UTtPuOOcgwnhTcTQB4I30QfZkwKH7ey7V8sX4dZUd7p8_ItrRfv_70E2Oo8RW4UOvW3i0LRmSmvrafmvrvSVVH3hMxQ8pTZyQSFF5hK1U5kTWASxduJuU27Mp5_hz6iGUngvY9cMlq9YKg8Na17-d3HOx4lvjk70E-aMPq1w27bGT9_GkiDDAAuwmyI2UEiV4GZJ0EkFN3x2vr1nv7A3LGxd6Ybtmj6eXrVdwkBLBDLg9EibtImJUafb7OdnCDVsV4Lk8N-XbtiHzn5m6CwRbkCwGokp1srBP2PDKjkhEyXF0W5evsqLlXN4CZ2LorRbXImwq7nQBQJ50eO1ktQGnKPPBht65uditEkvuXgWXPwpWEk9Zlvc6606S1H83b6LxxEvVtRc4daCD1sjA4Fdr2GCM81jhyoSa7T1jxCEqK0mLKJXJWP85JnH2VPOv3Y3lCHvsLHIKSWbi441pTtXiSi9Csts0Oghh3ai4CDBwNZu0AdGlA9-mXNytavVapz7y1]--></g></svg>