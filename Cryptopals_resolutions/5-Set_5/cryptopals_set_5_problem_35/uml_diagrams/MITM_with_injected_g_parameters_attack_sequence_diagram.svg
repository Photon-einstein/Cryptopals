<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="4736px" preserveAspectRatio="none" style="width:3523px;height:4736px;background:#FFFFFF;" version="1.1" viewBox="0 0 3523 4736" width="3523px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="4730.4" style="stroke:#181818;stroke-width:0.25;" width="1182" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="64" x="567" y="9.9485">Client Environment</text><rect fill="#F08080" height="4730.4" style="stroke:#181818;stroke-width:0.25;" width="1393.25" x="1191" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="73.5" x="1850.875" y="9.9485">Attacker Environment</text><rect fill="#ADD8E6" height="4730.4" style="stroke:#181818;stroke-width:0.25;" width="935" x="2585.25" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="65.5" x="3020" y="9.9485">Server Environment</text><rect fill="#FFFFFF" height="4666.4791" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="2971.1493" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="232.5891" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2750.4563"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="3062.4483"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="671.75" y="2585.4262"/><rect fill="#FFFFFF" height="232.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="35.887"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="180.564"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="217.917"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2645.4117"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2714.7502"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="933.25" y="144.858"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="236.2701"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="2683.0442"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="283.8291"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2768.8093"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3078.3013"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3110.0074"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3164.0664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4519.836"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4573.895"/><rect fill="#FFFFFF" height="2033.302" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="352.0941"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1209" y="543.1242"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="3223.4784"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1616" y="583.8302"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1042.6554"/><rect fill="#FFFFFF" height="1024.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1095.0675"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="599.6832"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="651.2423"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="688.5953"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="848.7723"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="2129.25" y="1110.9205"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1162.4795"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1199.8325"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="615.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="1126.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="507.4182"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="721.9483"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="886.9784"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="918.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="995.0964"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="1218.1855"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="769.5073"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="801.2133"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="1328.3036"/><rect fill="#FFFFFF" height="39.4855" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="2306.425"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3390.3025"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3444.3615"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3479.0675"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3533.1266"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4150.7758"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4204.8349"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4239.5409"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4293.5999"/><rect fill="#FFFFFF" height="701.5468" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="1396.5686"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1605.3047"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1990.2179"/><rect fill="#FFFFFF" height="410.7662" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="3595.5386"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="2997" y="1646.0107"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="3157.5" y="1661.8637"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3160" y="1713.4228"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3160" y="1750.7758"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="3157.5" y="1916.8793"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3157.5" y="1954.5119"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3258.5" y="1677.7167"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3366.25" y="1569.5987"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3366.25" y="1784.1288"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="1831.6878"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="1863.3938"/><rect fill="#FFFFFF" height="30.6325" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="2030.9239"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3762.3627"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3816.4217"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3870.4807"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3924.5397"/><rect fill="none" height="42.559" style="stroke:#000000;stroke-width:0.75;" width="558" x="235.5" y="86.946"/><rect fill="none" height="55.559" style="stroke:#000000;stroke-width:0.75;" width="213.75" x="1668.5" y="1257.3915"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="2994.0454"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="1188" y="3342.7435"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2582.25" y="3714.8036"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="1188" y="4036.1578"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="4405.2179"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="4597.248"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="42.5" x2="42.5" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="674" x2="674" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="751" x2="751" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="935.5" x2="935.5" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1041.5" x2="1041.5" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1146" x2="1146" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1209" x2="1209" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1618.5" x2="1618.5" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1718" x2="1718" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1882.25" x2="1882.25" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2131.75" x2="2131.75" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2316.25" x2="2316.25" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2427.25" x2="2427.25" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2537.25" x2="2537.25" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2609.75" x2="2609.75" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2999.25" x2="2999.25" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3159.75" x2="3159.75" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3260.75" x2="3260.75" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3368.75" x2="3368.75" y1="30.887" y2="4714.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3475.25" x2="3475.25" y1="30.887" y2="4714.8661"/><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="24.836">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="4725.349">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="24.836">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="4725.349">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="69.5" x="639.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="62.5" x="643" y="24.836">Client:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="69.5" x="639.5" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="62.5" x="643" y="4725.349">Client:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="714" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="717.5" y="24.836">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="714" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="717.5" y="4725.349">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="892.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="896" y="24.836">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="892.5" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="896" y="4725.349">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="984" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="987.5" y="24.836">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="984" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="987.5" y="4725.349">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="1104" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="1107.5" y="24.836">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="1104" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="1107.5" y="4725.349">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="1193" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="1196.5" y="24.836">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="1193" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="1196.5" y="4725.349">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1568.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1572" y="24.836">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1568.5" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1572" y="4725.349">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="1673.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="1677" y="24.836">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="1673.5" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="1677" y="4725.349">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1825.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1828.75" y="24.836">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1825.25" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1828.75" y="4725.349">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="2073.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="2077.25" y="24.836">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="2073.75" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="2077.25" y="4725.349">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2270.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2273.75" y="24.836">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2270.25" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2273.75" y="4725.349">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2367.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2370.75" y="24.836">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2367.25" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2370.75" y="4725.349">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2492.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2496.25" y="24.836">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2492.75" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2496.25" y="4725.349">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2587.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2590.75" y="24.836">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2587.25" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2590.75" y="4725.349">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="71.5" x="2963.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="64.5" x="2967.25" y="24.836">Server:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="71.5" x="2963.75" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="64.5" x="2967.25" y="4725.349">Server:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="3121.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="3125.25" y="24.836">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="3121.75" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="3125.25" y="4725.349">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="3216.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="3220.25" y="24.836">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="3216.75" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="3220.25" y="4725.349">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3310.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3313.75" y="24.836">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3310.25" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3313.75" y="4725.349">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3432.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3435.75" y="24.836">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3432.25" y="4714.3661"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3435.75" y="4725.349">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="4666.4791" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="2971.1493" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="232.5891" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2750.4563"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="3062.4483"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="671.75" y="2585.4262"/><rect fill="#FFFFFF" height="232.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="35.887"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="180.564"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="217.917"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2645.4117"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2714.7502"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="933.25" y="144.858"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="236.2701"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="2683.0442"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="283.8291"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2768.8093"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3078.3013"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3110.0074"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3164.0664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4519.836"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4573.895"/><rect fill="#FFFFFF" height="2033.302" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="352.0941"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1209" y="543.1242"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="3223.4784"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1616" y="583.8302"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1042.6554"/><rect fill="#FFFFFF" height="1024.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1095.0675"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="599.6832"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="651.2423"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="688.5953"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="848.7723"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="2129.25" y="1110.9205"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1162.4795"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1199.8325"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="615.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="1126.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="507.4182"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="721.9483"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="886.9784"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="918.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="995.0964"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="1218.1855"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="769.5073"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="801.2133"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="1328.3036"/><rect fill="#FFFFFF" height="39.4855" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="2306.425"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3390.3025"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3444.3615"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3479.0675"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3533.1266"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4150.7758"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4204.8349"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4239.5409"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4293.5999"/><rect fill="#FFFFFF" height="701.5468" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="1396.5686"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1605.3047"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1990.2179"/><rect fill="#FFFFFF" height="410.7662" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="3595.5386"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="2997" y="1646.0107"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="3157.5" y="1661.8637"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3160" y="1713.4228"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3160" y="1750.7758"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="3157.5" y="1916.8793"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3157.5" y="1954.5119"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3258.5" y="1677.7167"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3366.25" y="1569.5987"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3366.25" y="1784.1288"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="1831.6878"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="1863.3938"/><rect fill="#FFFFFF" height="30.6325" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="2030.9239"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3762.3627"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3816.4217"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3870.4807"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3472.75" y="3924.5397"/><polygon fill="#181818" points="254.75,45.74,259.75,47.74,254.75,49.74,256.75,47.74" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="47.74" y2="47.74"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="48.75" y="44.8355">Create Client("Bob", debugFlag, groupNameDH)</text><polygon fill="#181818" points="50.75,61.593,45.75,63.593,50.75,65.593,48.75,63.593" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="63.593" y2="63.593"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="31" x="53.75" y="60.6885">new Client</text><polygon fill="#181818" points="254.75,77.446,259.75,79.446,254.75,81.446,256.75,79.446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="79.446" y2="79.446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="130" x="48.75" y="76.5415">diffieHellmanKeyExchange(productionPort)</text><path d="M235.5,86.946 L267,86.946 L267,91.799 L262,96.799 L235.5,96.799 L235.5,86.946 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="42.559" style="stroke:#000000;stroke-width:0.75;" width="558" x="235.5" y="86.946"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="94.3945">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="93.5" x="274.5" y="93.8254">[_groupNameDH.empty() == false]</text><polygon fill="#181818" points="742.75,106.652,747.75,108.652,742.75,110.652,744.75,108.652" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="108.652" y2="108.652"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="269.25" y="105.7475">Create DiffieHellman(_debugFlag, _groupNameDH)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="793.5" y1="113.152" y2="113.152"/><polygon fill="#181818" points="742.75,123.505,747.75,125.505,742.75,127.505,744.75,125.505" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="125.505" y2="125.505"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="269.25" y="122.6005">Create DiffieHellman(_debugFlag, _pHex, _hHex)</text><polygon fill="#181818" points="927.25,142.858,932.25,144.858,927.25,146.858,929.25,144.858" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="753.75" x2="930.25" y1="144.858" y2="144.858"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="757.25" y="141.9535">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="759.25,158.711,754.25,160.711,759.25,162.711,757.25,160.711" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="756.25" x2="935.25" y1="160.711" y2="160.711"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="762.25" y="157.8065">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="756.25" x2="777.25" y1="176.564" y2="176.564"/><line style="stroke:#181818;stroke-width:0.5;" x1="777.25" x2="777.25" y1="176.564" y2="183.064"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.75" x2="777.25" y1="183.064" y2="183.064"/><polygon fill="#181818" points="761.75,181.064,756.75,183.064,761.75,185.064,759.75,183.064" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="759.75" y="173.6595">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="753.75" x2="777.25" y1="211.417" y2="211.417"/><line style="stroke:#181818;stroke-width:0.5;" x1="777.25" x2="777.25" y1="211.417" y2="217.917"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.75" x2="777.25" y1="217.917" y2="217.917"/><polygon fill="#181818" points="761.75,215.917,756.75,217.917,761.75,219.917,759.75,217.917" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="759.75" y="208.5125">generatePublicKey()</text><polygon fill="#181818" points="1033,234.2701,1038,236.2701,1033,238.2701,1035,236.2701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.25" x2="1036" y1="236.2701" y2="236.2701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="759.75" y="233.3656">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="759.25,250.1231,754.25,252.1231,759.25,254.1231,757.25,252.1231" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="756.25" x2="1041" y1="252.1231" y2="252.1231"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="762.25" y="249.2186">Public Key A (hex)</text><polygon fill="#181818" points="271.25,265.9761,266.25,267.9761,271.25,269.9761,269.25,267.9761" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="267.9761" y2="267.9761"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="274.25" y="265.0716">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="1137.5,281.8291,1142.5,283.8291,1137.5,285.8291,1139.5,283.8291" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="283.8291" y2="283.8291"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="280.9246">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="271.25,297.6821,266.25,299.6821,271.25,301.6821,269.25,299.6821" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="299.6821" y2="299.6821"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47.5" x="274.25" y="296.7776">clientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="322.6381" y2="322.6381"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="322.6381" y2="329.1381"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="329.1381" y2="329.1381"/><polygon fill="#181818" points="271.25,327.1381,266.25,329.1381,271.25,331.1381,269.25,329.1381" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="269.25" y="319.7336">built "keyExchange" message</text><path d="M140.5,306.1821 L140.5,337.6821 L258,337.6821 L258,311.1821 L253,306.1821 L140.5,306.1821 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,306.1821 L253,311.1821 L258,311.1821 L253,306.1821 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107" x="143.5" y="315.6306">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="76.5" x="143.5" y="324.4836">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47" x="143.5" y="333.3366">p, g, publicKeyA</text><polygon fill="#181818" points="1200.5,350.0941,1205.5,352.0941,1200.5,354.0941,1202.5,352.0941" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1203.5" y1="352.0941" y2="352.0941"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="269.25" y="349.1896">HTTP POST /keyExchange (ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="367.9471" y2="367.9471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="367.9471" y2="374.4471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="374.4471" y2="374.4471"/><polygon fill="#181818" points="1217,372.4471,1212,374.4471,1217,376.4471,1215,374.4471" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1215" y="365.0426">extract client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="390.3001" y2="390.3001"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="390.3001" y2="396.8001"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="396.8001" y2="396.8001"/><polygon fill="#181818" points="1217,394.8001,1212,396.8001,1217,398.8001,1215,396.8001" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="137.5" x="1215" y="387.3956">extract client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="412.6531" y2="412.6531"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="412.6531" y2="419.1531"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="419.1531" y2="419.1531"/><polygon fill="#181818" points="1217,417.1531,1212,419.1531,1217,421.1531,1215,419.1531" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127" x="1215" y="409.7486">extract client's prime p as extractedPrimeP</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="435.0062" y2="435.0062"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="435.0062" y2="441.5062"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="441.5062" y2="441.5062"/><polygon fill="#181818" points="1217,439.5062,1212,441.5062,1217,443.5062,1215,441.5062" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="153" x="1215" y="432.1017">extract client's generator g as extractedGeneratorG</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="460.0357" y2="460.0357"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="460.0357" y2="466.5357"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="466.5357" y2="466.5357"/><polygon fill="#181818" points="1217,464.5357,1212,466.5357,1217,468.5357,1215,466.5357" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145.5" x="1215" y="457.1312">extract client's public key as extractedPublicKeyA</text><path d="M1366.5,448.0062 L1366.5,470.5062 L1596,470.5062 L1596,453.0062 L1591,448.0062 L1366.5,448.0062 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1591,448.0062 L1591,453.0062 L1596,453.0062 L1591,448.0062 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89.5" x="1369.5" y="457.4547">Mallory intercepts ClientHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="219" x="1369.5" y="466.3077">He extracts client's Id, client's Nonce, prime p, generator g and public Key.</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="485.0652" y2="485.0652"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="485.0652" y2="491.5652"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="491.5652" y2="491.5652"/><polygon fill="#181818" points="1217,489.5652,1212,491.5652,1217,493.5652,1215,491.5652" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="397.5" x="1215" y="482.1607">swappedGeneratorG = generateGParameterByAttackStrategy(extractedGeneratorG, extractedPrimeP, _gReplacementAttackStrategy)</text><polygon fill="#181818" points="2419,505.4182,2424,507.4182,2419,509.4182,2421,507.4182" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2422" y1="507.4182" y2="507.4182"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132.5" x="1215" y="504.5137">hexToUniqueBIGNUM(extractedPublicKeyA)</text><polygon fill="#181818" points="1217,521.2712,1212,523.2712,1217,525.2712,1215,523.2712" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2427" y1="523.2712" y2="523.2712"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="1220" y="520.3667">peerPublicKey in UniqueBIGNUM format</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1235" y1="536.6242" y2="536.6242"/><line style="stroke:#181818;stroke-width:0.5;" x1="1235" x2="1235" y1="536.6242" y2="543.1242"/><line style="stroke:#181818;stroke-width:0.5;" x1="1214.5" x2="1235" y1="543.1242" y2="543.1242"/><polygon fill="#181818" points="1219.5,541.1242,1214.5,543.1242,1219.5,545.1242,1217.5,543.1242" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="1217.5" y="533.7197">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1235" y1="563.9772" y2="563.9772"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1235" x2="1235" y1="563.9772" y2="570.4772"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1211.5" x2="1235" y1="570.4772" y2="570.4772"/><polygon fill="#181818" points="1216.5,568.4772,1211.5,570.4772,1216.5,572.4772,1214.5,570.4772" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="1217.5" y="561.0727">sessionId</text><polygon fill="#181818" points="1610,581.8302,1615,583.8302,1610,585.8302,1612,583.8302" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1613" y1="583.8302" y2="583.8302"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="324" x="1215" y="580.9257">Create MallorySessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, p, g)</text><polygon fill="#181818" points="1873.75,597.6832,1878.75,599.6832,1873.75,601.6832,1875.75,599.6832" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1621" x2="1876.75" y1="599.6832" y2="599.6832"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111" x="1624.5" y="596.7787">Create DiffieHellman(debugFlag, p, g)</text><polygon fill="#181818" points="2307.75,613.5362,2312.75,615.5362,2307.75,617.5362,2309.75,615.5362" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2310.75" y1="615.5362" y2="615.5362"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1888.25" y="612.6317">loadDhParameters()</text><polygon fill="#181818" points="1890.25,629.3892,1885.25,631.3892,1890.25,633.3892,1888.25,631.3892" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2315.75" y1="631.3892" y2="631.3892"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1893.25" y="628.4847">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1887.25" x2="1908.25" y1="647.2423" y2="647.2423"/><line style="stroke:#181818;stroke-width:0.5;" x1="1908.25" x2="1908.25" y1="647.2423" y2="653.7423"/><line style="stroke:#181818;stroke-width:0.5;" x1="1887.75" x2="1908.25" y1="653.7423" y2="653.7423"/><polygon fill="#181818" points="1892.75,651.7423,1887.75,653.7423,1892.75,655.7423,1890.75,653.7423" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1890.75" y="644.3378">generatePrivateKey()</text><path d="M1959.5,639.6392 L1959.5,653.1392 L2075,653.1392 L2075,644.6392 L2070,639.6392 L1959.5,639.6392 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2070,639.6392 L2070,644.6392 L2075,644.6392 L2070,639.6392 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="1962.5" y="649.0878">Mallory generates private key 'm_s'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1887.25" x2="1908.25" y1="684.5953" y2="684.5953"/><line style="stroke:#181818;stroke-width:0.5;" x1="1908.25" x2="1908.25" y1="684.5953" y2="691.0953"/><line style="stroke:#181818;stroke-width:0.5;" x1="1887.75" x2="1908.25" y1="691.0953" y2="691.0953"/><polygon fill="#181818" points="1892.75,689.0953,1887.75,691.0953,1892.75,693.0953,1890.75,691.0953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1890.75" y="681.6908">generatePublicKey()</text><path d="M1956.5,676.9923 L1956.5,690.4923 L2106,690.4923 L2106,681.9923 L2101,676.9923 L1956.5,676.9923 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2101,676.9923 L2101,681.9923 L2106,681.9923 L2101,676.9923 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139" x="1959.5" y="686.4408">Mallory computes public key M_S = (g^m_) % p</text><polygon fill="#181818" points="2419,719.9483,2424,721.9483,2419,723.9483,2421,721.9483" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="721.9483" y2="721.9483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1888.25" y="719.0438">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1890.25,735.8013,1885.25,737.8013,1890.25,739.8013,1888.25,737.8013" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="737.8013" y2="737.8013"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="1893.25" y="734.8968">Public Key M_S (hex)</text><polygon fill="#181818" points="1626.5,751.6543,1621.5,753.6543,1626.5,755.6543,1624.5,753.6543" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1623.5" x2="1881.75" y1="753.6543" y2="753.6543"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1629.5" y="750.7498">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="2529,767.5073,2534,769.5073,2529,771.5073,2531,769.5073" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1621" x2="2532" y1="769.5073" y2="769.5073"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="1624.5" y="766.6028">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="1626.5,783.3603,1621.5,785.3603,1626.5,787.3603,1624.5,785.3603" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1623.5" x2="2537" y1="785.3603" y2="785.3603"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109.5" x="1629.5" y="782.4558">result stored in _serverNonceHexAM</text><polygon fill="#181818" points="2529,799.2133,2534,801.2133,2529,803.2133,2531,801.2133" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1621" x2="2532" y1="801.2133" y2="801.2133"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1624.5" y="798.3088">generateRandomIV(ivLength)</text><polygon fill="#181818" points="1626.5,815.0663,1621.5,817.0663,1626.5,819.0663,1624.5,817.0663" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1623.5" x2="2537" y1="817.0663" y2="817.0663"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="1629.5" y="814.1618">result stored in _ivAM</text><polygon fill="#181818" points="1217,830.9193,1212,832.9193,1217,834.9193,1215,832.9193" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1618" y1="832.9193" y2="832.9193"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="228" x="1220" y="830.0148">returns mallorySessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="1873.75,846.7723,1878.75,848.7723,1873.75,850.7723,1875.75,848.7723" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1876.75" y1="848.7723" y2="848.7723"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="440" x="1215" y="845.8678">deriveSharedSecret(extractedPublicKeyA, _diffieHellmanMap[sessionId]-&gt;_serverNonceHexAM, _diffieHellmanMap[sessionId]-&gt;_clientNonceHexAM)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="1905.75" y1="864.6253" y2="864.6253"/><line style="stroke:#181818;stroke-width:0.5;" x1="1905.75" x2="1905.75" y1="864.6253" y2="871.1253"/><line style="stroke:#181818;stroke-width:0.5;" x1="1885.25" x2="1905.75" y1="871.1253" y2="871.1253"/><polygon fill="#181818" points="1890.25,869.1253,1885.25,871.1253,1890.25,873.1253,1888.25,871.1253" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1888.25" y="861.7208">_sharedSecret = (peerPublicKey ^ _privateKey) % _p</text><polygon fill="#181818" points="2419,884.9784,2424,886.9784,2419,888.9784,2421,886.9784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="886.9784" y2="886.9784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1888.25" y="884.0739">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="1890.25,900.8314,1885.25,902.8314,1890.25,904.8314,1888.25,902.8314" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="902.8314" y2="902.8314"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="1893.25" y="899.9269">serverNonceBytes</text><polygon fill="#181818" points="2419,916.6844,2424,918.6844,2419,920.6844,2421,918.6844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="918.6844" y2="918.6844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="86.5" x="1888.25" y="915.7799">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="1890.25,932.5374,1885.25,934.5374,1890.25,936.5374,1888.25,934.5374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="934.5374" y2="934.5374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52" x="1893.25" y="931.6329">clientNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="1905.75" y1="950.3904" y2="950.3904"/><line style="stroke:#181818;stroke-width:0.5;" x1="1905.75" x2="1905.75" y1="950.3904" y2="956.8904"/><line style="stroke:#181818;stroke-width:0.5;" x1="1885.25" x2="1905.75" y1="956.8904" y2="956.8904"/><polygon fill="#181818" points="1890.25,954.8904,1885.25,956.8904,1890.25,958.8904,1888.25,956.8904" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="237.5" x="1888.25" y="947.4859">dataToHash = sharedSecretRawBytes || clientNonceBytes || serverNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="1905.75" y1="972.7434" y2="972.7434"/><line style="stroke:#181818;stroke-width:0.5;" x1="1905.75" x2="1905.75" y1="972.7434" y2="979.2434"/><line style="stroke:#181818;stroke-width:0.5;" x1="1885.25" x2="1905.75" y1="979.2434" y2="979.2434"/><polygon fill="#181818" points="1890.25,977.2434,1885.25,979.2434,1890.25,981.2434,1888.25,979.2434" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138.5" x="1888.25" y="969.8389">_derivedSymmetricKey = SHA256(dataToHash)</text><polygon fill="#181818" points="2419,993.0964,2424,995.0964,2419,997.0964,2421,995.0964" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="995.0964" y2="995.0964"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109" x="1888.25" y="992.1919">toHexString(_derivedSymmetricKey)</text><polygon fill="#181818" points="1890.25,1008.9494,1885.25,1010.9494,1890.25,1012.9494,1888.25,1010.9494" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="1010.9494" y2="1010.9494"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127" x="1893.25" y="1008.0449">result stored in _derivedSymmetricKeyHex</text><polygon fill="#181818" points="1217,1024.8024,1212,1026.8024,1217,1028.8024,1215,1026.8024" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1881.75" y1="1026.8024" y2="1026.8024"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115" x="1220" y="1023.8979">result stored in _derivedSymmetricKey</text><polygon fill="#181818" points="1709.75,1040.6554,1714.75,1042.6554,1709.75,1044.6554,1711.75,1042.6554" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1712.75" y1="1042.6554" y2="1042.6554"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="485" x="1215" y="1039.7509">generate fake Client(_diffieHellmanMap[sessionId]-&gt;_clientIdAM, _debugFlag, _diffieHellmanMap[sessionId]-&gt;_diffieHellmanAM-&gt;getPrimeP(), swappedGeneratorG)</text><polygon fill="#181818" points="1217,1066.8614,1212,1068.8614,1217,1070.8614,1215,1068.8614" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1717.75" y1="1068.8614" y2="1068.8614"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142" x="1220" y="1065.9569">new client, to act as a fake one to the real server</text><path d="M966.5,1049.1554 L966.5,1080.6554 L1204,1080.6554 L1204,1054.1554 L1199,1049.1554 L966.5,1049.1554 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,1049.1554 L1199,1054.1554 L1204,1054.1554 L1199,1049.1554 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="969.5" y="1058.6039">Mallory constructs her own ClientHello to Server</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="969.5" y="1067.4569">with Client's Id, malloryNonceToServer,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="227" x="969.5" y="1076.31">prime p, swappedGeneratorG, publicKeyM_S (Mallory's public key for Server)</text><polygon fill="#181818" points="1709.75,1093.0675,1714.75,1095.0675,1709.75,1097.0675,1711.75,1095.0675" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1712.75" y1="1095.0675" y2="1095.0675"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168" x="1215" y="1092.163">diffieHellmanKeyExchange(const int portServerNumber)</text><polygon fill="#181818" points="2123.25,1108.9205,2128.25,1110.9205,2123.25,1112.9205,2125.25,1110.9205" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="2126.25" y1="1110.9205" y2="1110.9205"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="114" x="1724.25" y="1108.016">Create DiffieHellman(_debugFlag, p, g)</text><polygon fill="#181818" points="2307.75,1124.7735,2312.75,1126.7735,2307.75,1128.7735,2309.75,1126.7735" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2134.25" x2="2310.75" y1="1126.7735" y2="1126.7735"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="2137.75" y="1123.869">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="2139.75,1140.6265,2134.75,1142.6265,2139.75,1144.6265,2137.75,1142.6265" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2136.75" x2="2315.75" y1="1142.6265" y2="1142.6265"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="2142.75" y="1139.722">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="2136.75" x2="2157.75" y1="1158.4795" y2="1158.4795"/><line style="stroke:#181818;stroke-width:0.5;" x1="2157.75" x2="2157.75" y1="1158.4795" y2="1164.9795"/><line style="stroke:#181818;stroke-width:0.5;" x1="2137.25" x2="2157.75" y1="1164.9795" y2="1164.9795"/><polygon fill="#181818" points="2142.25,1162.9795,2137.25,1164.9795,2142.25,1166.9795,2140.25,1164.9795" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="2140.25" y="1155.575">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="2134.25" x2="2157.75" y1="1193.3325" y2="1193.3325"/><line style="stroke:#181818;stroke-width:0.5;" x1="2157.75" x2="2157.75" y1="1193.3325" y2="1199.8325"/><line style="stroke:#181818;stroke-width:0.5;" x1="2137.25" x2="2157.75" y1="1199.8325" y2="1199.8325"/><polygon fill="#181818" points="2142.25,1197.8325,2137.25,1199.8325,2142.25,1201.8325,2140.25,1199.8325" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2140.25" y="1190.428">generatePublicKey()</text><polygon fill="#181818" points="2419,1216.1855,2424,1218.1855,2419,1220.1855,2421,1218.1855" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2136.75" x2="2422" y1="1218.1855" y2="1218.1855"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="2140.25" y="1215.281">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2139.75,1232.0385,2134.75,1234.0385,2139.75,1236.0385,2137.75,1234.0385" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2136.75" x2="2427" y1="1234.0385" y2="1234.0385"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="2142.75" y="1231.134">Public Key M_S (hex)</text><polygon fill="#181818" points="1726.25,1247.8915,1721.25,1249.8915,1726.25,1251.8915,1724.25,1249.8915" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1723.25" x2="2131.25" y1="1249.8915" y2="1249.8915"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="1729.25" y="1246.987">Client:DiffieHellman instance ready</text><path d="M1668.5,1257.3915 L1700,1257.3915 L1700,1262.2445 L1695,1267.2445 L1668.5,1267.2445 L1668.5,1257.3915 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="55.559" style="stroke:#000000;stroke-width:0.75;" width="213.75" x="1668.5" y="1257.3915"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1676" y="1264.84">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="93.5" x="1707.5" y="1264.271">[_groupNameDH.empty() == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="1741.75" y1="1279.0975" y2="1279.0975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1741.75" x2="1741.75" y1="1279.0975" y2="1285.5975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1721.25" x2="1741.75" y1="1285.5975" y2="1285.5975"/><polygon fill="#181818" points="1726.25,1283.5975,1721.25,1285.5975,1726.25,1287.5975,1724.25,1285.5975" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1724.25" y="1276.193">Create DiffieHellman(_debugFlag, _groupNameDH)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1668.5" x2="1882.25" y1="1290.0975" y2="1290.0975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="1741.75" y1="1302.4506" y2="1302.4506"/><line style="stroke:#181818;stroke-width:0.5;" x1="1741.75" x2="1741.75" y1="1302.4506" y2="1308.9506"/><line style="stroke:#181818;stroke-width:0.5;" x1="1721.25" x2="1741.75" y1="1308.9506" y2="1308.9506"/><polygon fill="#181818" points="1726.25,1306.9506,1721.25,1308.9506,1726.25,1310.9506,1724.25,1308.9506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="1724.25" y="1299.5461">Create DiffieHellman(_debugFlag, _pHex, _hHex)</text><polygon fill="#181818" points="2529,1326.3036,2534,1328.3036,2529,1330.3036,2531,1328.3036" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="2532" y1="1328.3036" y2="1328.3036"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="1724.25" y="1325.3991">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="1726.25,1342.1566,1721.25,1344.1566,1726.25,1346.1566,1724.25,1344.1566" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1723.25" x2="2537" y1="1344.1566" y2="1344.1566"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="1729.25" y="1341.2521">fakeClientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="1741.75" y1="1367.1126" y2="1367.1126"/><line style="stroke:#181818;stroke-width:0.5;" x1="1741.75" x2="1741.75" y1="1367.1126" y2="1373.6126"/><line style="stroke:#181818;stroke-width:0.5;" x1="1721.25" x2="1741.75" y1="1373.6126" y2="1373.6126"/><polygon fill="#181818" points="1726.25,1371.6126,1721.25,1373.6126,1726.25,1375.6126,1724.25,1373.6126" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="1724.25" y="1364.2081">built "keyExchange" message</text><path d="M1581,1350.6566 L1581,1382.1566 L1713,1382.1566 L1713,1355.6566 L1708,1350.6566 L1581,1350.6566 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1708,1350.6566 L1708,1355.6566 L1713,1355.6566 L1708,1350.6566 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="1584" y="1360.1051">Fake client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102.5" x="1584" y="1368.9581">with real clientId, fakeClientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="55.5" x="1584" y="1377.8111">p, g, publicKeyM_S</text><polygon fill="#181818" points="2601.5,1394.5686,2606.5,1396.5686,2601.5,1398.5686,2603.5,1396.5686" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="2604.5" y1="1396.5686" y2="1396.5686"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="160.5" x="1724.25" y="1393.6641">HTTP POST /keyExchange (Mallory's ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1412.4216" y2="1412.4216"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1412.4216" y2="1418.9216"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1418.9216" y2="1418.9216"/><polygon fill="#181818" points="2618,1416.9216,2613,1418.9216,2618,1420.9216,2616,1418.9216" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2616" y="1409.5171">Parse ClientHello JSON (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1434.7746" y2="1434.7746"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1434.7746" y2="1441.2746"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1441.2746" y2="1441.2746"/><polygon fill="#181818" points="2618,1439.2746,2613,1441.2746,2618,1443.2746,2616,1441.2746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="148.5" x="2616" y="1431.8701">extract fake client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1457.1276" y2="1457.1276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1457.1276" y2="1463.6276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1463.6276" y2="1463.6276"/><polygon fill="#181818" points="2618,1461.6276,2613,1463.6276,2618,1465.6276,2616,1463.6276" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2616" y="1454.2231">extract fake client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1479.4806" y2="1479.4806"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1479.4806" y2="1485.9806"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1485.9806" y2="1485.9806"/><polygon fill="#181818" points="2618,1483.9806,2613,1485.9806,2618,1487.9806,2616,1485.9806" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141" x="2616" y="1476.5761">extract fake client's prime p as extractedPrimeP</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1501.8336" y2="1501.8336"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1501.8336" y2="1508.3336"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1508.3336" y2="1508.3336"/><polygon fill="#181818" points="2618,1506.3336,2613,1508.3336,2618,1510.3336,2616,1508.3336" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="167" x="2616" y="1498.9291">extract fake client's generator g as extractedGeneratorG</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1535.7162" y2="1535.7162"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1535.7162" y2="1542.2162"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1542.2162" y2="1542.2162"/><polygon fill="#181818" points="2618,1540.2162,2613,1542.2162,2618,1544.2162,2616,1542.2162" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="159.5" x="2616" y="1532.8117">extract fake client's public key as extractedPublicKeyA</text><path d="M2781.5,1514.8336 L2781.5,1554.8336 L2957,1554.8336 L2957,1519.8336 L2952,1514.8336 L2781.5,1514.8336 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2952,1514.8336 L2952,1519.8336 L2957,1519.8336 L2952,1514.8336 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="106" x="2784.5" y="1524.2822">Server extracts clients id, (Alice's Id),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141.5" x="2784.5" y="1533.1352">malloryNonceToServer (thinks it's client nonce),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="165" x="2784.5" y="1541.9882">publicKeyM_S (thinks it's client publicKeyA), the prime p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="88.5" x="2784.5" y="1550.8412">and the swapped generator g</text><polygon fill="#181818" points="3360.25,1567.5987,3365.25,1569.5987,3360.25,1571.5987,3362.25,1569.5987" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3363.25" y1="1569.5987" y2="1569.5987"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2616" y="1566.6942">BIGNUMToHex(extractedPublicKeyA)</text><polygon fill="#181818" points="2618,1583.4517,2613,1585.4517,2618,1587.4517,2616,1585.4517" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3368.25" y1="1585.4517" y2="1585.4517"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="59" x="2621" y="1582.5472">peerPublicKey (hex)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2636" y1="1598.8047" y2="1598.8047"/><line style="stroke:#181818;stroke-width:0.5;" x1="2636" x2="2636" y1="1598.8047" y2="1605.3047"/><line style="stroke:#181818;stroke-width:0.5;" x1="2615.5" x2="2636" y1="1605.3047" y2="1605.3047"/><polygon fill="#181818" points="2620.5,1603.3047,2615.5,1605.3047,2620.5,1607.3047,2618.5,1605.3047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="2618.5" y="1595.9002">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="2636" y1="1626.1577" y2="1626.1577"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2636" x2="2636" y1="1626.1577" y2="1632.6577"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2612.5" x2="2636" y1="1632.6577" y2="1632.6577"/><polygon fill="#181818" points="2617.5,1630.6577,2612.5,1632.6577,2617.5,1634.6577,2615.5,1632.6577" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="2618.5" y="1623.2532">sessionId</text><polygon fill="#181818" points="2991,1644.0107,2996,1646.0107,2991,1648.0107,2993,1646.0107" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2994" y1="1646.0107" y2="1646.0107"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="375" x="2616" y="1643.1062">Create ServerSessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, extractedGroupName)</text><polygon fill="#181818" points="3151.5,1659.8637,3156.5,1661.8637,3151.5,1663.8637,3153.5,1661.8637" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3002" x2="3154.5" y1="1661.8637" y2="1661.8637"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="3005.5" y="1658.9592">Create DiffieHellman(debugFlag, groupNameDH)</text><polygon fill="#181818" points="3252.5,1675.7167,3257.5,1677.7167,3252.5,1679.7167,3254.5,1677.7167" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3162.5" x2="3255.5" y1="1677.7167" y2="1677.7167"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="3166" y="1674.8122">loadDhParameters()</text><polygon fill="#181818" points="3168,1691.5697,3163,1693.5697,3168,1695.5697,3166,1693.5697" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3165" x2="3260.5" y1="1693.5697" y2="1693.5697"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="3171" y="1690.6652">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="3165" x2="3186" y1="1709.4228" y2="1709.4228"/><line style="stroke:#181818;stroke-width:0.5;" x1="3186" x2="3186" y1="1709.4228" y2="1715.9228"/><line style="stroke:#181818;stroke-width:0.5;" x1="3165.5" x2="3186" y1="1715.9228" y2="1715.9228"/><polygon fill="#181818" points="3170.5,1713.9228,3165.5,1715.9228,3170.5,1717.9228,3168.5,1715.9228" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="3168.5" y="1706.5183">generatePrivateKey()</text><path d="M3237.5,1701.8197 L3237.5,1715.3197 L3350,1715.3197 L3350,1706.8197 L3345,1701.8197 L3237.5,1701.8197 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3345,1701.8197 L3345,1706.8197 L3350,1706.8197 L3345,1701.8197 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102" x="3240.5" y="1711.2683">Server generates private key 'm_a'</text><line style="stroke:#181818;stroke-width:0.5;" x1="3165" x2="3186" y1="1746.7758" y2="1746.7758"/><line style="stroke:#181818;stroke-width:0.5;" x1="3186" x2="3186" y1="1746.7758" y2="1753.2758"/><line style="stroke:#181818;stroke-width:0.5;" x1="3165.5" x2="3186" y1="1753.2758" y2="1753.2758"/><polygon fill="#181818" points="3170.5,1751.2758,3165.5,1753.2758,3170.5,1755.2758,3168.5,1753.2758" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="3168.5" y="1743.8713">generatePublicKey()</text><path d="M3234.5,1739.1728 L3234.5,1752.6728 L3384.5,1752.6728 L3384.5,1744.1728 L3379.5,1739.1728 L3234.5,1739.1728 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3379.5,1739.1728 L3379.5,1744.1728 L3384.5,1744.1728 L3379.5,1739.1728 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="3237.5" y="1748.6213">Server computes public key M_A = (g^m_a) % p</text><polygon fill="#181818" points="3360.25,1782.1288,3365.25,1784.1288,3360.25,1786.1288,3362.25,1784.1288" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3162.5" x2="3363.25" y1="1784.1288" y2="1784.1288"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="3166" y="1781.2243">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="3168,1797.9818,3163,1799.9818,3168,1801.9818,3166,1799.9818" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3165" x2="3368.25" y1="1799.9818" y2="1799.9818"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="3171" y="1797.0773">Public Key M_A (hex)</text><polygon fill="#181818" points="3007.5,1813.8348,3002.5,1815.8348,3007.5,1817.8348,3005.5,1815.8348" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3004.5" x2="3159.5" y1="1815.8348" y2="1815.8348"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="3010.5" y="1812.9303">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="3466.75,1829.6878,3471.75,1831.6878,3466.75,1833.6878,3468.75,1831.6878" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3002" x2="3469.75" y1="1831.6878" y2="1831.6878"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="3005.5" y="1828.7833">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="3007.5,1845.5408,3002.5,1847.5408,3007.5,1849.5408,3005.5,1847.5408" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3004.5" x2="3474.75" y1="1847.5408" y2="1847.5408"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="99.5" x="3010.5" y="1844.6363">result stored in _serverNonceHex</text><polygon fill="#181818" points="3466.75,1861.3938,3471.75,1863.3938,3466.75,1865.3938,3468.75,1863.3938" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3002" x2="3469.75" y1="1863.3938" y2="1863.3938"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="3005.5" y="1860.4893">generateRandomIV(ivLength)</text><polygon fill="#181818" points="3007.5,1877.2468,3002.5,1879.2468,3007.5,1881.2468,3005.5,1879.2468" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3004.5" x2="3474.75" y1="1879.2468" y2="1879.2468"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="3010.5" y="1876.3423">result stored in _iv</text><polygon fill="#181818" points="2618,1893.0998,2613,1895.0998,2618,1897.0998,2616,1895.0998" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="2999" y1="1895.0998" y2="1895.0998"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="205.5" x="2621" y="1892.1953">returns SessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="3151.5,1914.8793,3156.5,1916.8793,3151.5,1918.8793,3153.5,1916.8793" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3154.5" y1="1916.8793" y2="1916.8793"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="233" x="2616" y="1913.9748">deriveSharedSecret(extractedPublicKeyA, _serverNonceHex, _clientNonceHex)</text><path d="M3165,1901.5998 L3165,1924.0998 L3389,1924.0998 L3389,1906.5998 L3384,1901.5998 L3165,1901.5998 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3384,1901.5998 L3384,1906.5998 L3389,1906.5998 L3384,1901.5998 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="213.5" x="3168" y="1911.0483">Server computes shared secret M_S = (publicKeyM_A ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="157.5" x="3168" y="1919.9013">This is the shared secret between Mallory and Server.</text><polygon fill="#181818" points="2618,1936.6589,2613,1938.6589,2618,1940.6589,2616,1938.6589" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3159.5" y1="1938.6589" y2="1938.6589"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80.5" x="2621" y="1935.7543">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="3151.5,1952.5119,3156.5,1954.5119,3151.5,1956.5119,3153.5,1954.5119" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3154.5" y1="1954.5119" y2="1954.5119"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80" x="2616" y="1951.6074">getConfirmationMessage()</text><polygon fill="#181818" points="2618,1968.3649,2613,1970.3649,2618,1972.3649,2616,1970.3649" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3159.5" y1="1970.3649" y2="1970.3649"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="150.5" x="2621" y="1967.4604">returns server's confirmation message as message</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2636" y1="1983.7179" y2="1983.7179"/><line style="stroke:#181818;stroke-width:0.5;" x1="2636" x2="2636" y1="1983.7179" y2="1990.2179"/><line style="stroke:#181818;stroke-width:0.5;" x1="2615.5" x2="2636" y1="1990.2179" y2="1990.2179"/><polygon fill="#181818" points="2620.5,1988.2179,2615.5,1990.2179,2620.5,1992.2179,2618.5,1990.2179" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80.5" x="2618.5" y="1980.8134">build confirmation payload</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="2636" y1="2011.0709" y2="2011.0709"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2636" x2="2636" y1="2011.0709" y2="2017.5709"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2612.5" x2="2636" y1="2017.5709" y2="2017.5709"/><polygon fill="#181818" points="2617.5,2015.5709,2612.5,2017.5709,2617.5,2019.5709,2615.5,2017.5709" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="277" x="2618.5" y="2008.1664">confirmation payload build with fields: message, sessionId, clientId, clientNonce, serverNonce</text><polygon fill="#181818" points="3466.75,2028.9239,3471.75,2030.9239,3466.75,2032.9239,3468.75,2030.9239" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3469.75" y1="2030.9239" y2="2030.9239"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="237" x="2616" y="2028.0194">encryptMessageAes256CbcMode(confirmationMsg, _derivedSymmetricKey, _iv)</text><polygon fill="#181818" points="2618,2059.5564,2613,2061.5564,2618,2063.5564,2616,2061.5564" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3474.75" y1="2061.5564" y2="2061.5564"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2621" y="2058.6519">ciphertext</text><path d="M2436.5,2037.4239 L2436.5,2077.4239 L2605,2077.4239 L2605,2042.4239 L2600,2037.4239 L2436.5,2037.4239 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2600,2037.4239 L2600,2042.4239 L2605,2042.4239 L2600,2037.4239 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138" x="2439.5" y="2046.8724">Server constructs JSON response (ServerHello)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121" x="2439.5" y="2055.7254">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2439.5" y="2064.5784">encrypted confirmation (ciphertext_MS, ivHex_MS)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="158" x="2439.5" y="2073.4314">Server believes it's sending to Alice instead of Mallory</text><polygon fill="#181818" points="1726.25,2096.1154,1721.25,2098.1154,1726.25,2100.1154,1724.25,2098.1154" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1723.25" x2="2609.5" y1="2098.1154" y2="2098.1154"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95.5" x="1729.25" y="2095.2109">HTTP 201 OK (ServerHello JSON)</text><path d="M2615,2082.8359 L2615,2105.3359 L2846,2105.3359 L2846,2087.8359 L2841,2082.8359 L2615,2082.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2841,2082.8359 L2841,2087.8359 L2846,2087.8359 L2841,2082.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="2618" y="2092.2844">Mallory's fake client intercepts ServerHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="220.5" x="2618" y="2101.1374">He extracts sessionId, serverNonce, publicKeyB, ciphertext_MS, ivHex_MS.</text><polygon fill="#181818" points="1217,2117.895,1212,2119.895,1217,2121.895,1215,2119.895" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1717.75" y1="2119.895" y2="2119.895"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107.5" x="1220" y="2116.9904">returns server's response decrypted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2135.748" y2="2135.748"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2135.748" y2="2142.248"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2142.248" y2="2142.248"/><polygon fill="#181818" points="1217,2140.248,1212,2142.248,1217,2144.248,1215,2142.248" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122" x="1215" y="2132.8435">Parse ServerHello JSON (from real server)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2158.101" y2="2158.101"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2158.101" y2="2164.601"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2164.601" y2="2164.601"/><polygon fill="#181818" points="1217,2162.601,1212,2164.601,1217,2166.601,1215,2164.601" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145" x="1215" y="2155.1965">extracts server's session id as sessionIdExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2180.454" y2="2180.454"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2180.454" y2="2186.954"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2186.954" y2="2186.954"/><polygon fill="#181818" points="1217,2184.954,1212,2186.954,1217,2188.954,1215,2186.954" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="113" x="1215" y="2177.5495">extracts client's id as clientIdExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2202.807" y2="2202.807"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2202.807" y2="2209.307"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2209.307" y2="2209.307"/><polygon fill="#181818" points="1217,2207.307,1212,2209.307,1217,2211.307,1215,2209.307" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="140.5" x="1215" y="2199.9025">extracts client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2225.16" y2="2225.16"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2225.16" y2="2231.66"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2231.66" y2="2231.66"/><polygon fill="#181818" points="1217,2229.66,1212,2231.66,1217,2233.66,1215,2231.66" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144.5" x="1215" y="2222.2555">extracts server's nonce as serverNonceExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2247.513" y2="2247.513"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2247.513" y2="2254.013"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2254.013" y2="2254.013"/><polygon fill="#181818" points="1217,2252.013,1212,2254.013,1217,2256.013,1215,2254.013" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141" x="1215" y="2244.6085">extracts server's message as messageExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2276.969" y2="2276.969"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2276.969" y2="2283.469"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2283.469" y2="2283.469"/><polygon fill="#181818" points="1217,2281.469,1212,2283.469,1217,2285.469,1215,2283.469" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="325.5" x="1215" y="2274.0645">confirmationString is built with the fields: sessionId, clientId, clientNonce, serverNonce and messageExtracted</text><path d="M1546.5,2260.513 L1546.5,2292.013 L1773.5,2292.013 L1773.5,2265.513 L1768.5,2260.513 L1546.5,2260.513 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1768.5,2260.513 L1768.5,2265.513 L1773.5,2265.513 L1768.5,2260.513 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="1549.5" y="2269.9615">Mallory in this example just scoops the data exchanged between the real</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="210.5" x="1549.5" y="2278.8145">server and the client, it does not tamper the message, just changes the</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="1549.5" y="2287.6675">nonce's and iv's to ensure total control over each leg of the channel.</text><polygon fill="#181818" points="2529,2304.425,2534,2306.425,2529,2308.425,2531,2306.425" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="2306.425" y2="2306.425"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="265" x="1215" y="2303.5205">encryptMessageAes256CbcMode(confirmationString, _derivedSymmetricKey_AM, _ivAM)</text><polygon fill="#181818" points="1217,2343.9106,1212,2345.9106,1217,2347.9106,1215,2345.9106" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="2345.9106" y2="2345.9106"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="1220" y="2343.0061">ciphertext_AM</text><path d="M982,2312.925 L982,2370.925 L1204,2370.925 L1204,2317.925 L1199,2312.925 L982,2312.925 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,2312.925 L1199,2317.925 L1204,2317.925 L1199,2312.925 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="985" y="2322.3735">Mallory constructs her own ServerHello to Client</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199.5" x="985" y="2331.2265">with original sessionId, serverNonce_AM (Mallory's), publicKeyM_A,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="211.5" x="985" y="2340.0796">encrypted confirmation (ciphertext_AM) and initialization vector _ivAM.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="985" y="2348.9326">Mallory sends her own public key (M_A) to the client,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="985" y="2357.7856">making Alice believe M_A is Bob's public key.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="985" y="2366.6386">Mallory uses his own nonce he generated for this leg of the attack.</text><polygon fill="#181818" points="271.25,2383.3961,266.25,2385.3961,271.25,2387.3961,269.25,2385.3961" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1208.5" y1="2385.3961" y2="2385.3961"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="274.25" y="2382.4916">HTTP 201 OK (Mallory's ServerHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2403.9256" y2="2403.9256"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2403.9256" y2="2410.4256"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2410.4256" y2="2410.4256"/><polygon fill="#181818" points="271.25,2408.4256,266.25,2410.4256,271.25,2412.4256,269.25,2410.4256" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142.5" x="269.25" y="2401.0211">Parse ServerHello JSON response (from Mallory)</text><path d="M417.5,2391.8961 L417.5,2414.3961 L627,2414.3961 L627,2396.8961 L622,2391.8961 L417.5,2391.8961 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M622,2391.8961 L622,2396.8961 L627,2396.8961 L622,2391.8961 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="420.5" y="2401.3446">Client extracts sessionId, serverNonce (Mallory's),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199" x="420.5" y="2410.1976">groupName, publicKeyB (Mallory's M_A), ciphertext_AM, ivHex_AM</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2428.9551" y2="2428.9551"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2428.9551" y2="2435.4551"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2435.4551" y2="2435.4551"/><polygon fill="#181818" points="271.25,2433.4551,266.25,2435.4551,271.25,2437.4551,269.25,2435.4551" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="2426.0506">Parse ServerHello JSON (from fake server)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2451.3081" y2="2451.3081"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2451.3081" y2="2457.8081"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2457.8081" y2="2457.8081"/><polygon fill="#181818" points="271.25,2455.8081,266.25,2457.8081,271.25,2459.8081,269.25,2457.8081" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="269.25" y="2448.4036">extracts server's session id as sessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2473.6611" y2="2473.6611"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2473.6611" y2="2480.1611"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2480.1611" y2="2480.1611"/><polygon fill="#181818" points="271.25,2478.1611,266.25,2480.1611,271.25,2482.1611,269.25,2480.1611" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145" x="269.25" y="2470.7566">extracts server's nonce as extractedNonceServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2496.0141" y2="2496.0141"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2496.0141" y2="2502.5141"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2502.5141" y2="2502.5141"/><polygon fill="#181818" points="271.25,2500.5141,266.25,2502.5141,271.25,2504.5141,269.25,2502.5141" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="137.5" x="269.25" y="2493.1096">extracts group name as extractedGroupName</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2518.3671" y2="2518.3671"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2518.3671" y2="2524.8671"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2524.8671" y2="2524.8671"/><polygon fill="#181818" points="271.25,2522.8671,266.25,2524.8671,271.25,2526.8671,269.25,2524.8671" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="165" x="269.25" y="2515.4626">extracts fake server's public key as extractedPublicKeyB</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2540.7202" y2="2540.7202"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2540.7202" y2="2547.2202"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2547.2202" y2="2547.2202"/><polygon fill="#181818" points="271.25,2545.2202,266.25,2547.2202,271.25,2549.2202,269.25,2547.2202" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="269.25" y="2537.8157">extracts fake server's ciphertext as ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2563.0732" y2="2563.0732"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2563.0732" y2="2569.5732"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2569.5732" y2="2569.5732"/><polygon fill="#181818" points="271.25,2567.5732,266.25,2569.5732,271.25,2571.5732,269.25,2569.5732" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83.5" x="269.25" y="2560.1687">extracts fake server's iv as iv</text><polygon fill="#181818" points="665.75,2583.4262,670.75,2585.4262,665.75,2587.4262,667.75,2585.4262" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="668.75" y1="2585.4262" y2="2585.4262"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="284" x="269.25" y="2582.5217">Create SessionData(diffieHellman, extractedNonceServer, clientNonceHex, extractedClientId, iv)</text><polygon fill="#181818" points="271.25,2599.2792,266.25,2601.2792,271.25,2603.2792,269.25,2601.2792" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="673.75" y1="2601.2792" y2="2601.2792"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="205.5" x="274.25" y="2598.3747">returns SessionData, stored in the map _diffieHellmanMap[sessionId]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2617.1322" y2="2617.1322"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2617.1322" y2="2623.6322"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2623.6322" y2="2623.6322"/><polygon fill="#181818" points="271.25,2621.6322,266.25,2623.6322,271.25,2625.6322,269.25,2623.6322" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118.5" x="269.25" y="2614.2277">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="742.75,2643.4117,747.75,2645.4117,742.75,2647.4117,744.75,2645.4117" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="2645.4117" y2="2645.4117"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="227" x="269.25" y="2642.5072">deriveSharedSecret(extractedPublicKeyB, serverNonceHex, clientNonceHex)</text><path d="M756,2630.1322 L756,2652.6322 L968.5,2652.6322 L968.5,2635.1322 L963.5,2630.1322 L756,2630.1322 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963.5,2630.1322 L963.5,2635.1322 L968.5,2635.1322 L963.5,2630.1322 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="759" y="2639.5807">Client computes shared secret s = (publicKeyM_B ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="174.5" x="759" y="2648.4337">This is the shared secret between Client (Alice) and Mallory.</text><polygon fill="#181818" points="271.25,2665.1912,266.25,2667.1912,271.25,2669.1912,269.25,2667.1912" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="2667.1912" y2="2667.1912"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="158" x="274.25" y="2664.2867">_derivedSymmetricKeyHex (Alice-Mallory shared key)</text><polygon fill="#181818" points="1033,2681.0442,1038,2683.0442,1033,2685.0442,1035,2683.0442" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1036" y1="2683.0442" y2="2683.0442"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="269.25" y="2680.1397">hexToBytes(_diffieHellmanMap[sessionId]-&gt;_derivedKeyHex)</text><polygon fill="#181818" points="271.25,2696.8972,266.25,2698.8972,271.25,2700.8972,269.25,2698.8972" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1041" y1="2698.8972" y2="2698.8972"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="57" x="274.25" y="2695.9927">returns derivedKey</text><polygon fill="#181818" points="742.75,2712.7502,747.75,2714.7502,742.75,2716.7502,744.75,2714.7502" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="2714.7502" y2="2714.7502"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80" x="269.25" y="2711.8457">getConfirmationMessage()</text><polygon fill="#181818" points="271.25,2728.6032,266.25,2730.6032,271.25,2732.6032,269.25,2730.6032" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="2730.6032" y2="2730.6032"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="186.5" x="274.25" y="2727.6987">returns client's confirmation message as confirmationMessage</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="289.25" y1="2743.9563" y2="2743.9563"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2743.9563" y2="2750.4563"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2750.4563" y2="2750.4563"/><polygon fill="#181818" points="273.75,2748.4563,268.75,2750.4563,273.75,2752.4563,271.75,2750.4563" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="399" x="271.75" y="2741.0518">confirmationServerResponse(ciphertext, derivedKey, iv, sessionId, clientId, _clientNonceHex, _serverNonceHex, confirmationMessage)</text><polygon fill="#181818" points="1137.5,2766.8093,1142.5,2768.8093,1137.5,2770.8093,1139.5,2768.8093" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="1140.5" y1="2768.8093" y2="2768.8093"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="178" x="271.75" y="2765.9048">decryptMessageAes256CbcMode(ciphertext, derivedKey, iv)</text><polygon fill="#181818" points="273.75,2782.6623,268.75,2784.6623,273.75,2786.6623,271.75,2784.6623" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="1145.5" y1="2784.6623" y2="2784.6623"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="101" x="276.75" y="2781.7578">decryptedPlaintext (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2812.0448" y2="2812.0448"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2812.0448" y2="2818.5448"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2818.5448" y2="2818.5448"/><polygon fill="#181818" points="273.75,2816.5448,268.75,2818.5448,273.75,2820.5448,271.75,2818.5448" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96" x="271.75" y="2809.1403">Parse decryptedPlaintext (JSON)</text><path d="M373.5,2791.1623 L373.5,2831.1623 L561.5,2831.1623 L561.5,2796.1623 L556.5,2791.1623 L373.5,2791.1623 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M556.5,2791.1623 L556.5,2796.1623 L561.5,2796.1623 L556.5,2791.1623 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96.5" x="376.5" y="2800.6108">Client compares extracted fields.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="177.5" x="376.5" y="2809.4638">Since Mallory forwarded a valid confirmation, this validation</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152.5" x="376.5" y="2818.3168">will likely pass, making Alice believe she successfully</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="74.5" x="376.5" y="2827.1698">communicated with Bob.</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2845.9273" y2="2845.9273"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2845.9273" y2="2852.4273"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2852.4273" y2="2852.4273"/><polygon fill="#181818" points="273.75,2850.4273,268.75,2852.4273,273.75,2854.4273,271.75,2852.4273" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131" x="271.75" y="2843.0228">extracts session's id from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2868.2803" y2="2868.2803"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2868.2803" y2="2874.7803"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2874.7803" y2="2874.7803"/><polygon fill="#181818" points="273.75,2872.7803,268.75,2874.7803,273.75,2876.7803,271.75,2874.7803" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125" x="271.75" y="2865.3758">extracts client's id from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2890.6333" y2="2890.6333"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2890.6333" y2="2897.1333"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2897.1333" y2="2897.1333"/><polygon fill="#181818" points="273.75,2895.1333,268.75,2897.1333,273.75,2899.1333,271.75,2897.1333" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="133" x="271.75" y="2887.7288">extracts clientNonce from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2912.9863" y2="2912.9863"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2912.9863" y2="2919.4863"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2919.4863" y2="2919.4863"/><polygon fill="#181818" points="273.75,2917.4863,268.75,2919.4863,273.75,2921.4863,271.75,2919.4863" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="135.5" x="271.75" y="2910.0818">extracts serverNonce from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2935.3393" y2="2935.3393"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2935.3393" y2="2941.8393"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2941.8393" y2="2941.8393"/><polygon fill="#181818" points="273.75,2939.8393,268.75,2941.8393,273.75,2943.8393,271.75,2941.8393" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="271.75" y="2932.4348">extracts message from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2957.6924" y2="2957.6924"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2957.6924" y2="2964.1924"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2964.1924" y2="2964.1924"/><polygon fill="#181818" points="273.75,2962.1924,268.75,2964.1924,273.75,2966.1924,271.75,2964.1924" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="288.5" x="271.75" y="2954.7879">compares the extracted fields with the ones in its memory, updating validationResult accordingly</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="289.25" y1="2982.5454" y2="2982.5454"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="289.25" x2="289.25" y1="2982.5454" y2="2989.0454"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="265.75" x2="289.25" y1="2989.0454" y2="2989.0454"/><polygon fill="#181818" points="270.75,2987.0454,265.75,2989.0454,270.75,2991.0454,268.75,2989.0454" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="271.75" y="2979.6409">(bool validationResult, string decryptedMessage)</text><path d="M5,2994.0454 L36.5,2994.0454 L36.5,2998.8984 L31.5,3003.8984 L5,3003.8984 L5,2994.0454 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="2994.0454"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="12.5" y="3001.4939">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="69.5" x="44" y="3000.9248">[validationResult == true]</text><polygon fill="#181818" points="50.75,3015.2514,45.75,3017.2514,50.75,3019.2514,48.75,3017.2514" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="3017.2514" y2="3017.2514"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="203.5" x="53.75" y="3014.3469">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><path d="M268,3006.3984 L268,3019.8984 L434.5,3019.8984 L434.5,3011.3984 L429.5,3006.3984 L268,3006.3984 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M429.5,3006.3984 L429.5,3011.3984 L434.5,3011.3984 L429.5,3006.3984 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="271" y="3015.8469">Client is unaware it succeeded with Mallory, not Bob.</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="5" x2="439.75" y1="3023.2514" y2="3023.2514"/><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="70.5" x="7.5" y="3029.1308">[validationResult == false]</text><polygon fill="#181818" points="50.75,3041.0953,45.75,3043.0953,50.75,3045.0953,48.75,3043.0953" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="3043.0953" y2="3043.0953"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="53.75" y="3040.1908">Logs "Diffie Hellman key exchange failed"</text><polygon fill="#181818" points="254.75,3060.4483,259.75,3062.4483,254.75,3064.4483,256.75,3062.4483" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="3062.4483" y2="3062.4483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147.5" x="48.75" y="3059.5438">messageExchange(portServerNumber, sessionId)</text><polygon fill="#181818" points="1137.5,3076.3013,1142.5,3078.3013,1137.5,3080.3013,1139.5,3078.3013" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="3078.3013" y2="3078.3013"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="269.25" y="3075.3968">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="271.25,3092.1544,266.25,3094.1544,271.25,3096.1544,269.25,3094.1544" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3094.1544" y2="3094.1544"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="41" x="274.25" y="3091.2499">newIVrotated</text><polygon fill="#181818" points="1137.5,3108.0074,1142.5,3110.0074,1137.5,3112.0074,1139.5,3110.0074" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="3110.0074" y2="3110.0074"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="79.5" x="269.25" y="3107.1029">getFormattedTimestamp()</text><polygon fill="#181818" points="271.25,3123.8604,266.25,3125.8604,271.25,3127.8604,269.25,3125.8604" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3125.8604" y2="3125.8604"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="46.5" x="274.25" y="3122.9559">newTimeStamp</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3141.7134" y2="3141.7134"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3141.7134" y2="3148.2134"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3148.2134" y2="3148.2134"/><polygon fill="#181818" points="271.25,3146.2134,266.25,3148.2134,271.25,3150.2134,269.25,3148.2134" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="240" x="269.25" y="3138.8089">built message sent with clientId, sessionId, newTimeStamp as clientMessageSent</text><polygon fill="#181818" points="1137.5,3162.0664,1142.5,3164.0664,1137.5,3166.0664,1139.5,3164.0664" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="3164.0664" y2="3164.0664"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="224.5" x="269.25" y="3161.1619">encryptMessageAes256CbcMode(newPlaintext, _derivedSymmetricKey, _iv)</text><polygon fill="#181818" points="271.25,3177.9194,266.25,3179.9194,271.25,3181.9194,269.25,3179.9194" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3179.9194" y2="3179.9194"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="274.25" y="3177.0149">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3198.4489" y2="3198.4489"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3198.4489" y2="3204.9489"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3204.9489" y2="3204.9489"/><polygon fill="#181818" points="271.25,3202.9489,266.25,3204.9489,271.25,3206.9489,269.25,3204.9489" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="269.25" y="3195.5444">built "client_message_exchange" message</text><path d="M96.5,3186.4194 L96.5,3208.9194 L258,3208.9194 L258,3191.4194 L253,3186.4194 L96.5,3186.4194 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,3186.4194 L253,3191.4194 L258,3191.4194 L253,3186.4194 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151" x="99.5" y="3195.8679">Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="99.5" y="3204.7209">with sessionId, newIVrotated and ciphertext</text><polygon fill="#181818" points="1200.5,3221.4784,1205.5,3223.4784,1200.5,3225.4784,1202.5,3223.4784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1203.5" y1="3223.4784" y2="3223.4784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="269.25" y="3220.5739">HTTP POST /messageExchange (client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3239.3314" y2="3239.3314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3239.3314" y2="3245.8314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3245.8314" y2="3245.8314"/><polygon fill="#181818" points="1217,3243.8314,1212,3245.8314,1217,3247.8314,1215,3245.8314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="1215" y="3236.4269">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3261.6844" y2="3261.6844"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3261.6844" y2="3268.1844"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3268.1844" y2="3268.1844"/><polygon fill="#181818" points="1217,3266.1844,1212,3268.1844,1217,3270.1844,1215,3268.1844" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="1215" y="3258.7799">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3284.0374" y2="3284.0374"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3284.0374" y2="3290.5374"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3290.5374" y2="3290.5374"/><polygon fill="#181818" points="1217,3288.5374,1212,3290.5374,1217,3292.5374,1215,3290.5374" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="1215" y="3281.1329">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3306.3905" y2="3306.3905"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3306.3905" y2="3312.8905"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3312.8905" y2="3312.8905"/><polygon fill="#181818" points="1217,3310.8905,1212,3312.8905,1217,3314.8905,1215,3312.8905" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="1215" y="3303.486">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3328.7435" y2="3328.7435"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3328.7435" y2="3335.2435"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3335.2435" y2="3335.2435"/><polygon fill="#181818" points="1217,3333.2435,1212,3335.2435,1217,3337.2435,1215,3335.2435" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="1215" y="3325.839">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M1188,3342.7435 L1219.5,3342.7435 L1219.5,3347.5965 L1214.5,3352.5965 L1188,3352.5965 L1188,3342.7435 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="1188" y="3342.7435"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1195.5" y="3350.192">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="86.5" x="1227" y="3349.6229">[sessionIdASFoundFlag == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3364.4495" y2="3364.4495"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3364.4495" y2="3370.9495"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3370.9495" y2="3370.9495"/><polygon fill="#181818" points="1217,3368.9495,1212,3370.9495,1217,3372.9495,1215,3370.9495" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1215" y="3361.545">Throws an exception</text><polygon fill="#181818" points="2529,3388.3025,2534,3390.3025,2529,3392.3025,2531,3390.3025" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3390.3025" y2="3390.3025"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="1215" y="3387.398">hexToBytes(extractedIv)</text><polygon fill="#181818" points="1217,3404.1555,1212,3406.1555,1217,3408.1555,1215,3406.1555" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3406.1555" y2="3406.1555"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="29.5" x="1220" y="3403.251">iv as ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3422.0085" y2="3422.0085"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3422.0085" y2="3428.5085"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3428.5085" y2="3428.5085"/><polygon fill="#181818" points="1217,3426.5085,1212,3428.5085,1217,3430.5085,1215,3428.5085" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1215" y="3419.104">store new iv in bytes for that session id</text><polygon fill="#181818" points="2529,3442.3615,2534,3444.3615,2529,3446.3615,2531,3444.3615" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3444.3615" y2="3444.3615"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="1215" y="3441.457">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, ivAM)</text><polygon fill="#181818" points="1217,3459.7145,1212,3461.7145,1217,3463.7145,1215,3461.7145" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3461.7145" y2="3461.7145"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1220" y="3458.81">plaintext</text><path d="M1046.5,3450.8615 L1046.5,3464.3615 L1204,3464.3615 L1204,3455.8615 L1199,3450.8615 L1046.5,3450.8615 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3450.8615 L1199,3455.8615 L1204,3455.8615 L1199,3450.8615 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="1049.5" y="3460.31">Mallory build fake client request to the real server</text><polygon fill="#181818" points="2529,3477.0675,2534,3479.0675,2529,3481.0675,2531,3479.0675" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3479.0675" y2="3479.0675"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1215" y="3476.163">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1217,3492.9205,1212,3494.9205,1217,3496.9205,1215,3494.9205" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3494.9205" y2="3494.9205"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="29" x="1220" y="3492.016">iv as ivMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3510.7735" y2="3510.7735"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3510.7735" y2="3517.2735"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3517.2735" y2="3517.2735"/><polygon fill="#181818" points="1217,3515.2735,1212,3517.2735,1217,3519.2735,1215,3517.2735" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187.5" x="1215" y="3507.869">store new iv in bytes for that session id for Mallory -&gt; Server leg</text><polygon fill="#181818" points="2529,3531.1266,2534,3533.1266,2529,3535.1266,2531,3533.1266" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3533.1266" y2="3533.1266"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="192.5" x="1215" y="3530.2221">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivMS)</text><polygon fill="#181818" points="1217,3548.4796,1212,3550.4796,1217,3552.4796,1215,3550.4796" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3550.4796" y2="3550.4796"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40" x="1220" y="3547.5751">ciphertextMS</text><path d="M1059,3539.6266 L1059,3553.1266 L1204,3553.1266 L1204,3544.6266 L1199,3539.6266 L1059,3539.6266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3539.6266 L1199,3544.6266 L1204,3544.6266 L1199,3539.6266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1062" y="3549.0751">Mallory build body request for the real server</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3570.5091" y2="3570.5091"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3570.5091" y2="3577.0091"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3577.0091" y2="3577.0091"/><polygon fill="#181818" points="1217,3575.0091,1212,3577.0091,1217,3579.0091,1215,3577.0091" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="1215" y="3567.6046">built fake "client_message_exchange" message</text><path d="M1004.5,3558.4796 L1004.5,3580.9796 L1204,3580.9796 L1204,3563.4796 L1199,3558.4796 L1004.5,3558.4796 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3558.4796 L1199,3563.4796 L1204,3563.4796 L1199,3558.4796 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189" x="1007.5" y="3567.9281">Mallory fake Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="1007.5" y="3576.7811">with sessionId, ivMS and ciphertext</text><polygon fill="#181818" points="2601.5,3593.5386,2606.5,3595.5386,2601.5,3597.5386,2603.5,3595.5386" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2604.5" y1="3595.5386" y2="3595.5386"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="207" x="1215" y="3592.6341">HTTP POST /messageExchange (fake client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3611.3916" y2="3611.3916"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3611.3916" y2="3617.8916"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3617.8916" y2="3617.8916"/><polygon fill="#181818" points="2618,3615.8916,2613,3617.8916,2618,3619.8916,2616,3617.8916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="2616" y="3608.4871">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3633.7446" y2="3633.7446"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3633.7446" y2="3640.2446"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3640.2446" y2="3640.2446"/><polygon fill="#181818" points="2618,3638.2446,2613,3640.2446,2618,3642.2446,2616,3640.2446" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2616" y="3630.8401">extract session id as extractedSessionIdUuidFormat</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3656.0976" y2="3656.0976"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3656.0976" y2="3662.5976"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3662.5976" y2="3662.5976"/><polygon fill="#181818" points="2618,3660.5976,2613,3662.5976,2618,3664.5976,2616,3662.5976" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="2616" y="3653.1931">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3678.4506" y2="3678.4506"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3678.4506" y2="3684.9506"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3684.9506" y2="3684.9506"/><polygon fill="#181818" points="2618,3682.9506,2613,3684.9506,2618,3686.9506,2616,3684.9506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="2616" y="3675.5461">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3700.8036" y2="3700.8036"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3700.8036" y2="3707.3036"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3707.3036" y2="3707.3036"/><polygon fill="#181818" points="2618,3705.3036,2613,3707.3036,2618,3709.3036,2616,3707.3036" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="2616" y="3697.8991">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M2582.25,3714.8036 L2613.75,3714.8036 L2613.75,3719.6566 L2608.75,3724.6566 L2582.25,3724.6566 L2582.25,3714.8036 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2582.25" y="3714.8036"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2589.75" y="3722.2521">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="130" x="2621.25" y="3721.6831">[extractedSessionIdUuidFormat does not exist]</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3736.5096" y2="3736.5096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3736.5096" y2="3743.0096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3743.0096" y2="3743.0096"/><polygon fill="#181818" points="2618,3741.0096,2613,3743.0096,2618,3745.0096,2616,3743.0096" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="2616" y="3733.6051">Throws an exception</text><polygon fill="#181818" points="3466.75,3760.3627,3471.75,3762.3627,3466.75,3764.3627,3468.75,3762.3627" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3469.75" y1="3762.3627" y2="3762.3627"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="2616" y="3759.4582">hexToBytes(extractedIv)</text><polygon fill="#181818" points="2618,3776.2157,2613,3778.2157,2618,3780.2157,2616,3778.2157" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3474.75" y1="3778.2157" y2="3778.2157"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2621" y="3775.3112">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3794.0687" y2="3794.0687"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3794.0687" y2="3800.5687"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3800.5687" y2="3800.5687"/><polygon fill="#181818" points="2618,3798.5687,2613,3800.5687,2618,3802.5687,2616,3800.5687" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2616" y="3791.1642">store new iv in bytes for that session id</text><polygon fill="#181818" points="3466.75,3814.4217,3471.75,3816.4217,3466.75,3818.4217,3468.75,3816.4217" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3469.75" y1="3816.4217" y2="3816.4217"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="2616" y="3813.5172">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, iv)</text><polygon fill="#181818" points="2618,3830.2747,2613,3832.2747,2618,3834.2747,2616,3832.2747" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3474.75" y1="3832.2747" y2="3832.2747"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="2621" y="3829.3702">plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3848.1277" y2="3848.1277"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3848.1277" y2="3854.6277"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3854.6277" y2="3854.6277"/><polygon fill="#181818" points="2618,3852.6277,2613,3854.6277,2618,3856.6277,2616,3854.6277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="212.5" x="2616" y="3845.2232">build server's confirmation with server id, extracted session id, plaintext</text><polygon fill="#181818" points="3466.75,3868.4807,3471.75,3870.4807,3466.75,3872.4807,3468.75,3870.4807" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3469.75" y1="3870.4807" y2="3870.4807"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="2616" y="3867.5762">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="2618,3884.3337,2613,3886.3337,2618,3888.3337,2616,3886.3337" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3474.75" y1="3886.3337" y2="3886.3337"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2621" y="3883.4292">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3902.1867" y2="3902.1867"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3902.1867" y2="3908.6867"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3908.6867" y2="3908.6867"/><polygon fill="#181818" points="2618,3906.6867,2613,3908.6867,2618,3910.6867,2616,3908.6867" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2616" y="3899.2822">store new iv in bytes for that session id</text><polygon fill="#181818" points="3466.75,3922.5397,3471.75,3924.5397,3466.75,3926.5397,3468.75,3924.5397" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3469.75" y1="3924.5397" y2="3924.5397"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="183" x="2616" y="3921.6352">encryptMessageAes256CbcMode(plaintext, symmetricKey, iv)</text><polygon fill="#181818" points="2618,3938.3927,2613,3940.3927,2618,3942.3927,2616,3940.3927" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3474.75" y1="3940.3927" y2="3940.3927"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2621" y="3937.4882">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3956.2457" y2="3956.2457"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3956.2457" y2="3962.7457"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3962.7457" y2="3962.7457"/><polygon fill="#181818" points="2618,3960.7457,2613,3962.7457,2618,3964.7457,2616,3962.7457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="244" x="2616" y="3953.3412">built server confirmation message with server id, extractedSessionId and plaintext</text><path d="M2413.5,3948.6427 L2413.5,3962.1427 L2605,3962.1427 L2605,3953.6427 L2600,3948.6427 L2413.5,3948.6427 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2600,3948.6427 L2600,3953.6427 L2605,3953.6427 L2600,3948.6427 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="2416.5" y="3958.0912">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3981.2753" y2="3981.2753"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3981.2753" y2="3987.7753"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3987.7753" y2="3987.7753"/><polygon fill="#181818" points="2618,3985.7753,2613,3987.7753,2618,3989.7753,2616,3987.7753" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2616" y="3978.3708">built "client_message_exchange" response message</text><path d="M2411,3969.2457 L2411,3991.7457 L2605,3991.7457 L2605,3974.2457 L2600,3969.2457 L2411,3969.2457 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2600,3969.2457 L2600,3974.2457 L2605,3974.2457 L2600,3969.2457 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="2414" y="3978.6943">Server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124.5" x="2414" y="3987.5473">with extractedSessionId, iv and ciphertext</text><polygon fill="#181818" points="1217,4004.3048,1212,4006.3048,1217,4008.3048,1215,4006.3048" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2609.5" y1="4006.3048" y2="4006.3048"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="172" x="1220" y="4003.4003">HTTP 201 OK (Server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4022.1578" y2="4022.1578"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4022.1578" y2="4028.6578"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4028.6578" y2="4028.6578"/><polygon fill="#181818" points="1217,4026.6578,1212,4028.6578,1217,4030.6578,1215,4028.6578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="67.5" x="1215" y="4019.2533">Parse requestMS body</text><path d="M1188,4036.1578 L1219.5,4036.1578 L1219.5,4041.0108 L1214.5,4046.0108 L1188,4046.0108 L1188,4036.1578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="1188" y="4036.1578"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1195.5" y="4043.6063">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="84.5" x="1227" y="4043.0372">[requestMS.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4057.8638" y2="4057.8638"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4057.8638" y2="4064.3638"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4064.3638" y2="4064.3638"/><polygon fill="#181818" points="1217,4062.3638,1212,4064.3638,1217,4066.3638,1215,4064.3638" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1215" y="4054.9593">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4083.7168" y2="4083.7168"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4083.7168" y2="4090.2168"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4090.2168" y2="4090.2168"/><polygon fill="#181818" points="1217,4088.2168,1212,4090.2168,1217,4092.2168,1215,4090.2168" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="1215" y="4080.8123">extract session id as extractedSessionIdMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4106.0698" y2="4106.0698"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4106.0698" y2="4112.5698"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4112.5698" y2="4112.5698"/><polygon fill="#181818" points="1217,4110.5698,1212,4112.5698,1217,4114.5698,1215,4112.5698" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92.5" x="1215" y="4103.1653">extract iv as extractedIvHexMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4128.4228" y2="4128.4228"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4128.4228" y2="4134.9228"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4134.9228" y2="4134.9228"/><polygon fill="#181818" points="1217,4132.9228,1212,4134.9228,1217,4136.9228,1215,4134.9228" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="1215" y="4125.5183">extract ciphertext as extractedCiphertextMS</text><polygon fill="#181818" points="2529,4148.7758,2534,4150.7758,2529,4152.7758,2531,4150.7758" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4150.7758" y2="4150.7758"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="94.5" x="1215" y="4147.8713">hexToBytes(extractedIvHexMS)</text><polygon fill="#181818" points="1217,4164.6288,1212,4166.6288,1217,4168.6288,1215,4166.6288" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4166.6288" y2="4166.6288"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="1220" y="4163.7243">extractedIvMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4182.4818" y2="4182.4818"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4182.4818" y2="4188.9818"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4188.9818" y2="4188.9818"/><polygon fill="#181818" points="1217,4186.9818,1212,4188.9818,1217,4190.9818,1215,4188.9818" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60.5" x="1215" y="4179.5773">store extractedIvMS</text><polygon fill="#181818" points="2529,4202.8349,2534,4204.8349,2529,4206.8349,2531,4204.8349" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4204.8349" y2="4204.8349"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="264.5" x="1215" y="4201.9304">decryptMessageAes256CbcMode(extractedCiphertextMS, symmetricKey, extractedIvMS)</text><polygon fill="#181818" points="1217,4220.1879,1212,4222.1879,1217,4224.1879,1215,4222.1879" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4222.1879" y2="4222.1879"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1220" y="4219.2834">plaintext</text><path d="M1004,4211.3349 L1004,4224.8349 L1204,4224.8349 L1204,4216.3349 L1199,4211.3349 L1004,4211.3349 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4211.3349 L1199,4216.3349 L1204,4216.3349 L1199,4211.3349 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189.5" x="1007" y="4220.7834">Mallory build client's request response instead of the real server</text><polygon fill="#181818" points="2529,4237.5409,2534,4239.5409,2529,4241.5409,2531,4239.5409" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4239.5409" y2="4239.5409"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1215" y="4236.6364">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1217,4253.3939,1212,4255.3939,1217,4257.3939,1215,4255.3939" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4255.3939" y2="4255.3939"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="1220" y="4252.4894">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4271.2469" y2="4271.2469"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4271.2469" y2="4277.7469"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4277.7469" y2="4277.7469"/><polygon fill="#181818" points="1217,4275.7469,1212,4277.7469,1217,4279.7469,1215,4277.7469" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="1215" y="4268.3424">store new iv in bytes for that session id for Alice -&gt; Mallory leg</text><polygon fill="#181818" points="2529,4291.5999,2534,4293.5999,2529,4295.5999,2531,4293.5999" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4293.5999" y2="4293.5999"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="1215" y="4290.6954">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivAM)</text><polygon fill="#181818" points="1217,4307.4529,1212,4309.4529,1217,4311.4529,1215,4309.4529" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4309.4529" y2="4309.4529"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40.5" x="1220" y="4306.5484">ciphertextAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4325.3059" y2="4325.3059"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4325.3059" y2="4331.8059"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4331.8059" y2="4331.8059"/><polygon fill="#181818" points="1217,4329.8059,1212,4331.8059,1217,4333.8059,1215,4331.8059" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="267.5" x="1215" y="4322.4014">built fake server confirmation message with server id, extractedSessionIdMS and plaintext</text><path d="M1012.5,4317.7029 L1012.5,4331.2029 L1204,4331.2029 L1204,4322.7029 L1199,4317.7029 L1012.5,4317.7029 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4317.7029 L1199,4322.7029 L1204,4322.7029 L1199,4317.7029 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="1015.5" y="4327.1514">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4350.3354" y2="4350.3354"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4350.3354" y2="4356.8354"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4356.8354" y2="4356.8354"/><polygon fill="#181818" points="1217,4354.8354,1212,4356.8354,1217,4358.8354,1215,4356.8354" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168.5" x="1215" y="4347.4309">built fake "client_message_exchange" response message</text><path d="M995,4338.3059 L995,4360.8059 L1204,4360.8059 L1204,4343.3059 L1199,4338.3059 L995,4338.3059 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4338.3059 L1199,4343.3059 L1204,4343.3059 L1199,4338.3059 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="998" y="4347.7544">Fake server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154" x="998" y="4356.6074">with extractedSessionIdMS, ivAM and ciphertextAM</text><polygon fill="#181818" points="271.25,4373.3649,266.25,4375.3649,271.25,4377.3649,269.25,4375.3649" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1208.5" y1="4375.3649" y2="4375.3649"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187" x="274.25" y="4372.4604">HTTP 201 OK (Fake server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4391.2179" y2="4391.2179"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4391.2179" y2="4397.7179"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4397.7179" y2="4397.7179"/><polygon fill="#181818" points="271.25,4395.7179,266.25,4397.7179,271.25,4399.7179,269.25,4397.7179" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="269.25" y="4388.3134">Parse request body</text><path d="M235.5,4405.2179 L267,4405.2179 L267,4410.071 L262,4415.071 L235.5,4415.071 L235.5,4405.2179 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="4405.2179"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="4412.6665">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="76.5" x="274.5" y="4412.0974">[request.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4426.924" y2="4426.924"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4426.924" y2="4433.424"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4433.424" y2="4433.424"/><polygon fill="#181818" points="271.25,4431.424,266.25,4433.424,271.25,4435.424,269.25,4433.424" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="4424.0195">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4452.777" y2="4452.777"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4452.777" y2="4459.277"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4459.277" y2="4459.277"/><polygon fill="#181818" points="271.25,4457.277,266.25,4459.277,271.25,4461.277,269.25,4459.277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="269.25" y="4449.8725">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4475.13" y2="4475.13"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4475.13" y2="4481.63"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4481.63" y2="4481.63"/><polygon fill="#181818" points="271.25,4479.63,266.25,4481.63,271.25,4483.63,269.25,4481.63" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83" x="269.25" y="4472.2255">extract iv as extractedIvHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4497.483" y2="4497.483"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4497.483" y2="4503.983"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4503.983" y2="4503.983"/><polygon fill="#181818" points="271.25,4501.983,266.25,4503.983,271.25,4505.983,269.25,4503.983" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="269.25" y="4494.5785">extract ciphertext as extractedCiphertext</text><polygon fill="#181818" points="1137.5,4517.836,1142.5,4519.836,1137.5,4521.836,1139.5,4519.836" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="4519.836" y2="4519.836"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="85" x="269.25" y="4516.9315">hexToBytes(extractedIvHex)</text><polygon fill="#181818" points="271.25,4533.689,266.25,4535.689,271.25,4537.689,269.25,4535.689" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="4535.689" y2="4535.689"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="34" x="274.25" y="4532.7845">extractedIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4551.542" y2="4551.542"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4551.542" y2="4558.042"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4558.042" y2="4558.042"/><polygon fill="#181818" points="271.25,4556.042,266.25,4558.042,271.25,4560.042,269.25,4558.042" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="51" x="269.25" y="4548.6375">store extractedIv</text><polygon fill="#181818" points="1137.5,4571.895,1142.5,4573.895,1137.5,4575.895,1139.5,4573.895" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="4573.895" y2="4573.895"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="245.5" x="269.25" y="4570.9905">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, extractedIv)</text><polygon fill="#181818" points="271.25,4587.748,266.25,4589.748,271.25,4591.748,269.25,4589.748" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="4589.748" y2="4589.748"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="274.25" y="4586.8435">decryptedCiphertext</text><path d="M235.5,4597.248 L267,4597.248 L267,4602.101 L262,4607.101 L235.5,4607.101 L235.5,4597.248 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="4597.248"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="4604.6965">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="151" x="274.5" y="4604.1275">[decryptedCiphertext.find(clientMessageSent) == true]</text><path d="M268,4609.601 L268,4623.101 L392.5,4623.101 L392.5,4614.601 L387.5,4609.601 L268,4609.601 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M387.5,4609.601 L387.5,4614.601 L392.5,4614.601 L387.5,4609.601 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="114" x="271" y="4619.0495">Connection Test Result : Success (true)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="428" y1="4626.454" y2="4626.454"/><path d="M268,4629.454 L268,4642.954 L390.5,4642.954 L390.5,4634.454 L385.5,4629.454 L268,4629.454 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M385.5,4629.454 L385.5,4634.454 L390.5,4634.454 L385.5,4629.454 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="112" x="271" y="4638.9026">Connection Test Result : Failure (false)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4657.6601" y2="4657.6601"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4657.6601" y2="4664.1601"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4664.1601" y2="4664.1601"/><polygon fill="#181818" points="271.25,4662.1601,266.25,4664.1601,271.25,4666.1601,269.25,4664.1601" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="4654.7556">Throws an exception</text><polygon fill="#181818" points="50.75,4681.5131,45.75,4683.5131,50.75,4685.5131,48.75,4683.5131" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="4683.5131" y2="4683.5131"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="53.75" y="4680.6086">connectionTestResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="66.25" y1="4701.8661" y2="4701.8661"/><line style="stroke:#181818;stroke-width:0.5;" x1="66.25" x2="66.25" y1="4701.8661" y2="4708.3661"/><line style="stroke:#181818;stroke-width:0.5;" x1="42.75" x2="66.25" y1="4708.3661" y2="4708.3661"/><polygon fill="#181818" points="47.75,4706.3661,42.75,4708.3661,47.75,4710.3661,45.75,4708.3661" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="42.5" x="48.75" y="4698.9616">Program ends</text><!--SRC=[nHrhRziuyhj-1I-7GsL0pUqkiFUXG0iaQTBajcc3EbtWSBWr58cnTR4bdIGxpM9__0sV8iM7ACVDzaDho-BCS3YSDzasIzSO_N3ySnJTLT_GqTcwm6M7pijTqLJb1ZuVeRz-B9QhxbzulQuU8mH_whJfYgoeKtZpQ9CM9OgRRSc6_ZWxGccBhk6f-Iw77fzMT-mrzi3rufivRjkYAj-dNQgyhZnrZdnVtDyN-19etgIbClRzfNl8vKtQf9lsOvNckD76i4VEaTT0KBh4vz-w9iqw8EqYpOfrqJqfGAxFBvpZpykiUQh9mA_TSDpvrmYNEOB5uIjqqdLfze0RsngTLKswDj5Sfx1qpHDV6FhP-T8R_k-GzUPZDmYnp5s5vhZPuMQcWhX87x1htGK4RVae83P20_J-SZeO2ptlBzb33nXJCkHObsX8TdfbWxzb5Gu1mIuT_5T3FDXSRC9nkjvY4mj_FpwvkM9SOG_Wg-jTOrUonrx9u2FDNSb-iErACSJalHZZOZqVwUSyUydAU3xUpdVseyfs0doNTfZfl8ZyZLw_umABtg2p1fDVsVVu27JVKO9oVBTTNgpJPOAMJRMjFwKR_FvorWDJH9j3UWr0AV0tgCIFueKS3uUO5EGgst_1J-VVibLQBd5SDrM-fRovgPhEZZrTTsYXq7YCDtNt5C_GsxVeFbstJAPKEjz9lTdFNblvUA5CVw7Ddy311m1QN-9lyCyA_k50ovnDHvyYbxmU4y1NS34H0unh-F1-HKKHTxXfuoNkrEyNnHgNyFbZbQM4d_5i9W4RA1N17IBd25_hy_s2ksrJjeXl1eeHRT9QWZ2am43YdIQWME8IDp3-fg5WG4fYpmmiYADW3DkxTP658h03X7qB44-lFdpwUdrRmIB7Yrg0FOQbKTblWI-slOc401umdz6B038wGV5A29IJzIfmoxhO-AIf2ui3WugoxT8ommW4FsV6smbwk6FElohCFoCghLesQRqgiayLW8nBylUy-1tFR1i4D9rEBu3JwCte1meAri5E6W2naWR3xxO5A9YZXruh7Q4DqznqI5a1b3M-xuOQ8Qk09mrehnRzS_xv4pfYX2nMn4yzacy_5jsAqtYL9ogrYNod1YMS82b09q9XKEH3ohdX1T8lRszlqCtd-Itwkq8-YjcxPEagIjg0hy83a-W5H0quPcQB4_ogHIsphwZ8YHdYF-FyZ4zj8ZIww1eWoXD5xuV3gfjYWr6jGRiXpsuc0k92MZLegG7x89v_c4ePsxgmEZfn-afBCMk8cwHjRW6xA47bPhZkX5jEL_TOU_SI2mnjJq4lS_25YPtWLwBF5yIjbfgcXop5q3lpzZ6jQvLHwAtSyX-apJXzOi73l2FFbq-nXSF9S0s9XVw2wtMQOU9DwX1c7hAOZWPzULjzBOl_RJ5Jrx5b6Io6OE0P3z08DTrpeCQuaG1XlP2A4zrNpIRjR6fPmUDdiM0dWykztQiyTjDkbIITwbQ0yP3ceqjnkdktoFmjNaWbdrXtV68g55XtrQ4gTXznkUnM2HLSzwI7OS20TfNWVXeYadEvTWeXEdOR1LfOQ2518bFnknszcG77H6Xnw0oaYcTdpdhKmNEBXnExRxeIiTVjcynXZoQrxGM1d9eGYe1ewbURHVlAEjRGXJwkx2449bSihkhtPafMRUejvKbllAuNSr3eyVAtpMA6_eRgFu4xKptk46NkL-hAUYWkE665wOIxbVhe35tArE60AxaenHaFO7MuDWntsFsAK77T1tYv3s-TTuFRBNZaBJW3E2U6TD7Ib8Vmy4-kHsOidFtfS_q2Jb2rkVer5iRcPUPNx0uo9ysmDroXRumN4mLrjy94ouEbLONjEgt_BHs3_tWy0vkjzJWBoeO2Ur7iy7oL0Y5pd06rDhSiyHBs-fqX6QC3z63nvDhjHrXLL93oNhJAj8ZQr5t3to0v98qTqQOBNPr6K_GXzMvFdq1Tnpel_99hKKoZEb21Jn56qtJVljFIL-pmqrBWxpEj88d8OOE0pKhR5OY3AXrVqaUA5FtnXq48UURbUPWmifsMpvysuDKrJ0JVeldboKy__oFk2PjDMf-E6628mOfo6TimJ5wcyNKorQO5hqW0FMFzUkI1EACfjjTKYdqrIZ54aDX-a1dx89LsbJFjfqHC_c7QhoVNhz-13yK2xdYMcF6yMr4Eocc3cIhJqmqKAI5aFFO3buQaJI15ahAPLoKc3ubv0XzdpVU1XzCA4NfAHSlSwMwkJD-j82og7airiu9agKuRJ9DvPsfkXTjNkaLlApOaqSR8R8l1KoNbHxrAJfgUDuBCWIWQcZcPKBbo5c0e5qXs2TLGW65uFcqtTogs45uxLlpTiCOPKZi9YR0jQwFjPeujBCAUK4evV0Wk-V8zGl1939AKx1cJEzR4Lg7PZvn9mR236Z_MVOBCAO6cpzB9-GO5c-41fqrSE7F6ryEXJq9hH5Df2A_rXYWTdUJfTM2fRhypOgDMhEZvS1KxiSpstA1Mc-Ez_ABLuIR7i-FS72lN-Oq_-KF0SSyZj8QdcN_gaFG5lS7K4sFGeBW7MpgoPit6-I4xOporlzw7i5S1ZMNlssqCodjy0-HWe5fi843nVLDj1EcpS72YR7RVhyo4UkEUuCCAa7i23wX8xWbvGeboNzf7QvRHnEmoDoQ3ucGBAvj0tnT0nTIPdYNMqJOF6xAWgw9y0124OhwPwOewWEYEjcLmNto7w8V47Nm9xUOUzYnvXtlqwg94pgnu5BJ1J0_4MwvqR6UN_z7ZU3sG1Jr7DPhWxj64Yzju0TEZdDopePW6gCoofdCEePhFMkaqVZfeeRFVtC8p6MMLg_gfJsoG2XVzZ07LJwUFvA1dq4XbaiAQglIEoh0gg1EZ9n8RubO2CeK9mP6OKwX6YR1DFZJocixgm0hWG5yxgwFfAoy8PntGmwwz6UM92L-AJ_Q2wOaecARkYkaBSMpVg7Q2OV4Pc64J8-6DEwXr6fhn-JfqzLw5L1_dfshMVUkfZZMmH6Ww4JnGi_5YhBWQneDXz3QL1oDrrXUPTx4x-5m7JeWemHwYzkeaJpNu8MuCtOp1rLTTEE21hneNhci3TEnGjxAg6JXsjAZA-r4Kh_u4wgfzMVNKhtDlLmLu_otpuJN0TxXxnBYK-NJYwJDIZgF9cjkYcPXaX9IkWfMFQv51iPzLvNr16Wz1GlXfb7ZVDNDEHeWvanKIKIbOHMw6X9AsDCrpPidGauHGhkEiqoVYFnu-hB1XuGJGr11iutNUlX4pJVeu976qWAiLtiF5AbJPOdPyYA_x2MwXu7jsbrrNEItxz8BHqcAXAP4q5XaL5uTMjcXapiEYXdfR1_ecsaltkXDxcjhGytgW_cju14QVlK2JLdQZGnTIMJTbWPGitcdYK0UKvtWWa74_wSNrF4753dOxV9hvvd27GKvscASfMj0qK6qdTKcQCQ5-37WjgBgtjlkwKukcYDloh3I_-DCFFwBFlsXCiwGInyNKe-_xVAMIXLBRtHNSfWfMMzu3rWmvrk5uluoijU5Aga4fSpdcGZ6nVctj0cUfr-62yDIhKYkV1PrKKCZLqwsIcUV2BmY49zE838xGUdk3UVuv4MME4fWY85Cfay1CozQ3yiDITGDheY7E2AjiKFL3_19XIoQP4Egl6DG4dp41n0NXTBgfuL3-VxVG6j1cLLKpJuaq2y6FhDAGIrT9D6beC1bDCb4g6ZsA3kKL9WlHeGwmm2lK3HRsag9a22ZEWHOfQQQO02rsy05q8IxRRKDwHJfIbAdAhgdMgABPvZHRWPrO4WL9IG2e9LvFEjWooOwobRIRqWLjpY5zdkwsYe4XjHRTDFkvKBf6_HMsoPqmgdwHORBP2LE1C1KbrJastGi4AWMfcLO4EqcYYOOJUCUMlYow8bqNlxDNTZWZYNVAt6Fh_8ZfxAUc96bY86Cc-eouY4PwwU61R4vcSBazfkaBs2LmZ5ehbjXnRu4pY6mgWfgf7y0buk2STlVGJQT8QafFE1s7TFke1narYzsRLRljTftoiHoGT5YStgKogtuMHSF1ZLXhJLpaM9bqLesvEaUoZec-CuHnvtl4TPXoR9PiSjGrKUsg1K2mHGq7uB1zIcUB3mpb6YADJ7gXK31p580owu2ouEb4UFrgKJz1Zmh2mHGxCXoIETPnZg9DNwxHSY-9bT79u8InjO8Z0gN1kMDRESQaJDl6XyeQ6MUWZKoHXSbpWaT5pPfU1wWYvxq8GOcbKstBKuxQqahk8_aEFqQUoxQcZDf1mkXKInYTc0cZyIIHk6Q6sWTcdBXEydWPzaFtZemGX_rQcZ96nuFei0u-Ws-qrOzr1pDo61NMzL1JyhQh2nHHxe55pWiBt3BbpME5tAPX8qd65wvaLMQYdCRnePzF9VuBDvgANvCex25wn94qMWoLa96RjL1ivP7pPXFgxV9WrUxjEebsNgGnS6hjDpZ80FbcdPB87qo2evN8UR63rwhRuEjfZ76D0ljEiNeyEjDzldb1pBNOgk3PFQPD3k-cQ0VkgkxP9iphep_G1mFdUhr6w-81hvyWpTYsYTqJRObcscOPhDNzTWtlQa20wissB3BgPr9t7LpMKSNaSaceIBAmdgSQI465q5GBfWP1KlC31m34lCPd0LBTpsS14jfZ7o1In8Yr6OfPdnI0Sn4jCSa5HRS1EKlGjYOI18XwOVh2gbrfbbKDoHgkdynTecAFxoe8cuVZYTj1anDo_sXgnNBnasZXDIY1zbs8C6sonY-K-bWjMtJ4AhL8b6g9hodo3KpGSNv4pQoao2Wg-7SoRBbjcSA-n2GLmK6AxS5tRaAp4-wzGhg1hJDqNKOLFCNx54uUv4VokgYWkxLajaTSgJKunw7OardalTxBUb-FBDKkz5hjr5jwuBZFrQyDf6b4GYhuZXvEJdT1hz20uRVGcDUIx56yDoa4n9o0sFEw8B7LM_9mSCEFOhvLJ7qsbE-YkTmorXdxqau0LvgoqThDvFkKz50ic3coDvltK7CUBV1XhbKom4MkYeqgQbHR36OqwMAbmVP2iOCStqLB0Gdz1aDB9EG-xwhyAUoE8KTxzDpeVFH2OU4p_tQr2xpUI0lT-sYuP_D8_dk5imTKt6jpMDCU781Mj1quF6JTQDHBxHwesor9ZD4lt5WrHNgtnlt2dymlgcsPapx5I3rFOdl1Vfx4IkpjggaUITAPw6bSQxwQkDDlvDmxtSzAx2KvThLxTZfOv3_6Si7-svieeyc9J007zkMEdZzckSbK5RLeR9Q-yC4YAA0jDQLra0ovwN1vEHAO9MTbVhL8AVQivw1gQ8rXpDeUG42kvoyX8FIP0eBNiY6x7JsdpbBtrcueC6eL_TabbL0cJP8PejEbi32UZKYBVp6OcQMI66PhnmbLZfllOO1jHfWiZCtuZixJSSZ9iCFAJlGPOssrHXg0HiuxMMrqq06RCLlzTLla5_eDSK5mNTOxQF04A-w5ztBMN5Xq7mFx-ZB57Tv7vhFpGcX7EH9awSEQg9mDL8F6LLlJLD24zp3wlba_s_8VZ46c_GzgBXlfCBItDtArHuqSESxMfsvw_YKEYeBO6k8Pl8n07Lgg9hDYJmVXO7noT2wERS2m6VQYrWbvifOcd08dTI6xoLLANE2fQD5qI6Iz5IuBh_3tFWipWBnFGR700Vrp8tDsUpAIZ6d7l1sTe05uxCU-JKOdrFxQNHndRtWqsePfRxuaNGvS13GlHv8zYwAmXapJfnmuEE2uQIuECRdofsF8l7NRTf71haD_UKke78cXnqFemoGy5DyzFEL1B3DKpqB7ZlfC06Y_H00bujcHZ0Bm0F6U3kt0eJ_flzLLjORkfR80ao8vMRmIcb3g3AKREpWNyASc1LucNqIViQAb0k0xPWCEsc0Pt5yv5gO_pw3pGDfYqkqoUo1JViXiXDE6ssTmeJFjMGRSORnP-pyqgEe6N5doVTekBxJUj363FQKHqvc4KAopppPRIbakionDiad3fEA3UxZD18yC2SnMM4jfJekxNu5CWU6ia3bORjXL3zNF3AYDrCFKQSeQ-rbWGP18ecNGyNrHvh5H-fmPJG6VPEcUgAN-_gmA-lRf_n65Redayu8xD2korXSuo0rGBFzpqrHu5r1-9uS9ObePcXraw_Jb_qoY9LWPKc-5du-xQSXXyGq1tKQQjYZAwFy0]--></g></svg>