<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="4803px" preserveAspectRatio="none" style="width:3546px;height:4803px;background:#FFFFFF;" version="1.1" viewBox="0 0 3546 4803" width="3546px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="4797.0181" style="stroke:#181818;stroke-width:0.25;" width="1182" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="64" x="567" y="9.9485">Client Environment</text><rect fill="#F08080" height="4797.0181" style="stroke:#181818;stroke-width:0.25;" width="1393.25" x="1191" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="73.5" x="1850.875" y="9.9485">Attacker Environment</text><rect fill="#ADD8E6" height="4797.0181" style="stroke:#181818;stroke-width:0.25;" width="958" x="2585.25" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="65.5" x="3031.5" y="9.9485">Server Environment</text><rect fill="#FFFFFF" height="4733.0972" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="3037.7674" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="232.5891" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2817.0743"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="3129.0664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="671.75" y="2652.0442"/><rect fill="#FFFFFF" height="232.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="35.887"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="180.564"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="217.917"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2712.0298"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2781.3683"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="933.25" y="144.858"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="236.2701"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="2749.6623"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="283.8291"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2835.4273"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3144.9194"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3176.6254"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3230.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4586.454"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4640.5131"/><rect fill="#FFFFFF" height="2068.714" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="352.0941"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1209" y="543.1242"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="3290.0965"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1616" y="583.8302"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1042.6554"/><rect fill="#FFFFFF" height="1024.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1095.0675"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="599.6832"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="651.2423"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="688.5953"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="848.7723"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="2129.25" y="1110.9205"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1162.4795"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1199.8325"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="615.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="1126.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="507.4182"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="721.9483"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="886.9784"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="918.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="995.0964"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="1218.1855"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="769.5073"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="801.2133"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="1328.3036"/><rect fill="#FFFFFF" height="48.3385" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="2324.1311"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3456.9205"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3510.9796"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3545.6856"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3599.7446"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4217.3939"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4271.4529"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4306.1589"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4360.2179"/><rect fill="#FFFFFF" height="701.5468" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="1396.5686"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1605.3047"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1990.2179"/><rect fill="#FFFFFF" height="410.7662" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="3662.1566"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="3048" y="1646.0107"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="3180.5" y="1661.8637"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3183" y="1713.4228"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3183" y="1750.7758"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="3180.5" y="1916.8793"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3180.5" y="1954.5119"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3281.5" y="1677.7167"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3389.25" y="1569.5987"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3389.25" y="1784.1288"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="1831.6878"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="1863.3938"/><rect fill="#FFFFFF" height="30.6325" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="2030.9239"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3828.9807"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3883.0397"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3937.0988"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3991.1578"/><rect fill="none" height="42.559" style="stroke:#000000;stroke-width:0.75;" width="558" x="235.5" y="86.946"/><rect fill="none" height="55.559" style="stroke:#000000;stroke-width:0.75;" width="213.75" x="1668.5" y="1257.3915"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="3060.6634"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="1188" y="3409.3615"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2582.25" y="3781.4217"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="1188" y="4102.7758"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="4471.836"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="4663.8661"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="42.5" x2="42.5" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="674" x2="674" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="751" x2="751" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="935.5" x2="935.5" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1041.5" x2="1041.5" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1146" x2="1146" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1209" x2="1209" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1618.5" x2="1618.5" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1718" x2="1718" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1882.25" x2="1882.25" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2131.75" x2="2131.75" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2316.25" x2="2316.25" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2427.25" x2="2427.25" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2537.25" x2="2537.25" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2609.75" x2="2609.75" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3050.25" x2="3050.25" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3182.75" x2="3182.75" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3283.75" x2="3283.75" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3391.75" x2="3391.75" y1="30.887" y2="4781.4841"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3498.25" x2="3498.25" y1="30.887" y2="4781.4841"/><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="24.836">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="4791.9671">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="24.836">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="4791.9671">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="69.5" x="639.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="62.5" x="643" y="24.836">Client:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="69.5" x="639.5" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="62.5" x="643" y="4791.9671">Client:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="714" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="717.5" y="24.836">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="714" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="717.5" y="4791.9671">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="892.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="896" y="24.836">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="892.5" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="896" y="4791.9671">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="984" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="987.5" y="24.836">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="984" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="987.5" y="4791.9671">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="1104" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="1107.5" y="24.836">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="1104" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="1107.5" y="4791.9671">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="1193" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="1196.5" y="24.836">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="1193" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="1196.5" y="4791.9671">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1568.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1572" y="24.836">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1568.5" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1572" y="4791.9671">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="1673.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="1677" y="24.836">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="1673.5" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="1677" y="4791.9671">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1825.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1828.75" y="24.836">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1825.25" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1828.75" y="4791.9671">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="2073.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="2077.25" y="24.836">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="2073.75" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="2077.25" y="4791.9671">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2270.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2273.75" y="24.836">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2270.25" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2273.75" y="4791.9671">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2367.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2370.75" y="24.836">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2367.25" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2370.75" y="4791.9671">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2492.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2496.25" y="24.836">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2492.75" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2496.25" y="4791.9671">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2587.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2590.75" y="24.836">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2587.25" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2590.75" y="4791.9671">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="71.5" x="3014.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="64.5" x="3018.25" y="24.836">Server:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="71.5" x="3014.75" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="64.5" x="3018.25" y="4791.9671">Server:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="3144.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="3148.25" y="24.836">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="3144.75" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="3148.25" y="4791.9671">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="3239.75" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="3243.25" y="24.836">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="3239.75" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="3243.25" y="4791.9671">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3333.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3336.75" y="24.836">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3333.25" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3336.75" y="4791.9671">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3455.25" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3458.75" y="24.836">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3455.25" y="4780.9841"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3458.75" y="4791.9671">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="4733.0972" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="3037.7674" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="232.5891" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2817.0743"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="3129.0664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="671.75" y="2652.0442"/><rect fill="#FFFFFF" height="232.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="35.887"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="180.564"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="217.917"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2712.0298"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2781.3683"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="933.25" y="144.858"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="236.2701"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="2749.6623"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="283.8291"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2835.4273"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3144.9194"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3176.6254"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="3230.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4586.454"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4640.5131"/><rect fill="#FFFFFF" height="2068.714" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="352.0941"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1209" y="543.1242"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="3290.0965"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1616" y="583.8302"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1042.6554"/><rect fill="#FFFFFF" height="1024.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="1715.75" y="1095.0675"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="599.6832"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="651.2423"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1882.25" y="688.5953"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1879.75" y="848.7723"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="2129.25" y="1110.9205"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1162.4795"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2131.75" y="1199.8325"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="615.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2313.75" y="1126.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="507.4182"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="721.9483"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="886.9784"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="918.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="995.0964"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2425" y="1218.1855"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="769.5073"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="801.2133"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="1328.3036"/><rect fill="#FFFFFF" height="48.3385" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="2324.1311"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3456.9205"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3510.9796"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3545.6856"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="3599.7446"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4217.3939"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4271.4529"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4306.1589"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2535" y="4360.2179"/><rect fill="#FFFFFF" height="701.5468" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="1396.5686"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1605.3047"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2610" y="1990.2179"/><rect fill="#FFFFFF" height="410.7662" style="stroke:#181818;stroke-width:0.5;" width="5" x="2607.5" y="3662.1566"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="3048" y="1646.0107"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="3180.5" y="1661.8637"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3183" y="1713.4228"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3183" y="1750.7758"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="3180.5" y="1916.8793"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3180.5" y="1954.5119"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3281.5" y="1677.7167"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3389.25" y="1569.5987"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3389.25" y="1784.1288"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="1831.6878"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="1863.3938"/><rect fill="#FFFFFF" height="30.6325" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="2030.9239"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3828.9807"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3883.0397"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3937.0988"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3495.75" y="3991.1578"/><polygon fill="#181818" points="254.75,45.74,259.75,47.74,254.75,49.74,256.75,47.74" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="47.74" y2="47.74"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="48.75" y="44.8355">Create Client("Bob", debugFlag, groupNameDH)</text><polygon fill="#181818" points="50.75,61.593,45.75,63.593,50.75,65.593,48.75,63.593" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="63.593" y2="63.593"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="31" x="53.75" y="60.6885">new Client</text><polygon fill="#181818" points="254.75,77.446,259.75,79.446,254.75,81.446,256.75,79.446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="79.446" y2="79.446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="130" x="48.75" y="76.5415">diffieHellmanKeyExchange(productionPort)</text><path d="M235.5,86.946 L267,86.946 L267,91.799 L262,96.799 L235.5,96.799 L235.5,86.946 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="42.559" style="stroke:#000000;stroke-width:0.75;" width="558" x="235.5" y="86.946"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="94.3945">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="93.5" x="274.5" y="93.8254">[_groupNameDH.empty() == false]</text><polygon fill="#181818" points="742.75,106.652,747.75,108.652,742.75,110.652,744.75,108.652" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="108.652" y2="108.652"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="269.25" y="105.7475">Create DiffieHellman(_debugFlag, _groupNameDH)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="793.5" y1="113.152" y2="113.152"/><polygon fill="#181818" points="742.75,123.505,747.75,125.505,742.75,127.505,744.75,125.505" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="125.505" y2="125.505"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="269.25" y="122.6005">Create DiffieHellman(_debugFlag, _pHex, _hHex)</text><polygon fill="#181818" points="927.25,142.858,932.25,144.858,927.25,146.858,929.25,144.858" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="753.75" x2="930.25" y1="144.858" y2="144.858"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="757.25" y="141.9535">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="759.25,158.711,754.25,160.711,759.25,162.711,757.25,160.711" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="756.25" x2="935.25" y1="160.711" y2="160.711"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="762.25" y="157.8065">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="756.25" x2="777.25" y1="176.564" y2="176.564"/><line style="stroke:#181818;stroke-width:0.5;" x1="777.25" x2="777.25" y1="176.564" y2="183.064"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.75" x2="777.25" y1="183.064" y2="183.064"/><polygon fill="#181818" points="761.75,181.064,756.75,183.064,761.75,185.064,759.75,183.064" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="759.75" y="173.6595">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="753.75" x2="777.25" y1="211.417" y2="211.417"/><line style="stroke:#181818;stroke-width:0.5;" x1="777.25" x2="777.25" y1="211.417" y2="217.917"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.75" x2="777.25" y1="217.917" y2="217.917"/><polygon fill="#181818" points="761.75,215.917,756.75,217.917,761.75,219.917,759.75,217.917" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="759.75" y="208.5125">generatePublicKey()</text><polygon fill="#181818" points="1033,234.2701,1038,236.2701,1033,238.2701,1035,236.2701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.25" x2="1036" y1="236.2701" y2="236.2701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="759.75" y="233.3656">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="759.25,250.1231,754.25,252.1231,759.25,254.1231,757.25,252.1231" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="756.25" x2="1041" y1="252.1231" y2="252.1231"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="762.25" y="249.2186">Public Key A (hex)</text><polygon fill="#181818" points="271.25,265.9761,266.25,267.9761,271.25,269.9761,269.25,267.9761" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="267.9761" y2="267.9761"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="274.25" y="265.0716">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="1137.5,281.8291,1142.5,283.8291,1137.5,285.8291,1139.5,283.8291" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="283.8291" y2="283.8291"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="280.9246">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="271.25,297.6821,266.25,299.6821,271.25,301.6821,269.25,299.6821" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="299.6821" y2="299.6821"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47.5" x="274.25" y="296.7776">clientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="322.6381" y2="322.6381"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="322.6381" y2="329.1381"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="329.1381" y2="329.1381"/><polygon fill="#181818" points="271.25,327.1381,266.25,329.1381,271.25,331.1381,269.25,329.1381" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="269.25" y="319.7336">built "keyExchange" message</text><path d="M140.5,306.1821 L140.5,337.6821 L258,337.6821 L258,311.1821 L253,306.1821 L140.5,306.1821 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,306.1821 L253,311.1821 L258,311.1821 L253,306.1821 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107" x="143.5" y="315.6306">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="76.5" x="143.5" y="324.4836">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47" x="143.5" y="333.3366">p, g, publicKeyA</text><polygon fill="#181818" points="1200.5,350.0941,1205.5,352.0941,1200.5,354.0941,1202.5,352.0941" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1203.5" y1="352.0941" y2="352.0941"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="269.25" y="349.1896">HTTP POST /keyExchange (ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="367.9471" y2="367.9471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="367.9471" y2="374.4471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="374.4471" y2="374.4471"/><polygon fill="#181818" points="1217,372.4471,1212,374.4471,1217,376.4471,1215,374.4471" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1215" y="365.0426">extract client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="390.3001" y2="390.3001"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="390.3001" y2="396.8001"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="396.8001" y2="396.8001"/><polygon fill="#181818" points="1217,394.8001,1212,396.8001,1217,398.8001,1215,396.8001" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="137.5" x="1215" y="387.3956">extract client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="412.6531" y2="412.6531"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="412.6531" y2="419.1531"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="419.1531" y2="419.1531"/><polygon fill="#181818" points="1217,417.1531,1212,419.1531,1217,421.1531,1215,419.1531" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127" x="1215" y="409.7486">extract client's prime p as extractedPrimeP</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="435.0062" y2="435.0062"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="435.0062" y2="441.5062"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="441.5062" y2="441.5062"/><polygon fill="#181818" points="1217,439.5062,1212,441.5062,1217,443.5062,1215,441.5062" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="153" x="1215" y="432.1017">extract client's generator g as extractedGeneratorG</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="460.0357" y2="460.0357"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="460.0357" y2="466.5357"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="466.5357" y2="466.5357"/><polygon fill="#181818" points="1217,464.5357,1212,466.5357,1217,468.5357,1215,466.5357" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145.5" x="1215" y="457.1312">extract client's public key as extractedPublicKeyA</text><path d="M1366.5,448.0062 L1366.5,470.5062 L1596,470.5062 L1596,453.0062 L1591,448.0062 L1366.5,448.0062 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1591,448.0062 L1591,453.0062 L1596,453.0062 L1591,448.0062 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89.5" x="1369.5" y="457.4547">Mallory intercepts ClientHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="219" x="1369.5" y="466.3077">He extracts client's Id, client's Nonce, prime p, generator g and public Key.</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="485.0652" y2="485.0652"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="485.0652" y2="491.5652"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="491.5652" y2="491.5652"/><polygon fill="#181818" points="1217,489.5652,1212,491.5652,1217,493.5652,1215,491.5652" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="397.5" x="1215" y="482.1607">swappedGeneratorG = generateGParameterByAttackStrategy(extractedGeneratorG, extractedPrimeP, _gReplacementAttackStrategy)</text><polygon fill="#181818" points="2419,505.4182,2424,507.4182,2419,509.4182,2421,507.4182" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2422" y1="507.4182" y2="507.4182"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132.5" x="1215" y="504.5137">hexToUniqueBIGNUM(extractedPublicKeyA)</text><polygon fill="#181818" points="1217,521.2712,1212,523.2712,1217,525.2712,1215,523.2712" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2427" y1="523.2712" y2="523.2712"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="1220" y="520.3667">peerPublicKey in UniqueBIGNUM format</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1235" y1="536.6242" y2="536.6242"/><line style="stroke:#181818;stroke-width:0.5;" x1="1235" x2="1235" y1="536.6242" y2="543.1242"/><line style="stroke:#181818;stroke-width:0.5;" x1="1214.5" x2="1235" y1="543.1242" y2="543.1242"/><polygon fill="#181818" points="1219.5,541.1242,1214.5,543.1242,1219.5,545.1242,1217.5,543.1242" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="1217.5" y="533.7197">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1235" y1="563.9772" y2="563.9772"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1235" x2="1235" y1="563.9772" y2="570.4772"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1211.5" x2="1235" y1="570.4772" y2="570.4772"/><polygon fill="#181818" points="1216.5,568.4772,1211.5,570.4772,1216.5,572.4772,1214.5,570.4772" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="1217.5" y="561.0727">sessionId</text><polygon fill="#181818" points="1610,581.8302,1615,583.8302,1610,585.8302,1612,583.8302" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1613" y1="583.8302" y2="583.8302"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="324" x="1215" y="580.9257">Create MallorySessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, p, g)</text><polygon fill="#181818" points="1873.75,597.6832,1878.75,599.6832,1873.75,601.6832,1875.75,599.6832" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1621" x2="1876.75" y1="599.6832" y2="599.6832"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111" x="1624.5" y="596.7787">Create DiffieHellman(debugFlag, p, g)</text><polygon fill="#181818" points="2307.75,613.5362,2312.75,615.5362,2307.75,617.5362,2309.75,615.5362" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2310.75" y1="615.5362" y2="615.5362"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1888.25" y="612.6317">loadDhParameters()</text><polygon fill="#181818" points="1890.25,629.3892,1885.25,631.3892,1890.25,633.3892,1888.25,631.3892" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2315.75" y1="631.3892" y2="631.3892"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1893.25" y="628.4847">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1887.25" x2="1908.25" y1="647.2423" y2="647.2423"/><line style="stroke:#181818;stroke-width:0.5;" x1="1908.25" x2="1908.25" y1="647.2423" y2="653.7423"/><line style="stroke:#181818;stroke-width:0.5;" x1="1887.75" x2="1908.25" y1="653.7423" y2="653.7423"/><polygon fill="#181818" points="1892.75,651.7423,1887.75,653.7423,1892.75,655.7423,1890.75,653.7423" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1890.75" y="644.3378">generatePrivateKey()</text><path d="M1959.5,639.6392 L1959.5,653.1392 L2075,653.1392 L2075,644.6392 L2070,639.6392 L1959.5,639.6392 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2070,639.6392 L2070,644.6392 L2075,644.6392 L2070,639.6392 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="1962.5" y="649.0878">Mallory generates private key 'm_s'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1887.25" x2="1908.25" y1="684.5953" y2="684.5953"/><line style="stroke:#181818;stroke-width:0.5;" x1="1908.25" x2="1908.25" y1="684.5953" y2="691.0953"/><line style="stroke:#181818;stroke-width:0.5;" x1="1887.75" x2="1908.25" y1="691.0953" y2="691.0953"/><polygon fill="#181818" points="1892.75,689.0953,1887.75,691.0953,1892.75,693.0953,1890.75,691.0953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1890.75" y="681.6908">generatePublicKey()</text><path d="M1956.5,676.9923 L1956.5,690.4923 L2106,690.4923 L2106,681.9923 L2101,676.9923 L1956.5,676.9923 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2101,676.9923 L2101,681.9923 L2106,681.9923 L2101,676.9923 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139" x="1959.5" y="686.4408">Mallory computes public key M_S = (g^m_) % p</text><polygon fill="#181818" points="2419,719.9483,2424,721.9483,2419,723.9483,2421,721.9483" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="721.9483" y2="721.9483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1888.25" y="719.0438">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1890.25,735.8013,1885.25,737.8013,1890.25,739.8013,1888.25,737.8013" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="737.8013" y2="737.8013"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="1893.25" y="734.8968">Public Key M_S (hex)</text><polygon fill="#181818" points="1626.5,751.6543,1621.5,753.6543,1626.5,755.6543,1624.5,753.6543" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1623.5" x2="1881.75" y1="753.6543" y2="753.6543"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1629.5" y="750.7498">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="2529,767.5073,2534,769.5073,2529,771.5073,2531,769.5073" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1621" x2="2532" y1="769.5073" y2="769.5073"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="1624.5" y="766.6028">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="1626.5,783.3603,1621.5,785.3603,1626.5,787.3603,1624.5,785.3603" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1623.5" x2="2537" y1="785.3603" y2="785.3603"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109.5" x="1629.5" y="782.4558">result stored in _serverNonceHexAM</text><polygon fill="#181818" points="2529,799.2133,2534,801.2133,2529,803.2133,2531,801.2133" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1621" x2="2532" y1="801.2133" y2="801.2133"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1624.5" y="798.3088">generateRandomIV(ivLength)</text><polygon fill="#181818" points="1626.5,815.0663,1621.5,817.0663,1626.5,819.0663,1624.5,817.0663" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1623.5" x2="2537" y1="817.0663" y2="817.0663"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="1629.5" y="814.1618">result stored in _ivAM</text><polygon fill="#181818" points="1217,830.9193,1212,832.9193,1217,834.9193,1215,832.9193" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1618" y1="832.9193" y2="832.9193"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="228" x="1220" y="830.0148">returns mallorySessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="1873.75,846.7723,1878.75,848.7723,1873.75,850.7723,1875.75,848.7723" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1876.75" y1="848.7723" y2="848.7723"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="440" x="1215" y="845.8678">deriveSharedSecret(extractedPublicKeyA, _diffieHellmanMap[sessionId]-&gt;_serverNonceHexAM, _diffieHellmanMap[sessionId]-&gt;_clientNonceHexAM)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="1905.75" y1="864.6253" y2="864.6253"/><line style="stroke:#181818;stroke-width:0.5;" x1="1905.75" x2="1905.75" y1="864.6253" y2="871.1253"/><line style="stroke:#181818;stroke-width:0.5;" x1="1885.25" x2="1905.75" y1="871.1253" y2="871.1253"/><polygon fill="#181818" points="1890.25,869.1253,1885.25,871.1253,1890.25,873.1253,1888.25,871.1253" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1888.25" y="861.7208">_sharedSecret = (peerPublicKey ^ _privateKey) % _p</text><polygon fill="#181818" points="2419,884.9784,2424,886.9784,2419,888.9784,2421,886.9784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="886.9784" y2="886.9784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1888.25" y="884.0739">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="1890.25,900.8314,1885.25,902.8314,1890.25,904.8314,1888.25,902.8314" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="902.8314" y2="902.8314"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="1893.25" y="899.9269">serverNonceBytes</text><polygon fill="#181818" points="2419,916.6844,2424,918.6844,2419,920.6844,2421,918.6844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="918.6844" y2="918.6844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="86.5" x="1888.25" y="915.7799">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="1890.25,932.5374,1885.25,934.5374,1890.25,936.5374,1888.25,934.5374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="934.5374" y2="934.5374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52" x="1893.25" y="931.6329">clientNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="1905.75" y1="950.3904" y2="950.3904"/><line style="stroke:#181818;stroke-width:0.5;" x1="1905.75" x2="1905.75" y1="950.3904" y2="956.8904"/><line style="stroke:#181818;stroke-width:0.5;" x1="1885.25" x2="1905.75" y1="956.8904" y2="956.8904"/><polygon fill="#181818" points="1890.25,954.8904,1885.25,956.8904,1890.25,958.8904,1888.25,956.8904" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="237.5" x="1888.25" y="947.4859">dataToHash = sharedSecretRawBytes || clientNonceBytes || serverNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="1905.75" y1="972.7434" y2="972.7434"/><line style="stroke:#181818;stroke-width:0.5;" x1="1905.75" x2="1905.75" y1="972.7434" y2="979.2434"/><line style="stroke:#181818;stroke-width:0.5;" x1="1885.25" x2="1905.75" y1="979.2434" y2="979.2434"/><polygon fill="#181818" points="1890.25,977.2434,1885.25,979.2434,1890.25,981.2434,1888.25,979.2434" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138.5" x="1888.25" y="969.8389">_derivedSymmetricKey = SHA256(dataToHash)</text><polygon fill="#181818" points="2419,993.0964,2424,995.0964,2419,997.0964,2421,995.0964" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1884.75" x2="2422" y1="995.0964" y2="995.0964"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109" x="1888.25" y="992.1919">toHexString(_derivedSymmetricKey)</text><polygon fill="#181818" points="1890.25,1008.9494,1885.25,1010.9494,1890.25,1012.9494,1888.25,1010.9494" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1887.25" x2="2427" y1="1010.9494" y2="1010.9494"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127" x="1893.25" y="1008.0449">result stored in _derivedSymmetricKeyHex</text><polygon fill="#181818" points="1217,1024.8024,1212,1026.8024,1217,1028.8024,1215,1026.8024" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1881.75" y1="1026.8024" y2="1026.8024"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115" x="1220" y="1023.8979">result stored in _derivedSymmetricKey</text><polygon fill="#181818" points="1709.75,1040.6554,1714.75,1042.6554,1709.75,1044.6554,1711.75,1042.6554" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1712.75" y1="1042.6554" y2="1042.6554"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="485" x="1215" y="1039.7509">generate fake Client(_diffieHellmanMap[sessionId]-&gt;_clientIdAM, _debugFlag, _diffieHellmanMap[sessionId]-&gt;_diffieHellmanAM-&gt;getPrimeP(), swappedGeneratorG)</text><polygon fill="#181818" points="1217,1066.8614,1212,1068.8614,1217,1070.8614,1215,1068.8614" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1717.75" y1="1068.8614" y2="1068.8614"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142" x="1220" y="1065.9569">new client, to act as a fake one to the real server</text><path d="M966.5,1049.1554 L966.5,1080.6554 L1204,1080.6554 L1204,1054.1554 L1199,1049.1554 L966.5,1049.1554 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,1049.1554 L1199,1054.1554 L1204,1054.1554 L1199,1049.1554 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="969.5" y="1058.6039">Mallory constructs her own ClientHello to Server</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="969.5" y="1067.4569">with Client's Id, malloryNonceToServer,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="227" x="969.5" y="1076.31">prime p, swappedGeneratorG, publicKeyM_S (Mallory's public key for Server)</text><polygon fill="#181818" points="1709.75,1093.0675,1714.75,1095.0675,1709.75,1097.0675,1711.75,1095.0675" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1712.75" y1="1095.0675" y2="1095.0675"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168" x="1215" y="1092.163">diffieHellmanKeyExchange(const int portServerNumber)</text><polygon fill="#181818" points="2123.25,1108.9205,2128.25,1110.9205,2123.25,1112.9205,2125.25,1110.9205" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="2126.25" y1="1110.9205" y2="1110.9205"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="114" x="1724.25" y="1108.016">Create DiffieHellman(_debugFlag, p, g)</text><polygon fill="#181818" points="2307.75,1124.7735,2312.75,1126.7735,2307.75,1128.7735,2309.75,1126.7735" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2134.25" x2="2310.75" y1="1126.7735" y2="1126.7735"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="2137.75" y="1123.869">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="2139.75,1140.6265,2134.75,1142.6265,2139.75,1144.6265,2137.75,1142.6265" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2136.75" x2="2315.75" y1="1142.6265" y2="1142.6265"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="2142.75" y="1139.722">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="2136.75" x2="2157.75" y1="1158.4795" y2="1158.4795"/><line style="stroke:#181818;stroke-width:0.5;" x1="2157.75" x2="2157.75" y1="1158.4795" y2="1164.9795"/><line style="stroke:#181818;stroke-width:0.5;" x1="2137.25" x2="2157.75" y1="1164.9795" y2="1164.9795"/><polygon fill="#181818" points="2142.25,1162.9795,2137.25,1164.9795,2142.25,1166.9795,2140.25,1164.9795" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="2140.25" y="1155.575">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="2134.25" x2="2157.75" y1="1193.3325" y2="1193.3325"/><line style="stroke:#181818;stroke-width:0.5;" x1="2157.75" x2="2157.75" y1="1193.3325" y2="1199.8325"/><line style="stroke:#181818;stroke-width:0.5;" x1="2137.25" x2="2157.75" y1="1199.8325" y2="1199.8325"/><polygon fill="#181818" points="2142.25,1197.8325,2137.25,1199.8325,2142.25,1201.8325,2140.25,1199.8325" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2140.25" y="1190.428">generatePublicKey()</text><polygon fill="#181818" points="2419,1216.1855,2424,1218.1855,2419,1220.1855,2421,1218.1855" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2136.75" x2="2422" y1="1218.1855" y2="1218.1855"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="2140.25" y="1215.281">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2139.75,1232.0385,2134.75,1234.0385,2139.75,1236.0385,2137.75,1234.0385" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2136.75" x2="2427" y1="1234.0385" y2="1234.0385"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="2142.75" y="1231.134">Public Key M_S (hex)</text><polygon fill="#181818" points="1726.25,1247.8915,1721.25,1249.8915,1726.25,1251.8915,1724.25,1249.8915" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1723.25" x2="2131.25" y1="1249.8915" y2="1249.8915"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="1729.25" y="1246.987">Client:DiffieHellman instance ready</text><path d="M1668.5,1257.3915 L1700,1257.3915 L1700,1262.2445 L1695,1267.2445 L1668.5,1267.2445 L1668.5,1257.3915 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="55.559" style="stroke:#000000;stroke-width:0.75;" width="213.75" x="1668.5" y="1257.3915"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1676" y="1264.84">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="93.5" x="1707.5" y="1264.271">[_groupNameDH.empty() == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="1741.75" y1="1279.0975" y2="1279.0975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1741.75" x2="1741.75" y1="1279.0975" y2="1285.5975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1721.25" x2="1741.75" y1="1285.5975" y2="1285.5975"/><polygon fill="#181818" points="1726.25,1283.5975,1721.25,1285.5975,1726.25,1287.5975,1724.25,1285.5975" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1724.25" y="1276.193">Create DiffieHellman(_debugFlag, _groupNameDH)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1668.5" x2="1882.25" y1="1290.0975" y2="1290.0975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="1741.75" y1="1302.4506" y2="1302.4506"/><line style="stroke:#181818;stroke-width:0.5;" x1="1741.75" x2="1741.75" y1="1302.4506" y2="1308.9506"/><line style="stroke:#181818;stroke-width:0.5;" x1="1721.25" x2="1741.75" y1="1308.9506" y2="1308.9506"/><polygon fill="#181818" points="1726.25,1306.9506,1721.25,1308.9506,1726.25,1310.9506,1724.25,1308.9506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="1724.25" y="1299.5461">Create DiffieHellman(_debugFlag, _pHex, _hHex)</text><polygon fill="#181818" points="2529,1326.3036,2534,1328.3036,2529,1330.3036,2531,1328.3036" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="2532" y1="1328.3036" y2="1328.3036"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="1724.25" y="1325.3991">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="1726.25,1342.1566,1721.25,1344.1566,1726.25,1346.1566,1724.25,1344.1566" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1723.25" x2="2537" y1="1344.1566" y2="1344.1566"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="1729.25" y="1341.2521">fakeClientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="1741.75" y1="1367.1126" y2="1367.1126"/><line style="stroke:#181818;stroke-width:0.5;" x1="1741.75" x2="1741.75" y1="1367.1126" y2="1373.6126"/><line style="stroke:#181818;stroke-width:0.5;" x1="1721.25" x2="1741.75" y1="1373.6126" y2="1373.6126"/><polygon fill="#181818" points="1726.25,1371.6126,1721.25,1373.6126,1726.25,1375.6126,1724.25,1373.6126" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="1724.25" y="1364.2081">built "keyExchange" message</text><path d="M1581,1350.6566 L1581,1382.1566 L1713,1382.1566 L1713,1355.6566 L1708,1350.6566 L1581,1350.6566 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1708,1350.6566 L1708,1355.6566 L1713,1355.6566 L1708,1350.6566 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="1584" y="1360.1051">Fake client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102.5" x="1584" y="1368.9581">with real clientId, fakeClientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="55.5" x="1584" y="1377.8111">p, g, publicKeyM_S</text><polygon fill="#181818" points="2601.5,1394.5686,2606.5,1396.5686,2601.5,1398.5686,2603.5,1396.5686" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1720.75" x2="2604.5" y1="1396.5686" y2="1396.5686"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="160.5" x="1724.25" y="1393.6641">HTTP POST /keyExchange (Mallory's ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1412.4216" y2="1412.4216"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1412.4216" y2="1418.9216"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1418.9216" y2="1418.9216"/><polygon fill="#181818" points="2618,1416.9216,2613,1418.9216,2618,1420.9216,2616,1418.9216" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2616" y="1409.5171">Parse ClientHello JSON (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1434.7746" y2="1434.7746"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1434.7746" y2="1441.2746"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1441.2746" y2="1441.2746"/><polygon fill="#181818" points="2618,1439.2746,2613,1441.2746,2618,1443.2746,2616,1441.2746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="148.5" x="2616" y="1431.8701">extract fake client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1457.1276" y2="1457.1276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1457.1276" y2="1463.6276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1463.6276" y2="1463.6276"/><polygon fill="#181818" points="2618,1461.6276,2613,1463.6276,2618,1465.6276,2616,1463.6276" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2616" y="1454.2231">extract fake client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1479.4806" y2="1479.4806"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1479.4806" y2="1485.9806"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1485.9806" y2="1485.9806"/><polygon fill="#181818" points="2618,1483.9806,2613,1485.9806,2618,1487.9806,2616,1485.9806" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141" x="2616" y="1476.5761">extract fake client's prime p as extractedPrimeP</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1501.8336" y2="1501.8336"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1501.8336" y2="1508.3336"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1508.3336" y2="1508.3336"/><polygon fill="#181818" points="2618,1506.3336,2613,1508.3336,2618,1510.3336,2616,1508.3336" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="167" x="2616" y="1498.9291">extract fake client's generator g as extractedGeneratorG</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="1535.7162" y2="1535.7162"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="1535.7162" y2="1542.2162"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="1542.2162" y2="1542.2162"/><polygon fill="#181818" points="2618,1540.2162,2613,1542.2162,2618,1544.2162,2616,1542.2162" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="159.5" x="2616" y="1532.8117">extract fake client's public key as extractedPublicKeyA</text><path d="M2781.5,1514.8336 L2781.5,1554.8336 L2957,1554.8336 L2957,1519.8336 L2952,1514.8336 L2781.5,1514.8336 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2952,1514.8336 L2952,1519.8336 L2957,1519.8336 L2952,1514.8336 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="106" x="2784.5" y="1524.2822">Server extracts clients id, (Alice's Id),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141.5" x="2784.5" y="1533.1352">malloryNonceToServer (thinks it's client nonce),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="165" x="2784.5" y="1541.9882">publicKeyM_S (thinks it's client publicKeyA), the prime p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="88.5" x="2784.5" y="1550.8412">and the swapped generator g</text><polygon fill="#181818" points="3383.25,1567.5987,3388.25,1569.5987,3383.25,1571.5987,3385.25,1569.5987" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3386.25" y1="1569.5987" y2="1569.5987"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2616" y="1566.6942">BIGNUMToHex(extractedPublicKeyA)</text><polygon fill="#181818" points="2618,1583.4517,2613,1585.4517,2618,1587.4517,2616,1585.4517" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3391.25" y1="1585.4517" y2="1585.4517"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="59" x="2621" y="1582.5472">peerPublicKey (hex)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2636" y1="1598.8047" y2="1598.8047"/><line style="stroke:#181818;stroke-width:0.5;" x1="2636" x2="2636" y1="1598.8047" y2="1605.3047"/><line style="stroke:#181818;stroke-width:0.5;" x1="2615.5" x2="2636" y1="1605.3047" y2="1605.3047"/><polygon fill="#181818" points="2620.5,1603.3047,2615.5,1605.3047,2620.5,1607.3047,2618.5,1605.3047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="2618.5" y="1595.9002">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="2636" y1="1626.1577" y2="1626.1577"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2636" x2="2636" y1="1626.1577" y2="1632.6577"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2612.5" x2="2636" y1="1632.6577" y2="1632.6577"/><polygon fill="#181818" points="2617.5,1630.6577,2612.5,1632.6577,2617.5,1634.6577,2615.5,1632.6577" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="2618.5" y="1623.2532">sessionId</text><polygon fill="#181818" points="3042,1644.0107,3047,1646.0107,3042,1648.0107,3044,1646.0107" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3045" y1="1646.0107" y2="1646.0107"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="426" x="2616" y="1643.1062">Create ServerSessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, extractedPrimeP, extractedGeneratorG)</text><polygon fill="#181818" points="3174.5,1659.8637,3179.5,1661.8637,3174.5,1663.8637,3176.5,1661.8637" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3053" x2="3177.5" y1="1661.8637" y2="1661.8637"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111" x="3056.5" y="1658.9592">Create DiffieHellman(debugFlag, p, g)</text><polygon fill="#181818" points="3275.5,1675.7167,3280.5,1677.7167,3275.5,1679.7167,3277.5,1677.7167" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3185.5" x2="3278.5" y1="1677.7167" y2="1677.7167"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="3189" y="1674.8122">loadDhParameters()</text><polygon fill="#181818" points="3191,1691.5697,3186,1693.5697,3191,1695.5697,3189,1693.5697" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3188" x2="3283.5" y1="1693.5697" y2="1693.5697"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="3194" y="1690.6652">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="3188" x2="3209" y1="1709.4228" y2="1709.4228"/><line style="stroke:#181818;stroke-width:0.5;" x1="3209" x2="3209" y1="1709.4228" y2="1715.9228"/><line style="stroke:#181818;stroke-width:0.5;" x1="3188.5" x2="3209" y1="1715.9228" y2="1715.9228"/><polygon fill="#181818" points="3193.5,1713.9228,3188.5,1715.9228,3193.5,1717.9228,3191.5,1715.9228" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="3191.5" y="1706.5183">generatePrivateKey()</text><path d="M3260.5,1701.8197 L3260.5,1715.3197 L3373,1715.3197 L3373,1706.8197 L3368,1701.8197 L3260.5,1701.8197 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3368,1701.8197 L3368,1706.8197 L3373,1706.8197 L3368,1701.8197 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102" x="3263.5" y="1711.2683">Server generates private key 'm_a'</text><line style="stroke:#181818;stroke-width:0.5;" x1="3188" x2="3209" y1="1746.7758" y2="1746.7758"/><line style="stroke:#181818;stroke-width:0.5;" x1="3209" x2="3209" y1="1746.7758" y2="1753.2758"/><line style="stroke:#181818;stroke-width:0.5;" x1="3188.5" x2="3209" y1="1753.2758" y2="1753.2758"/><polygon fill="#181818" points="3193.5,1751.2758,3188.5,1753.2758,3193.5,1755.2758,3191.5,1753.2758" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="3191.5" y="1743.8713">generatePublicKey()</text><path d="M3257.5,1739.1728 L3257.5,1752.6728 L3407.5,1752.6728 L3407.5,1744.1728 L3402.5,1739.1728 L3257.5,1739.1728 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3402.5,1739.1728 L3402.5,1744.1728 L3407.5,1744.1728 L3402.5,1739.1728 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="3260.5" y="1748.6213">Server computes public key M_A = (g^m_a) % p</text><polygon fill="#181818" points="3383.25,1782.1288,3388.25,1784.1288,3383.25,1786.1288,3385.25,1784.1288" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3185.5" x2="3386.25" y1="1784.1288" y2="1784.1288"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="3189" y="1781.2243">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="3191,1797.9818,3186,1799.9818,3191,1801.9818,3189,1799.9818" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3188" x2="3391.25" y1="1799.9818" y2="1799.9818"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="3194" y="1797.0773">Public Key M_A (hex)</text><polygon fill="#181818" points="3058.5,1813.8348,3053.5,1815.8348,3058.5,1817.8348,3056.5,1815.8348" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3055.5" x2="3182.5" y1="1815.8348" y2="1815.8348"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="3061.5" y="1812.9303">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="3489.75,1829.6878,3494.75,1831.6878,3489.75,1833.6878,3491.75,1831.6878" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3053" x2="3492.75" y1="1831.6878" y2="1831.6878"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="3056.5" y="1828.7833">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="3058.5,1845.5408,3053.5,1847.5408,3058.5,1849.5408,3056.5,1847.5408" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3055.5" x2="3497.75" y1="1847.5408" y2="1847.5408"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="99.5" x="3061.5" y="1844.6363">result stored in _serverNonceHex</text><polygon fill="#181818" points="3489.75,1861.3938,3494.75,1863.3938,3489.75,1865.3938,3491.75,1863.3938" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3053" x2="3492.75" y1="1863.3938" y2="1863.3938"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="3056.5" y="1860.4893">generateRandomIV(ivLength)</text><polygon fill="#181818" points="3058.5,1877.2468,3053.5,1879.2468,3058.5,1881.2468,3056.5,1879.2468" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3055.5" x2="3497.75" y1="1879.2468" y2="1879.2468"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="3061.5" y="1876.3423">result stored in _iv</text><polygon fill="#181818" points="2618,1893.0998,2613,1895.0998,2618,1897.0998,2616,1895.0998" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3050" y1="1895.0998" y2="1895.0998"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="205.5" x="2621" y="1892.1953">returns SessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="3174.5,1914.8793,3179.5,1916.8793,3174.5,1918.8793,3176.5,1916.8793" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3177.5" y1="1916.8793" y2="1916.8793"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="233" x="2616" y="1913.9748">deriveSharedSecret(extractedPublicKeyA, _serverNonceHex, _clientNonceHex)</text><path d="M3188,1901.5998 L3188,1924.0998 L3412,1924.0998 L3412,1906.5998 L3407,1901.5998 L3188,1901.5998 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3407,1901.5998 L3407,1906.5998 L3412,1906.5998 L3407,1901.5998 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="213.5" x="3191" y="1911.0483">Server computes shared secret M_S = (publicKeyM_A ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="157.5" x="3191" y="1919.9013">This is the shared secret between Mallory and Server.</text><polygon fill="#181818" points="2618,1936.6589,2613,1938.6589,2618,1940.6589,2616,1938.6589" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3182.5" y1="1938.6589" y2="1938.6589"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80.5" x="2621" y="1935.7543">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="3174.5,1952.5119,3179.5,1954.5119,3174.5,1956.5119,3176.5,1954.5119" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3177.5" y1="1954.5119" y2="1954.5119"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80" x="2616" y="1951.6074">getConfirmationMessage()</text><polygon fill="#181818" points="2618,1968.3649,2613,1970.3649,2618,1972.3649,2616,1970.3649" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3182.5" y1="1970.3649" y2="1970.3649"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="150.5" x="2621" y="1967.4604">returns server's confirmation message as message</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2636" y1="1983.7179" y2="1983.7179"/><line style="stroke:#181818;stroke-width:0.5;" x1="2636" x2="2636" y1="1983.7179" y2="1990.2179"/><line style="stroke:#181818;stroke-width:0.5;" x1="2615.5" x2="2636" y1="1990.2179" y2="1990.2179"/><polygon fill="#181818" points="2620.5,1988.2179,2615.5,1990.2179,2620.5,1992.2179,2618.5,1990.2179" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80.5" x="2618.5" y="1980.8134">build confirmation payload</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="2636" y1="2011.0709" y2="2011.0709"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2636" x2="2636" y1="2011.0709" y2="2017.5709"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2612.5" x2="2636" y1="2017.5709" y2="2017.5709"/><polygon fill="#181818" points="2617.5,2015.5709,2612.5,2017.5709,2617.5,2019.5709,2615.5,2017.5709" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="277" x="2618.5" y="2008.1664">confirmation payload build with fields: message, sessionId, clientId, clientNonce, serverNonce</text><polygon fill="#181818" points="3489.75,2028.9239,3494.75,2030.9239,3489.75,2032.9239,3491.75,2030.9239" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3492.75" y1="2030.9239" y2="2030.9239"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="237" x="2616" y="2028.0194">encryptMessageAes256CbcMode(confirmationMsg, _derivedSymmetricKey, _iv)</text><polygon fill="#181818" points="2618,2059.5564,2613,2061.5564,2618,2063.5564,2616,2061.5564" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3497.75" y1="2061.5564" y2="2061.5564"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2621" y="2058.6519">ciphertext</text><path d="M2436.5,2037.4239 L2436.5,2077.4239 L2605,2077.4239 L2605,2042.4239 L2600,2037.4239 L2436.5,2037.4239 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2600,2037.4239 L2600,2042.4239 L2605,2042.4239 L2600,2037.4239 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138" x="2439.5" y="2046.8724">Server constructs JSON response (ServerHello)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121" x="2439.5" y="2055.7254">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2439.5" y="2064.5784">encrypted confirmation (ciphertext_MS, ivHex_MS)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="158" x="2439.5" y="2073.4314">Server believes it's sending to Alice instead of Mallory</text><polygon fill="#181818" points="1726.25,2096.1154,1721.25,2098.1154,1726.25,2100.1154,1724.25,2098.1154" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1723.25" x2="2609.5" y1="2098.1154" y2="2098.1154"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95.5" x="1729.25" y="2095.2109">HTTP 201 OK (ServerHello JSON)</text><path d="M2615,2082.8359 L2615,2105.3359 L2846,2105.3359 L2846,2087.8359 L2841,2082.8359 L2615,2082.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2841,2082.8359 L2841,2087.8359 L2846,2087.8359 L2841,2082.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="2618" y="2092.2844">Mallory's fake client intercepts ServerHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="220.5" x="2618" y="2101.1374">He extracts sessionId, serverNonce, publicKeyB, ciphertext_MS, ivHex_MS.</text><polygon fill="#181818" points="1217,2117.895,1212,2119.895,1217,2121.895,1215,2119.895" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1717.75" y1="2119.895" y2="2119.895"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107.5" x="1220" y="2116.9904">returns server's response decrypted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2135.748" y2="2135.748"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2135.748" y2="2142.248"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2142.248" y2="2142.248"/><polygon fill="#181818" points="1217,2140.248,1212,2142.248,1217,2144.248,1215,2142.248" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122" x="1215" y="2132.8435">Parse ServerHello JSON (from real server)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2158.101" y2="2158.101"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2158.101" y2="2164.601"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2164.601" y2="2164.601"/><polygon fill="#181818" points="1217,2162.601,1212,2164.601,1217,2166.601,1215,2164.601" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145" x="1215" y="2155.1965">extracts server's session id as sessionIdExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2180.454" y2="2180.454"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2180.454" y2="2186.954"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2186.954" y2="2186.954"/><polygon fill="#181818" points="1217,2184.954,1212,2186.954,1217,2188.954,1215,2186.954" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="113" x="1215" y="2177.5495">extracts client's id as clientIdExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2202.807" y2="2202.807"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2202.807" y2="2209.307"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2209.307" y2="2209.307"/><polygon fill="#181818" points="1217,2207.307,1212,2209.307,1217,2211.307,1215,2209.307" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="140.5" x="1215" y="2199.9025">extracts client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2225.16" y2="2225.16"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2225.16" y2="2231.66"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2231.66" y2="2231.66"/><polygon fill="#181818" points="1217,2229.66,1212,2231.66,1217,2233.66,1215,2231.66" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144.5" x="1215" y="2222.2555">extracts server's nonce as serverNonceExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2247.513" y2="2247.513"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2247.513" y2="2254.013"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2254.013" y2="2254.013"/><polygon fill="#181818" points="1217,2252.013,1212,2254.013,1217,2256.013,1215,2254.013" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141" x="1215" y="2244.6085">extracts server's message as messageExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2285.822" y2="2285.822"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2285.822" y2="2292.322"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2292.322" y2="2292.322"/><polygon fill="#181818" points="1217,2290.322,1212,2292.322,1217,2294.322,1215,2292.322" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="325.5" x="1215" y="2282.9175">confirmationString is built with the fields: sessionId, clientId, clientNonce, serverNonce and messageExtracted</text><path d="M1546.5,2260.513 L1546.5,2309.513 L1773.5,2309.513 L1773.5,2265.513 L1768.5,2260.513 L1546.5,2260.513 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1768.5,2260.513 L1768.5,2265.513 L1773.5,2265.513 L1768.5,2260.513 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="1549.5" y="2269.9615">Mallory in this example just scoops the data exchanged between the real</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="210.5" x="1549.5" y="2278.8145">server and the client, it does not tamper the message, just changes the</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="1549.5" y="2287.6675">nonce's and iv's to ensure total control over each leg of the channel.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="204" x="1549.5" y="2296.5205">Prime p and generator G are left unchanged on this leg of the attack,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="167.5" x="1549.5" y="2305.3735">so that the client doesn't notice the MitM attack activity.</text><polygon fill="#181818" points="2529,2322.1311,2534,2324.1311,2529,2326.1311,2531,2324.1311" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="2324.1311" y2="2324.1311"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="265" x="1215" y="2321.2265">encryptMessageAes256CbcMode(confirmationString, _derivedSymmetricKey_AM, _ivAM)</text><polygon fill="#181818" points="1217,2370.4696,1212,2372.4696,1217,2374.4696,1215,2372.4696" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="2372.4696" y2="2372.4696"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="1220" y="2369.5651">ciphertext_AM</text><path d="M982,2330.6311 L982,2406.1311 L1204,2406.1311 L1204,2335.6311 L1199,2330.6311 L982,2330.6311 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,2330.6311 L1199,2335.6311 L1204,2335.6311 L1199,2330.6311 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="985" y="2340.0796">Mallory constructs her own ServerHello to Client</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199.5" x="985" y="2348.9326">with original sessionId, serverNonce_AM (Mallory's), publicKeyM_A,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="211.5" x="985" y="2357.7856">encrypted confirmation (ciphertext_AM) and initialization vector _ivAM.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="985" y="2366.6386">Mallory sends her own public key (M_A) to the client,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="985" y="2375.4916">making Alice believe M_A is Bob's public key.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="985" y="2384.3446">Mallory uses his own nonce he generated for this leg of the attack.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="204" x="985" y="2393.1976">Prime p and generator G are left unchanged on this leg of the attack,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="167.5" x="985" y="2402.0506">so that the client doesn't notice the MitM attack activity.</text><polygon fill="#181818" points="271.25,2418.8081,266.25,2420.8081,271.25,2422.8081,269.25,2420.8081" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1208.5" y1="2420.8081" y2="2420.8081"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="274.25" y="2417.9036">HTTP 201 OK (Mallory's ServerHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2443.7641" y2="2443.7641"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2443.7641" y2="2450.2641"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2450.2641" y2="2450.2641"/><polygon fill="#181818" points="271.25,2448.2641,266.25,2450.2641,271.25,2452.2641,269.25,2450.2641" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142.5" x="269.25" y="2440.8596">Parse ServerHello JSON response (from Mallory)</text><path d="M417.5,2427.3081 L417.5,2458.8081 L619,2458.8081 L619,2432.3081 L614,2427.3081 L417.5,2427.3081 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M614,2427.3081 L614,2432.3081 L619,2432.3081 L614,2427.3081 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="420.5" y="2436.7566">Client extracts sessionId, serverNonce (Mallory's),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="191" x="420.5" y="2445.6096">prime p, generator g, publicKeyB (Mallory's M_A), ciphertext_AM</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="420.5" y="2454.4626">and the ivHex_AM</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2473.2202" y2="2473.2202"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2473.2202" y2="2479.7202"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2479.7202" y2="2479.7202"/><polygon fill="#181818" points="271.25,2477.7202,266.25,2479.7202,271.25,2481.7202,269.25,2479.7202" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="2470.3157">Parse ServerHello JSON (from fake server)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2495.5732" y2="2495.5732"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2495.5732" y2="2502.0732"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2502.0732" y2="2502.0732"/><polygon fill="#181818" points="271.25,2500.0732,266.25,2502.0732,271.25,2504.0732,269.25,2502.0732" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="269.25" y="2492.6687">extracts server's session id as sessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2517.9262" y2="2517.9262"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2517.9262" y2="2524.4262"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2524.4262" y2="2524.4262"/><polygon fill="#181818" points="271.25,2522.4262,266.25,2524.4262,271.25,2526.4262,269.25,2524.4262" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145" x="269.25" y="2515.0217">extracts server's nonce as extractedNonceServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2540.2792" y2="2540.2792"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2540.2792" y2="2546.7792"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2546.7792" y2="2546.7792"/><polygon fill="#181818" points="271.25,2544.7792,266.25,2546.7792,271.25,2548.7792,269.25,2546.7792" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="108" x="269.25" y="2537.3747">extracts prime p as extractedPrimeP</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2562.6322" y2="2562.6322"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2562.6322" y2="2569.1322"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2569.1322" y2="2569.1322"/><polygon fill="#181818" points="271.25,2567.1322,266.25,2569.1322,271.25,2571.1322,269.25,2569.1322" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134" x="269.25" y="2559.7277">extracts generator g as extractedGeneratorG</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2584.9852" y2="2584.9852"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2584.9852" y2="2591.4852"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2591.4852" y2="2591.4852"/><polygon fill="#181818" points="271.25,2589.4852,266.25,2591.4852,271.25,2593.4852,269.25,2591.4852" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="165" x="269.25" y="2582.0807">extracts fake server's public key as extractedPublicKeyB</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2607.3382" y2="2607.3382"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2607.3382" y2="2613.8382"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2613.8382" y2="2613.8382"/><polygon fill="#181818" points="271.25,2611.8382,266.25,2613.8382,271.25,2615.8382,269.25,2613.8382" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="269.25" y="2604.4337">extracts fake server's ciphertext as ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2629.6912" y2="2629.6912"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2629.6912" y2="2636.1912"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2636.1912" y2="2636.1912"/><polygon fill="#181818" points="271.25,2634.1912,266.25,2636.1912,271.25,2638.1912,269.25,2636.1912" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83.5" x="269.25" y="2626.7867">extracts fake server's iv as iv</text><polygon fill="#181818" points="665.75,2650.0442,670.75,2652.0442,665.75,2654.0442,667.75,2652.0442" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="668.75" y1="2652.0442" y2="2652.0442"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="284" x="269.25" y="2649.1397">Create SessionData(diffieHellman, extractedNonceServer, clientNonceHex, extractedClientId, iv)</text><polygon fill="#181818" points="271.25,2665.8972,266.25,2667.8972,271.25,2669.8972,269.25,2667.8972" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="673.75" y1="2667.8972" y2="2667.8972"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="205.5" x="274.25" y="2664.9927">returns SessionData, stored in the map _diffieHellmanMap[sessionId]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2683.7502" y2="2683.7502"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2683.7502" y2="2690.2502"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2690.2502" y2="2690.2502"/><polygon fill="#181818" points="271.25,2688.2502,266.25,2690.2502,271.25,2692.2502,269.25,2690.2502" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118.5" x="269.25" y="2680.8457">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="742.75,2710.0298,747.75,2712.0298,742.75,2714.0298,744.75,2712.0298" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="2712.0298" y2="2712.0298"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="227" x="269.25" y="2709.1253">deriveSharedSecret(extractedPublicKeyB, serverNonceHex, clientNonceHex)</text><path d="M756,2696.7502 L756,2719.2502 L968.5,2719.2502 L968.5,2701.7502 L963.5,2696.7502 L756,2696.7502 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963.5,2696.7502 L963.5,2701.7502 L968.5,2701.7502 L963.5,2696.7502 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="759" y="2706.1987">Client computes shared secret s = (publicKeyM_B ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="174.5" x="759" y="2715.0518">This is the shared secret between Client (Alice) and Mallory.</text><polygon fill="#181818" points="271.25,2731.8093,266.25,2733.8093,271.25,2735.8093,269.25,2733.8093" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="2733.8093" y2="2733.8093"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="158" x="274.25" y="2730.9048">_derivedSymmetricKeyHex (Alice-Mallory shared key)</text><polygon fill="#181818" points="1033,2747.6623,1038,2749.6623,1033,2751.6623,1035,2749.6623" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1036" y1="2749.6623" y2="2749.6623"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="269.25" y="2746.7578">hexToBytes(_diffieHellmanMap[sessionId]-&gt;_derivedKeyHex)</text><polygon fill="#181818" points="271.25,2763.5153,266.25,2765.5153,271.25,2767.5153,269.25,2765.5153" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1041" y1="2765.5153" y2="2765.5153"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="57" x="274.25" y="2762.6108">returns derivedKey</text><polygon fill="#181818" points="742.75,2779.3683,747.75,2781.3683,742.75,2783.3683,744.75,2781.3683" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="2781.3683" y2="2781.3683"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80" x="269.25" y="2778.4638">getConfirmationMessage()</text><polygon fill="#181818" points="271.25,2795.2213,266.25,2797.2213,271.25,2799.2213,269.25,2797.2213" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="2797.2213" y2="2797.2213"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="186.5" x="274.25" y="2794.3168">returns client's confirmation message as confirmationMessage</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="289.25" y1="2810.5743" y2="2810.5743"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2810.5743" y2="2817.0743"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2817.0743" y2="2817.0743"/><polygon fill="#181818" points="273.75,2815.0743,268.75,2817.0743,273.75,2819.0743,271.75,2817.0743" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="399" x="271.75" y="2807.6698">confirmationServerResponse(ciphertext, derivedKey, iv, sessionId, clientId, _clientNonceHex, _serverNonceHex, confirmationMessage)</text><polygon fill="#181818" points="1137.5,2833.4273,1142.5,2835.4273,1137.5,2837.4273,1139.5,2835.4273" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="1140.5" y1="2835.4273" y2="2835.4273"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="178" x="271.75" y="2832.5228">decryptMessageAes256CbcMode(ciphertext, derivedKey, iv)</text><polygon fill="#181818" points="273.75,2849.2803,268.75,2851.2803,273.75,2853.2803,271.75,2851.2803" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="1145.5" y1="2851.2803" y2="2851.2803"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="101" x="276.75" y="2848.3758">decryptedPlaintext (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2878.6628" y2="2878.6628"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2878.6628" y2="2885.1628"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2885.1628" y2="2885.1628"/><polygon fill="#181818" points="273.75,2883.1628,268.75,2885.1628,273.75,2887.1628,271.75,2885.1628" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96" x="271.75" y="2875.7583">Parse decryptedPlaintext (JSON)</text><path d="M373.5,2857.7803 L373.5,2897.7803 L561.5,2897.7803 L561.5,2862.7803 L556.5,2857.7803 L373.5,2857.7803 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M556.5,2857.7803 L556.5,2862.7803 L561.5,2862.7803 L556.5,2857.7803 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96.5" x="376.5" y="2867.2288">Client compares extracted fields.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="177.5" x="376.5" y="2876.0818">Since Mallory forwarded a valid confirmation, this validation</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152.5" x="376.5" y="2884.9348">will likely pass, making Alice believe she successfully</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="74.5" x="376.5" y="2893.7879">communicated with Bob.</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2912.5454" y2="2912.5454"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2912.5454" y2="2919.0454"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2919.0454" y2="2919.0454"/><polygon fill="#181818" points="273.75,2917.0454,268.75,2919.0454,273.75,2921.0454,271.75,2919.0454" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131" x="271.75" y="2909.6409">extracts session's id from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2934.8984" y2="2934.8984"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2934.8984" y2="2941.3984"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2941.3984" y2="2941.3984"/><polygon fill="#181818" points="273.75,2939.3984,268.75,2941.3984,273.75,2943.3984,271.75,2941.3984" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125" x="271.75" y="2931.9939">extracts client's id from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2957.2514" y2="2957.2514"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2957.2514" y2="2963.7514"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2963.7514" y2="2963.7514"/><polygon fill="#181818" points="273.75,2961.7514,268.75,2963.7514,273.75,2965.7514,271.75,2963.7514" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="133" x="271.75" y="2954.3469">extracts clientNonce from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2979.6044" y2="2979.6044"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2979.6044" y2="2986.1044"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2986.1044" y2="2986.1044"/><polygon fill="#181818" points="273.75,2984.1044,268.75,2986.1044,273.75,2988.1044,271.75,2986.1044" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="135.5" x="271.75" y="2976.6999">extracts serverNonce from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="3001.9574" y2="3001.9574"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="3001.9574" y2="3008.4574"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="3008.4574" y2="3008.4574"/><polygon fill="#181818" points="273.75,3006.4574,268.75,3008.4574,273.75,3010.4574,271.75,3008.4574" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="271.75" y="2999.0529">extracts message from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="3024.3104" y2="3024.3104"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="3024.3104" y2="3030.8104"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="3030.8104" y2="3030.8104"/><polygon fill="#181818" points="273.75,3028.8104,268.75,3030.8104,273.75,3032.8104,271.75,3030.8104" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="288.5" x="271.75" y="3021.4059">compares the extracted fields with the ones in its memory, updating validationResult accordingly</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="289.25" y1="3049.1634" y2="3049.1634"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="289.25" x2="289.25" y1="3049.1634" y2="3055.6634"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="265.75" x2="289.25" y1="3055.6634" y2="3055.6634"/><polygon fill="#181818" points="270.75,3053.6634,265.75,3055.6634,270.75,3057.6634,268.75,3055.6634" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="271.75" y="3046.2589">(bool validationResult, string decryptedMessage)</text><path d="M5,3060.6634 L36.5,3060.6634 L36.5,3065.5164 L31.5,3070.5164 L5,3070.5164 L5,3060.6634 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="3060.6634"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="12.5" y="3068.1119">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="69.5" x="44" y="3067.5429">[validationResult == true]</text><polygon fill="#181818" points="50.75,3081.8694,45.75,3083.8694,50.75,3085.8694,48.75,3083.8694" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="3083.8694" y2="3083.8694"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="203.5" x="53.75" y="3080.9649">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><path d="M268,3073.0164 L268,3086.5164 L434.5,3086.5164 L434.5,3078.0164 L429.5,3073.0164 L268,3073.0164 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M429.5,3073.0164 L429.5,3078.0164 L434.5,3078.0164 L429.5,3073.0164 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="271" y="3082.4649">Client is unaware it succeeded with Mallory, not Bob.</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="5" x2="439.75" y1="3089.8694" y2="3089.8694"/><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="70.5" x="7.5" y="3095.7489">[validationResult == false]</text><polygon fill="#181818" points="50.75,3107.7134,45.75,3109.7134,50.75,3111.7134,48.75,3109.7134" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="3109.7134" y2="3109.7134"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="53.75" y="3106.8089">Logs "Diffie Hellman key exchange failed"</text><polygon fill="#181818" points="254.75,3127.0664,259.75,3129.0664,254.75,3131.0664,256.75,3129.0664" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="3129.0664" y2="3129.0664"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147.5" x="48.75" y="3126.1619">messageExchange(portServerNumber, sessionId)</text><polygon fill="#181818" points="1137.5,3142.9194,1142.5,3144.9194,1137.5,3146.9194,1139.5,3144.9194" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="3144.9194" y2="3144.9194"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="269.25" y="3142.0149">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="271.25,3158.7724,266.25,3160.7724,271.25,3162.7724,269.25,3160.7724" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3160.7724" y2="3160.7724"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="41" x="274.25" y="3157.8679">newIVrotated</text><polygon fill="#181818" points="1137.5,3174.6254,1142.5,3176.6254,1137.5,3178.6254,1139.5,3176.6254" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="3176.6254" y2="3176.6254"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="79.5" x="269.25" y="3173.7209">getFormattedTimestamp()</text><polygon fill="#181818" points="271.25,3190.4784,266.25,3192.4784,271.25,3194.4784,269.25,3192.4784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3192.4784" y2="3192.4784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="46.5" x="274.25" y="3189.5739">newTimeStamp</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3208.3314" y2="3208.3314"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3208.3314" y2="3214.8314"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3214.8314" y2="3214.8314"/><polygon fill="#181818" points="271.25,3212.8314,266.25,3214.8314,271.25,3216.8314,269.25,3214.8314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="240" x="269.25" y="3205.4269">built message sent with clientId, sessionId, newTimeStamp as clientMessageSent</text><polygon fill="#181818" points="1137.5,3228.6844,1142.5,3230.6844,1137.5,3232.6844,1139.5,3230.6844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="3230.6844" y2="3230.6844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="224.5" x="269.25" y="3227.7799">encryptMessageAes256CbcMode(newPlaintext, _derivedSymmetricKey, _iv)</text><polygon fill="#181818" points="271.25,3244.5374,266.25,3246.5374,271.25,3248.5374,269.25,3246.5374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3246.5374" y2="3246.5374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="274.25" y="3243.6329">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3265.067" y2="3265.067"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3265.067" y2="3271.567"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3271.567" y2="3271.567"/><polygon fill="#181818" points="271.25,3269.567,266.25,3271.567,271.25,3273.567,269.25,3271.567" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="269.25" y="3262.1625">built "client_message_exchange" message</text><path d="M96.5,3253.0374 L96.5,3275.5374 L258,3275.5374 L258,3258.0374 L253,3253.0374 L96.5,3253.0374 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,3253.0374 L253,3258.0374 L258,3258.0374 L253,3253.0374 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151" x="99.5" y="3262.486">Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="99.5" y="3271.339">with sessionId, newIVrotated and ciphertext</text><polygon fill="#181818" points="1200.5,3288.0965,1205.5,3290.0965,1200.5,3292.0965,1202.5,3290.0965" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1203.5" y1="3290.0965" y2="3290.0965"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="269.25" y="3287.192">HTTP POST /messageExchange (client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3305.9495" y2="3305.9495"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3305.9495" y2="3312.4495"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3312.4495" y2="3312.4495"/><polygon fill="#181818" points="1217,3310.4495,1212,3312.4495,1217,3314.4495,1215,3312.4495" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="1215" y="3303.045">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3328.3025" y2="3328.3025"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3328.3025" y2="3334.8025"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3334.8025" y2="3334.8025"/><polygon fill="#181818" points="1217,3332.8025,1212,3334.8025,1217,3336.8025,1215,3334.8025" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="1215" y="3325.398">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3350.6555" y2="3350.6555"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3350.6555" y2="3357.1555"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3357.1555" y2="3357.1555"/><polygon fill="#181818" points="1217,3355.1555,1212,3357.1555,1217,3359.1555,1215,3357.1555" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="1215" y="3347.751">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3373.0085" y2="3373.0085"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3373.0085" y2="3379.5085"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3379.5085" y2="3379.5085"/><polygon fill="#181818" points="1217,3377.5085,1212,3379.5085,1217,3381.5085,1215,3379.5085" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="1215" y="3370.104">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3395.3615" y2="3395.3615"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3395.3615" y2="3401.8615"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3401.8615" y2="3401.8615"/><polygon fill="#181818" points="1217,3399.8615,1212,3401.8615,1217,3403.8615,1215,3401.8615" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="1215" y="3392.457">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M1188,3409.3615 L1219.5,3409.3615 L1219.5,3414.2145 L1214.5,3419.2145 L1188,3419.2145 L1188,3409.3615 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="1188" y="3409.3615"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1195.5" y="3416.81">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="86.5" x="1227" y="3416.241">[sessionIdASFoundFlag == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3431.0675" y2="3431.0675"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3431.0675" y2="3437.5675"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3437.5675" y2="3437.5675"/><polygon fill="#181818" points="1217,3435.5675,1212,3437.5675,1217,3439.5675,1215,3437.5675" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1215" y="3428.163">Throws an exception</text><polygon fill="#181818" points="2529,3454.9205,2534,3456.9205,2529,3458.9205,2531,3456.9205" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3456.9205" y2="3456.9205"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="1215" y="3454.016">hexToBytes(extractedIv)</text><polygon fill="#181818" points="1217,3470.7735,1212,3472.7735,1217,3474.7735,1215,3472.7735" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3472.7735" y2="3472.7735"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="29.5" x="1220" y="3469.869">iv as ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3488.6266" y2="3488.6266"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3488.6266" y2="3495.1266"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3495.1266" y2="3495.1266"/><polygon fill="#181818" points="1217,3493.1266,1212,3495.1266,1217,3497.1266,1215,3495.1266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1215" y="3485.7221">store new iv in bytes for that session id</text><polygon fill="#181818" points="2529,3508.9796,2534,3510.9796,2529,3512.9796,2531,3510.9796" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3510.9796" y2="3510.9796"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="1215" y="3508.0751">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, ivAM)</text><polygon fill="#181818" points="1217,3526.3326,1212,3528.3326,1217,3530.3326,1215,3528.3326" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3528.3326" y2="3528.3326"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1220" y="3525.4281">plaintext</text><path d="M1046.5,3517.4796 L1046.5,3530.9796 L1204,3530.9796 L1204,3522.4796 L1199,3517.4796 L1046.5,3517.4796 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3517.4796 L1199,3522.4796 L1204,3522.4796 L1199,3517.4796 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="1049.5" y="3526.9281">Mallory build fake client request to the real server</text><polygon fill="#181818" points="2529,3543.6856,2534,3545.6856,2529,3547.6856,2531,3545.6856" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3545.6856" y2="3545.6856"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1215" y="3542.7811">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1217,3559.5386,1212,3561.5386,1217,3563.5386,1215,3561.5386" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3561.5386" y2="3561.5386"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="29" x="1220" y="3558.6341">iv as ivMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3577.3916" y2="3577.3916"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3577.3916" y2="3583.8916"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3583.8916" y2="3583.8916"/><polygon fill="#181818" points="1217,3581.8916,1212,3583.8916,1217,3585.8916,1215,3583.8916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187.5" x="1215" y="3574.4871">store new iv in bytes for that session id for Mallory -&gt; Server leg</text><polygon fill="#181818" points="2529,3597.7446,2534,3599.7446,2529,3601.7446,2531,3599.7446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="3599.7446" y2="3599.7446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="192.5" x="1215" y="3596.8401">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivMS)</text><polygon fill="#181818" points="1217,3615.0976,1212,3617.0976,1217,3619.0976,1215,3617.0976" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="3617.0976" y2="3617.0976"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40" x="1220" y="3614.1931">ciphertextMS</text><path d="M1059,3606.2446 L1059,3619.7446 L1204,3619.7446 L1204,3611.2446 L1199,3606.2446 L1059,3606.2446 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3606.2446 L1199,3611.2446 L1204,3611.2446 L1199,3606.2446 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1062" y="3615.6931">Mallory build body request for the real server</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3637.1271" y2="3637.1271"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3637.1271" y2="3643.6271"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3643.6271" y2="3643.6271"/><polygon fill="#181818" points="1217,3641.6271,1212,3643.6271,1217,3645.6271,1215,3643.6271" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="1215" y="3634.2226">built fake "client_message_exchange" message</text><path d="M1004.5,3625.0976 L1004.5,3647.5976 L1204,3647.5976 L1204,3630.0976 L1199,3625.0976 L1004.5,3625.0976 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3625.0976 L1199,3630.0976 L1204,3630.0976 L1199,3625.0976 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189" x="1007.5" y="3634.5461">Mallory fake Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="1007.5" y="3643.3991">with sessionId, ivMS and ciphertext</text><polygon fill="#181818" points="2601.5,3660.1566,2606.5,3662.1566,2601.5,3664.1566,2603.5,3662.1566" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2604.5" y1="3662.1566" y2="3662.1566"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="207" x="1215" y="3659.2521">HTTP POST /messageExchange (fake client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3678.0096" y2="3678.0096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3678.0096" y2="3684.5096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3684.5096" y2="3684.5096"/><polygon fill="#181818" points="2618,3682.5096,2613,3684.5096,2618,3686.5096,2616,3684.5096" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="2616" y="3675.1051">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3700.3627" y2="3700.3627"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3700.3627" y2="3706.8627"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3706.8627" y2="3706.8627"/><polygon fill="#181818" points="2618,3704.8627,2613,3706.8627,2618,3708.8627,2616,3706.8627" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2616" y="3697.4582">extract session id as extractedSessionIdUuidFormat</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3722.7157" y2="3722.7157"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3722.7157" y2="3729.2157"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3729.2157" y2="3729.2157"/><polygon fill="#181818" points="2618,3727.2157,2613,3729.2157,2618,3731.2157,2616,3729.2157" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="2616" y="3719.8112">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3745.0687" y2="3745.0687"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3745.0687" y2="3751.5687"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3751.5687" y2="3751.5687"/><polygon fill="#181818" points="2618,3749.5687,2613,3751.5687,2618,3753.5687,2616,3751.5687" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="2616" y="3742.1642">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3767.4217" y2="3767.4217"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3767.4217" y2="3773.9217"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3773.9217" y2="3773.9217"/><polygon fill="#181818" points="2618,3771.9217,2613,3773.9217,2618,3775.9217,2616,3773.9217" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="2616" y="3764.5172">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M2582.25,3781.4217 L2613.75,3781.4217 L2613.75,3786.2747 L2608.75,3791.2747 L2582.25,3791.2747 L2582.25,3781.4217 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2582.25" y="3781.4217"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2589.75" y="3788.8702">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="130" x="2621.25" y="3788.3011">[extractedSessionIdUuidFormat does not exist]</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3803.1277" y2="3803.1277"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3803.1277" y2="3809.6277"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3809.6277" y2="3809.6277"/><polygon fill="#181818" points="2618,3807.6277,2613,3809.6277,2618,3811.6277,2616,3809.6277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="2616" y="3800.2232">Throws an exception</text><polygon fill="#181818" points="3489.75,3826.9807,3494.75,3828.9807,3489.75,3830.9807,3491.75,3828.9807" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3492.75" y1="3828.9807" y2="3828.9807"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="2616" y="3826.0762">hexToBytes(extractedIv)</text><polygon fill="#181818" points="2618,3842.8337,2613,3844.8337,2618,3846.8337,2616,3844.8337" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3497.75" y1="3844.8337" y2="3844.8337"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2621" y="3841.9292">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3860.6867" y2="3860.6867"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3860.6867" y2="3867.1867"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3867.1867" y2="3867.1867"/><polygon fill="#181818" points="2618,3865.1867,2613,3867.1867,2618,3869.1867,2616,3867.1867" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2616" y="3857.7822">store new iv in bytes for that session id</text><polygon fill="#181818" points="3489.75,3881.0397,3494.75,3883.0397,3489.75,3885.0397,3491.75,3883.0397" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3492.75" y1="3883.0397" y2="3883.0397"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="2616" y="3880.1352">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, iv)</text><polygon fill="#181818" points="2618,3896.8927,2613,3898.8927,2618,3900.8927,2616,3898.8927" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3497.75" y1="3898.8927" y2="3898.8927"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="2621" y="3895.9882">plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3914.7457" y2="3914.7457"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3914.7457" y2="3921.2457"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3921.2457" y2="3921.2457"/><polygon fill="#181818" points="2618,3919.2457,2613,3921.2457,2618,3923.2457,2616,3921.2457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="212.5" x="2616" y="3911.8412">build server's confirmation with server id, extracted session id, plaintext</text><polygon fill="#181818" points="3489.75,3935.0988,3494.75,3937.0988,3489.75,3939.0988,3491.75,3937.0988" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3492.75" y1="3937.0988" y2="3937.0988"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="2616" y="3934.1943">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="2618,3950.9518,2613,3952.9518,2618,3954.9518,2616,3952.9518" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3497.75" y1="3952.9518" y2="3952.9518"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2621" y="3950.0473">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="3968.8048" y2="3968.8048"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="3968.8048" y2="3975.3048"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="3975.3048" y2="3975.3048"/><polygon fill="#181818" points="2618,3973.3048,2613,3975.3048,2618,3977.3048,2616,3975.3048" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2616" y="3965.9003">store new iv in bytes for that session id</text><polygon fill="#181818" points="3489.75,3989.1578,3494.75,3991.1578,3489.75,3993.1578,3491.75,3991.1578" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="3492.75" y1="3991.1578" y2="3991.1578"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="183" x="2616" y="3988.2533">encryptMessageAes256CbcMode(plaintext, symmetricKey, iv)</text><polygon fill="#181818" points="2618,4005.0108,2613,4007.0108,2618,4009.0108,2616,4007.0108" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2615" x2="3497.75" y1="4007.0108" y2="4007.0108"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2621" y="4004.1063">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="4022.8638" y2="4022.8638"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="4022.8638" y2="4029.3638"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="4029.3638" y2="4029.3638"/><polygon fill="#181818" points="2618,4027.3638,2613,4029.3638,2618,4031.3638,2616,4029.3638" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="244" x="2616" y="4019.9593">built server confirmation message with server id, extractedSessionId and plaintext</text><path d="M2413.5,4015.2608 L2413.5,4028.7608 L2605,4028.7608 L2605,4020.2608 L2600,4015.2608 L2413.5,4015.2608 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2600,4015.2608 L2600,4020.2608 L2605,4020.2608 L2600,4015.2608 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="2416.5" y="4024.7093">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="2612.5" x2="2633.5" y1="4047.8933" y2="4047.8933"/><line style="stroke:#181818;stroke-width:0.5;" x1="2633.5" x2="2633.5" y1="4047.8933" y2="4054.3933"/><line style="stroke:#181818;stroke-width:0.5;" x1="2613" x2="2633.5" y1="4054.3933" y2="4054.3933"/><polygon fill="#181818" points="2618,4052.3933,2613,4054.3933,2618,4056.3933,2616,4054.3933" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2616" y="4044.9888">built "client_message_exchange" response message</text><path d="M2411,4035.8638 L2411,4058.3638 L2605,4058.3638 L2605,4040.8638 L2600,4035.8638 L2411,4035.8638 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2600,4035.8638 L2600,4040.8638 L2605,4040.8638 L2600,4035.8638 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="2414" y="4045.3123">Server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124.5" x="2414" y="4054.1653">with extractedSessionId, iv and ciphertext</text><polygon fill="#181818" points="1217,4070.9228,1212,4072.9228,1217,4074.9228,1215,4072.9228" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2609.5" y1="4072.9228" y2="4072.9228"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="172" x="1220" y="4070.0183">HTTP 201 OK (Server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4088.7758" y2="4088.7758"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4088.7758" y2="4095.2758"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4095.2758" y2="4095.2758"/><polygon fill="#181818" points="1217,4093.2758,1212,4095.2758,1217,4097.2758,1215,4095.2758" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="67.5" x="1215" y="4085.8713">Parse requestMS body</text><path d="M1188,4102.7758 L1219.5,4102.7758 L1219.5,4107.6288 L1214.5,4112.6288 L1188,4112.6288 L1188,4102.7758 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="1188" y="4102.7758"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1195.5" y="4110.2243">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="84.5" x="1227" y="4109.6553">[requestMS.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4124.4818" y2="4124.4818"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4124.4818" y2="4130.9818"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4130.9818" y2="4130.9818"/><polygon fill="#181818" points="1217,4128.9818,1212,4130.9818,1217,4132.9818,1215,4130.9818" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1215" y="4121.5773">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4150.3349" y2="4150.3349"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4150.3349" y2="4156.8349"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4156.8349" y2="4156.8349"/><polygon fill="#181818" points="1217,4154.8349,1212,4156.8349,1217,4158.8349,1215,4156.8349" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="1215" y="4147.4304">extract session id as extractedSessionIdMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4172.6879" y2="4172.6879"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4172.6879" y2="4179.1879"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4179.1879" y2="4179.1879"/><polygon fill="#181818" points="1217,4177.1879,1212,4179.1879,1217,4181.1879,1215,4179.1879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92.5" x="1215" y="4169.7834">extract iv as extractedIvHexMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4195.0409" y2="4195.0409"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4195.0409" y2="4201.5409"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4201.5409" y2="4201.5409"/><polygon fill="#181818" points="1217,4199.5409,1212,4201.5409,1217,4203.5409,1215,4201.5409" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="1215" y="4192.1364">extract ciphertext as extractedCiphertextMS</text><polygon fill="#181818" points="2529,4215.3939,2534,4217.3939,2529,4219.3939,2531,4217.3939" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4217.3939" y2="4217.3939"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="94.5" x="1215" y="4214.4894">hexToBytes(extractedIvHexMS)</text><polygon fill="#181818" points="1217,4231.2469,1212,4233.2469,1217,4235.2469,1215,4233.2469" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4233.2469" y2="4233.2469"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="1220" y="4230.3424">extractedIvMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4249.0999" y2="4249.0999"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4249.0999" y2="4255.5999"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4255.5999" y2="4255.5999"/><polygon fill="#181818" points="1217,4253.5999,1212,4255.5999,1217,4257.5999,1215,4255.5999" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60.5" x="1215" y="4246.1954">store extractedIvMS</text><polygon fill="#181818" points="2529,4269.4529,2534,4271.4529,2529,4273.4529,2531,4271.4529" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4271.4529" y2="4271.4529"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="264.5" x="1215" y="4268.5484">decryptMessageAes256CbcMode(extractedCiphertextMS, symmetricKey, extractedIvMS)</text><polygon fill="#181818" points="1217,4286.8059,1212,4288.8059,1217,4290.8059,1215,4288.8059" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4288.8059" y2="4288.8059"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1220" y="4285.9014">plaintext</text><path d="M1004,4277.9529 L1004,4291.4529 L1204,4291.4529 L1204,4282.9529 L1199,4277.9529 L1004,4277.9529 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4277.9529 L1199,4282.9529 L1204,4282.9529 L1199,4277.9529 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189.5" x="1007" y="4287.4014">Mallory build client's request response instead of the real server</text><polygon fill="#181818" points="2529,4304.1589,2534,4306.1589,2529,4308.1589,2531,4306.1589" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4306.1589" y2="4306.1589"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1215" y="4303.2544">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1217,4320.0119,1212,4322.0119,1217,4324.0119,1215,4322.0119" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4322.0119" y2="4322.0119"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="1220" y="4319.1074">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4337.8649" y2="4337.8649"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4337.8649" y2="4344.3649"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4344.3649" y2="4344.3649"/><polygon fill="#181818" points="1217,4342.3649,1212,4344.3649,1217,4346.3649,1215,4344.3649" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="1215" y="4334.9604">store new iv in bytes for that session id for Alice -&gt; Mallory leg</text><polygon fill="#181818" points="2529,4358.2179,2534,4360.2179,2529,4362.2179,2531,4360.2179" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2532" y1="4360.2179" y2="4360.2179"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="1215" y="4357.3134">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivAM)</text><polygon fill="#181818" points="1217,4374.071,1212,4376.071,1217,4378.071,1215,4376.071" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2537" y1="4376.071" y2="4376.071"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40.5" x="1220" y="4373.1665">ciphertextAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4391.924" y2="4391.924"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4391.924" y2="4398.424"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4398.424" y2="4398.424"/><polygon fill="#181818" points="1217,4396.424,1212,4398.424,1217,4400.424,1215,4398.424" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="267.5" x="1215" y="4389.0195">built fake server confirmation message with server id, extractedSessionIdMS and plaintext</text><path d="M1012.5,4384.321 L1012.5,4397.821 L1204,4397.821 L1204,4389.321 L1199,4384.321 L1012.5,4384.321 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4384.321 L1199,4389.321 L1204,4389.321 L1199,4384.321 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="1015.5" y="4393.7695">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4416.9535" y2="4416.9535"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4416.9535" y2="4423.4535"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4423.4535" y2="4423.4535"/><polygon fill="#181818" points="1217,4421.4535,1212,4423.4535,1217,4425.4535,1215,4423.4535" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168.5" x="1215" y="4414.049">built fake "client_message_exchange" response message</text><path d="M995,4404.924 L995,4427.424 L1204,4427.424 L1204,4409.924 L1199,4404.924 L995,4404.924 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4404.924 L1199,4409.924 L1204,4409.924 L1199,4404.924 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="998" y="4414.3725">Fake server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154" x="998" y="4423.2255">with extractedSessionIdMS, ivAM and ciphertextAM</text><polygon fill="#181818" points="271.25,4439.983,266.25,4441.983,271.25,4443.983,269.25,4441.983" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1208.5" y1="4441.983" y2="4441.983"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187" x="274.25" y="4439.0785">HTTP 201 OK (Fake server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4457.836" y2="4457.836"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4457.836" y2="4464.336"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4464.336" y2="4464.336"/><polygon fill="#181818" points="271.25,4462.336,266.25,4464.336,271.25,4466.336,269.25,4464.336" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="269.25" y="4454.9315">Parse request body</text><path d="M235.5,4471.836 L267,4471.836 L267,4476.689 L262,4481.689 L235.5,4481.689 L235.5,4471.836 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="4471.836"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="4479.2845">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="76.5" x="274.5" y="4478.7155">[request.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4493.542" y2="4493.542"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4493.542" y2="4500.042"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4500.042" y2="4500.042"/><polygon fill="#181818" points="271.25,4498.042,266.25,4500.042,271.25,4502.042,269.25,4500.042" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="4490.6375">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4519.395" y2="4519.395"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4519.395" y2="4525.895"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4525.895" y2="4525.895"/><polygon fill="#181818" points="271.25,4523.895,266.25,4525.895,271.25,4527.895,269.25,4525.895" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="269.25" y="4516.4905">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4541.748" y2="4541.748"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4541.748" y2="4548.248"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4548.248" y2="4548.248"/><polygon fill="#181818" points="271.25,4546.248,266.25,4548.248,271.25,4550.248,269.25,4548.248" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83" x="269.25" y="4538.8435">extract iv as extractedIvHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4564.101" y2="4564.101"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4564.101" y2="4570.601"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4570.601" y2="4570.601"/><polygon fill="#181818" points="271.25,4568.601,266.25,4570.601,271.25,4572.601,269.25,4570.601" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="269.25" y="4561.1965">extract ciphertext as extractedCiphertext</text><polygon fill="#181818" points="1137.5,4584.454,1142.5,4586.454,1137.5,4588.454,1139.5,4586.454" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="4586.454" y2="4586.454"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="85" x="269.25" y="4583.5495">hexToBytes(extractedIvHex)</text><polygon fill="#181818" points="271.25,4600.3071,266.25,4602.3071,271.25,4604.3071,269.25,4602.3071" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="4602.3071" y2="4602.3071"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="34" x="274.25" y="4599.4026">extractedIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4618.1601" y2="4618.1601"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4618.1601" y2="4624.6601"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4624.6601" y2="4624.6601"/><polygon fill="#181818" points="271.25,4622.6601,266.25,4624.6601,271.25,4626.6601,269.25,4624.6601" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="51" x="269.25" y="4615.2556">store extractedIv</text><polygon fill="#181818" points="1137.5,4638.5131,1142.5,4640.5131,1137.5,4642.5131,1139.5,4640.5131" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="4640.5131" y2="4640.5131"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="245.5" x="269.25" y="4637.6086">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, extractedIv)</text><polygon fill="#181818" points="271.25,4654.3661,266.25,4656.3661,271.25,4658.3661,269.25,4656.3661" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="4656.3661" y2="4656.3661"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="274.25" y="4653.4616">decryptedCiphertext</text><path d="M235.5,4663.8661 L267,4663.8661 L267,4668.7191 L262,4673.7191 L235.5,4673.7191 L235.5,4663.8661 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="4663.8661"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="4671.3146">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="151" x="274.5" y="4670.7455">[decryptedCiphertext.find(clientMessageSent) == true]</text><path d="M268,4676.2191 L268,4689.7191 L392.5,4689.7191 L392.5,4681.2191 L387.5,4676.2191 L268,4676.2191 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M387.5,4676.2191 L387.5,4681.2191 L392.5,4681.2191 L387.5,4676.2191 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="114" x="271" y="4685.6676">Connection Test Result : Success (true)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="428" y1="4693.0721" y2="4693.0721"/><path d="M268,4696.0721 L268,4709.5721 L390.5,4709.5721 L390.5,4701.0721 L385.5,4696.0721 L268,4696.0721 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M385.5,4696.0721 L385.5,4701.0721 L390.5,4701.0721 L385.5,4696.0721 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="112" x="271" y="4705.5206">Connection Test Result : Failure (false)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4724.2781" y2="4724.2781"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4724.2781" y2="4730.7781"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4730.7781" y2="4730.7781"/><polygon fill="#181818" points="271.25,4728.7781,266.25,4730.7781,271.25,4732.7781,269.25,4730.7781" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="4721.3736">Throws an exception</text><polygon fill="#181818" points="50.75,4748.1311,45.75,4750.1311,50.75,4752.1311,48.75,4750.1311" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="4750.1311" y2="4750.1311"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="53.75" y="4747.2266">connectionTestResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="66.25" y1="4768.4841" y2="4768.4841"/><line style="stroke:#181818;stroke-width:0.5;" x1="66.25" x2="66.25" y1="4768.4841" y2="4774.9841"/><line style="stroke:#181818;stroke-width:0.5;" x1="42.75" x2="66.25" y1="4774.9841" y2="4774.9841"/><polygon fill="#181818" points="47.75,4772.9841,42.75,4774.9841,47.75,4776.9841,45.75,4774.9841" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="42.5" x="48.75" y="4765.5796">Program ends</text><!--SRC=[rHrhRziuyhj-1I-7GsL0pUqkiFUXG0iaQTBajka6TRh0uN1hA19Zws9BMabsciN- -1i-HOeFKOwRnVL3QylYp70ud3VPDalN67rt_6CKtLLVqT7Pki1bXyxBNT5KvGO-7w6_VYoMg-vVUBsk7YC4V-gqwOgig5DuysYJ5YMAcst9Xdu_Eq9fYwxXgVakXnwVLdViDVR0zUAREMxReYhVfrsglAuyTOvyNzpV5_WIQDwafJBs_QLxoELDsgIRzcELvhZHnh17pf7NG52wnETVkoRDEY3j8isATT4zAK2kpo-Suy_Bh7cgoS0ltN3S-PS8bpc2nU4hTD9rQVQ06ziQdLLDkZRHNAUmTCqJNnZwsVdI6_xlaFNcOpS8iSnTXUQusU5cfeAuI1-mQzq516tvA20sGWFq_d8w60izxo_PGmyOKpBaM9TeI7PwPOE_PHKE0S4k7VnNGppON6p2SRhUOXCBVpy-kRbYN64FuAlhNMDNiiTUoU0ZpLt9Vh3jIZ74vBqOus8z7-ddF7l9odW-tivtzgFATW9ybtQOwRo8_8rUl-C2YzwWimQJNzdt-0Xqtr62SdotNLwiqsM2basrhJ-b6_p-SjO3KqIRGteDG2dmDwZ4Z-A570-7c1JaAjj_ma_dNxDLMYvnN3TLlgMykQcQpeuzNNTeeT1uZ3TrznJFqDktw3vTjqocL3hVIRtPprvR-NYXJ7-XpP_0mGS0Mb_Yh_3F2lxXGCkSJKUV8fUy7XF0Lt0n4GECQ_ZmVaL54NUuQUCbxjJl5yKQb_3vOvMbX9_nR2O16oWLmHqYvmXVw_FzZBjjKxQ8RmQA4MtIMe8mfC10ufqce5ZY4ZSm_gQXO41AOiyCB8YZO0pRktMHXIAm0uHz2n1Fhpvy-d9zMy4YnujQW3s6fL7PRu4ljhs9X00UC9_HYm0oEa7nIWYKa_KgSCkwsFYagGkB0uEAiktICiC813zdnji9UhXZphyep3yZAgrQDcczAh9F5O2CI_BtlFWTpsmR13ITJY-0q-ZDw0SA2jR1JXe0iP86m- -s1IYOeuTUAnsX3TFST4XP0PGrlk-66Y6hW2SDQAyM_NF-yoTqn0XPh8YVUYJVVYow5QVnAazKQXFvJWrAE45IW4w4mg38XvHpmmkaNzxUtg2Rd-UtwEyA-IXcxvAbgoXf0xuA3qoY5n0ru9YPBKxmgnQrpBwY8YTcYF-CypC-jOdGwA9hW2XF5BqV3gjkYWr6jGRjXZoxcGY82sdLeAK6x8Du_c4gPMphmkhenEahBSMi8MwIjha5xA84bPlXkXDkELtTO-tTIommj3q5lSp15oPsWb-9FbyGjrfgcXwo54FlpDl7jAvLHg6tSij_a3RZz8a53_EEF5y-nHOE9yCr91RwCwxNQOQ9Dwb3c7d8OZeQzELjzQKiVjjYfgvZop9O3C70CnwW4Mgwvq2DSIC1mdeX5IUwhvfDsjdKieB7psB1JWQNUxjNUUoctIf9EjMj0ECXpKUNudJtRf7vMxoGIZwnxlZ4L2Ymxgf3LUm-udBPhH8gkEv93yE00UqgmVqqH2JdSkqKGdJiDWgqiD12WaIcudSxUZC3ZedGuj0PI1NFpfprg8Fd5WydTjzq9MAlspUPmnvDQjiB0Zar8HG1qTIlDelsbNMieGjzNDb324okM5pLRysKhDhKMygJtdXTB-QWqEFbhvl53FqDrNy2TwPwt27AtA_KbVLGN7322jC9TolrqHcwbAd30LToKOep7i3gS6qOxh3x5Q7YkW_mSX_UEky6jrlmo5jm1d1E3EcYfIaFuU6VN8_CM3Zxq-Vw6PoWQdFrIooCpSlChzWTP4wQOM-uGjyOBoOAwcw5YPO7IwiAstLQ_riw1l_nU0OsM-jn5fGD1VQYsE7vAWL2vZW3QcrkMU8bxFKxGp961-Z1uicrsu-mggWWvRrebMaHjQcxXhz2SaWQEw9D5xewZQReG-hTdZw1kevrNlWbrwAOHdMW0fyYZARfldsdfQ_OuQUbmDzdMa4IaSC60PkLjYiG1rKwFgUF52dwum-34FBCo_CmOMGxBPy_RS2hQvW8laNpovCVVln7t1CscxG-7J7048CLvJAsOPYyJEFhPAfD2rwH07h6-lN80t56KsolgHJxQfHYY22n_I0pza4gxIfdsa-9cFp3j5zFhb-_0n-A1TpnB37ZURUY79JJ1ZDLfgSRA592o7Zi1ouDIPj0YYHbCwzAJ1uIymG-pfhl0m-d5IBqb8gMkTFTN9c-Mq5OL3sMQcO5oLATDfWcyyxKt0gthtIBtbPiIAADaTaMWwTAoezwbPmqFMy4cGDHD3HpCg5ovIp0K2wGx1AgeG33y7pQRkvKR26yTgpuks6DCwHs4X9XMzP6syqSMrY4FQ6KSlWGNFBbMuJWanWaATap9dUiYQr2inyvau9X1pL-hFi4cLC2JP-ba_CD2ZR30qwRk73cZA-7Gv-4reYcqX1UwmrHEZh9q-l0Kjr-OyH6hLZHy-4gTcAPxRb1hJR7U_b5gyDDZcV7kJbMhlCRV_A7WEEUHsWDJpF_r27f2tg3gIV6e45n3xPqPCsQZVD3TiPuQd-z3s6l0XhBthVR69Jt-0R8mK2rs420ulkcsWZIP-7WHDdilb-P2VN6FS675I3t11vGaTmJyeGIvRwqZzOieudPPMvC1iN95bOsWRulW8gfCprBhADj7ZPaGLT5-G0W2CLyCzCLTG3H7MtBuBxu3j4FYJlu4jhDFUnPyWxtwDL5YPnPyP1rCVqFRx7IiPbTtaUFu_L04lGCrMXwkqSJBcpZvKkFQdBFXc8Qe3ABciuvXEezQvtJ-EcWPKwZ36xPwwFCSrL3zQaEKkEYlt6lQgY3a457bKa3wwxIMol3og5EZ9wGR8XRYSoKsGU7P4xv6YN2DldG46mwgmDBWGF5xIoJfg-y89m5GG-xzcQK9pXyAJxPAwSdedAQkakdByInVSFR2JR6Psk6tOo4D-xercbpnkVhKDjxLLHzd9-gKlSjh3hMm1AgwKJmYCt6Yx4gQnWFXc7SL1wC55nVPDx5xk1p7VWZeXPxY2AiappLqeTuD7Gp1fTXTU601xwoNBYk3T2nGztAocVWuz7gAczCKTpx4oYmzlNLKx_ElLqL40Qqp9dN0D_XxX7ZKYRMYSlFI3cE9cjkYsPYaX5ImmfMFgv51iL-LfNt1Ub010dXnrBYVTVCEHaXvanMI6YbO1L96X9Jsl8rpvabGqyoGxcEiqwVYFzu-0Z3XeKJG7D4i8tNUVj6p3JfGvB4qGkkbdeF5xPGPOlPEIA-xYUuXShlsLrsNUMq_jCBHakhXgP4qh1aL5mSMjcYaJaFYneARntecsWltUlEy6bgGq_mWVgluH4OVVO2pLxPZGvTI6NTb0LIqdcdYKCTK9xZWK36_QGNr_C45JlOxV1fvfl37GOvsM6UhsX1qq3PdHGeQUg4-Z7WjQ3gtjht6vo3S2HSQQBnX- - -Hp__f37DabCS5rEFlkyJbqewIkrxLt2RAbZjVGzOC-HOX-FzKhFMpYkf1gNCvPWBnSH2jhKTdELWXml2Sx1AqNmMT6H18LVFkqfcdWk_812Up2SoE4BhxGtc-GT6b3bAO8g0JALC0ZCjMm_A3qlL3QoRXZWZhCH1rG_nIuGjcMH2gBzYK1Dys0GG5uJJwQQ6q_d_tKAFG9jLLSqy9T8r13-oaaCkNINHhQ71P3J9ZAde-2Wwb5UOB4I7Ei02hr0tMDXBYf8Xe3W7MgIaAMC2jDZ11z25k6ot3MaQwKXrfYgxfbgZYgQTqsm5Tc9952Gb0Q2MUArlzHkHi2_LREu712uXjJ5eMuhfLfmx2iYKdab9z79xI_fNqawPDfro-OfagZkYkSalrqLtpSSpWmhdV2STlfbaufcGsQtyWZOGaLvKT-l7mCPR2uEQQLyedQt-Ak3aRXrLzSa8tkpMgK3EYvAgGvjP00ALejbCAzIT9D54cmwyOr9P5bsHhelVsIixd15neimzjiwFMFL-Qah-A0OoPg8NYk-UI2-FF12zmNm1xYhGp0g8A1prrWewTjnRu0mY4arGCyq8k4I8djCE9Bl4_t_jeSXs5Chkv_JEYDtZSHsIifmlTTZftX4rYwOMzSp1ZVWucYH7HWEQKgPIlI5rkaJQ4iV-5JgSEKly1zSfrR7visbJLq_rKom0WZsKS00ENq9f6VA16Idk-eO6Lczz81IM1HHhJoV2wrUUEcrwY1OEfjYHuP1Piuvp5DFwCfgM24kigvGCpdrRAsiYQXsS1hSLnKpADErmg1IUSJBTIDjPc3mdU5JKh1LvW2fotbOHbEKxrJG9vQWjn-U-AC7XLChJyjRyNJl8tfrgsRiJCtitdh4Jb_zGYyZCCTTl7h_AVXM28pt7OR-MnflHyI3wteDlHZ0EEuprR3Do61NMzL3h8xOB9HHHxe55pciat3BbJIg6t75Y8qa6UwxCOMQYdCRnOT159VupjyMA9vSex25wn971MmoLa94ejr1ivP7plXdgt_FCWTs_TnBjlDvauCRRxzMGsOgRTKhIC60I70rUpkisl2w13RwUKnhNAB3l5Al7GsNTAvqNnDQBhGg-x6FQvF1kYdRWeEk-VCAyKle3VJ089zPhj2uUyFe9ShvjczXzxvPefcsMmLhTRzVmhWO4gDviooAZdZKDKC197rLCBd-6YYJBiV2y3wbk4PfgmTGWI6govW20c3FwB42gL_iiG49xx0D4YXYnDaCnwpCqS5gb9IQveEWs86S9sjP4WW1HBqoVMUanpRAg8IdSzPEvIrJiyLq5EOpXUE9sq4oHt3-QMh5SnoKQgmrAeAaQOcgRhF5hlZvMonOTiR8v4dLpuckAv0yJT9mVKJChAJ8gFFwT35jkMwQF94w4l107ARO7txa9JHMvzmhfqRREq7L5MF0KxrCu3v8VoKkyWcuyawatST7Pu7IDOazcaVVIDUijIh9klj0BvrFlJe93M5U_D90p4zd1u9kJE3dT1RtO18RVGW3KabHUl3Sf1CISWDZp4YUnrLloS73lacA-LKnzQfhlehdSCjOP-n9j05UQij52skHRhlHGB9WvicEUTxPp7YtmOIwxCi15hlAPAcfKMmncDEcwgy7sGh637D_rLm7LbGP3goeaek-g_2divYT7q_hSw4ZrGc7XC_zsjGkyT4eBtVjek6VpI35YXI5_LjnhSrZJXYY0LhGTE3natMZKI-qUgDijITpHBznODKLwjyRzmf_CBwfjcPDkqKWzvMDxmNxAnqhixQgf7aa5WEXfN6k-chXfSUGs0hgVbTXBSkngz-m4kCX_Z6M__NTgKKQJSx803kpB7JqLphAngIfgqTWiVU63HL10MsfAwo0r0TFXyd8ai2x0UYxKYh7OivxZmw5LbJ5hUm01kPw_X83GPme8tbW0sVVeEPMbkhTsGu5HMngUNKGAPT8acI4wNGeBuzc8jFWNWvbPAebXjdQSKEKIW3qCiCq8auMn6T_HUJgEdXbsMDc9FcEihTP8DzR8AJIhZGuwzZHcgxziY_n2lxSl2AxBUWSDdc35lV1UpfeBY-vZO5_ifxZ3c_fyTbu8xIX7WYnzM4URivjjq4Liws0Bcl0UHjytwsTR_eCnoBJ_GPr-8-sUzbvJhlQeaIE73FlKJS-_n45H45j3F8EN4QX3IzLaLkpf81oCJuusqh4D63R3NjGw8K_MqeHJuAGkPFVhIeaBFAikEa29hBV2PU6D0xtFmWmWxwDGB710C-F8dDsUZ2HZsk5xHrjk01xxONoJqGcrltONnzce7utsnDexOKd711S1pSkHPC-YAAmxrlGf1muEE6wQYqDChlpf639ltRPTPB3hq5_U4Yf7OkZn4Fem2G_5TmzFUH3B3DMpqB6ZFXC0sYyHG8buTYIZ03n0lAT3Et3eJvgXTLMjeNkfBC2aI4uMhuGcb3f3QOqFpWNygKc1byaNqMUiQAa0-8RPW8Esb0Ptb8w5wSypw3oGjfXqkymUo9GVCXlXjE7s6LpeJ7kM0NSORtOM0rfoTGEkBFa-tPmNMc_QcC6Uqj_fJ48erjbdcosbB9TPbYRPf65IyS4zt6Q2HuO4PYkifJIdnTslGAR0S5R872mtxAg7wcS6r4RgOUeqPOtzBB0WI2JHCkZulYZps2XzpeocW4-oT4_KKd-hMGM7AEZ_t8LkYUJpWZiqAxBM5pXL3r0i_v_ML7WNK7ud9pjYMXcQ7MJhzEN_JA8bM1bIRuMVZxjfoCdz3G7THfgsACheVm00]--></g></svg>