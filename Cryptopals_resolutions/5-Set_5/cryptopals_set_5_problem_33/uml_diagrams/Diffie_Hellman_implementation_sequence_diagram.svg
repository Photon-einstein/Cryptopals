<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2704px" preserveAspectRatio="none" style="width:3301px;height:2704px;background:#FFFFFF;" version="1.1" viewBox="0 0 3301 2704" width="3301px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="2692.5412" style="stroke:#181818;stroke-width:0.5;" width="1819" x="16" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="128" x="861.5" y="19.897">Client Environment</text><rect fill="#ADD8E6" height="2692.5412" style="stroke:#181818;stroke-width:0.5;" width="1363" x="1837" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131" x="2453" y="19.897">Server Environment</text><rect fill="#FFFFFF" height="2564.6993" style="stroke:#181818;stroke-width:1.0;" width="10" x="80.5" y="71.7739"/><rect fill="#FFFFFF" height="2556.9933" style="stroke:#181818;stroke-width:1.0;" width="10" x="521.5" y="95.4799"/><rect fill="#FFFFFF" height="2091.403" style="stroke:#181818;stroke-width:1.0;" width="10" x="526.5" y="515.3642"/><rect fill="#FFFFFF" height="179.2361" style="stroke:#181818;stroke-width:1.0;" width="10" x="531.5" y="2298.4312"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="952.5" y="127.186"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="957.5" y="259.363"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="957.5" y="378.1871"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="952.5" y="1902.4"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="1321.5" y="170.745"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="301.4221"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="420.2461"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="1782.4289"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="1945.959"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="2068.4891"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="2131.9011"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="2195.3131"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="1742" y="547.0702"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1742" y="2335.1372"/><rect fill="#FFFFFF" height="1043.4166" style="stroke:#181818;stroke-width:1.0;" width="10" x="1881.5" y="651.8943"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="2307.5" y="802.4243"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2312.5" y="934.6014"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2312.5" y="1053.4255"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="2307.5" y="1202.4556"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="2676.5" y="845.9834"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="976.6604"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1095.4845"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1246.0146"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1368.5447"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1431.9567"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1495.3687"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="3105" y="739.0123"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="3105" y="1590.4868"/><rect fill="none" height="100.0999" style="stroke:#000000;stroke-width:1.5;" width="572" x="10" y="2499.6673"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="85" x2="85" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="526" x2="526" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="957" x2="957" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1326" x2="1326" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1538" x2="1538" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1747" x2="1747" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1886" x2="1886" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2312" x2="2312" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2681" x2="2681" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2897" x2="2897" y1="61.7739" y2="2661.4732"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3110" x2="3110" y1="61.7739" y2="2661.4732"/><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="20" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="27" y="49.672">main (runClient1)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="20" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="27" y="2682.4392">main (runClient1)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="481" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="488" y="49.672">Client (Bob)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="481" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="488" y="2682.4392">Client (Bob)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="149" x="883" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="890" y="49.672">Client:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="149" x="883" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="890" y="2682.4392">Client:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="1240" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="1247" y="49.672">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="1240" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="1247" y="2682.4392">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="1423" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="1430" y="49.672">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="1423" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="1430" y="2682.4392">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1663" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="1670" y="49.672">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="1663" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="1670" y="2682.4392">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="1841" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1848" y="49.672">Server (API)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="1841" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1848" y="2682.4392">Server (API)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="2236" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2243" y="49.672">Server:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="2236" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="2243" y="2682.4392">Server:DiffieHellman</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="177" x="2593" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="2600" y="49.672">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="177" x="2593" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="2600" y="2682.4392">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="2780" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="2787" y="49.672">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="2780" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="2787" y="2682.4392">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="3024" y="27.706"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="3031" y="49.672">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="3024" y="2660.4732"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="3031" y="2682.4392">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="2564.6993" style="stroke:#181818;stroke-width:1.0;" width="10" x="80.5" y="71.7739"/><rect fill="#FFFFFF" height="2556.9933" style="stroke:#181818;stroke-width:1.0;" width="10" x="521.5" y="95.4799"/><rect fill="#FFFFFF" height="2091.403" style="stroke:#181818;stroke-width:1.0;" width="10" x="526.5" y="515.3642"/><rect fill="#FFFFFF" height="179.2361" style="stroke:#181818;stroke-width:1.0;" width="10" x="531.5" y="2298.4312"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="952.5" y="127.186"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="957.5" y="259.363"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="957.5" y="378.1871"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="952.5" y="1902.4"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="1321.5" y="170.745"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="301.4221"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="420.2461"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="1782.4289"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="1945.959"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="2068.4891"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="2131.9011"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1533" y="2195.3131"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="1742" y="547.0702"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="1742" y="2335.1372"/><rect fill="#FFFFFF" height="1043.4166" style="stroke:#181818;stroke-width:1.0;" width="10" x="1881.5" y="651.8943"/><rect fill="#FFFFFF" height="356.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="2307.5" y="802.4243"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2312.5" y="934.6014"/><rect fill="#FFFFFF" height="73.765" style="stroke:#181818;stroke-width:1.0;" width="10" x="2312.5" y="1053.4255"/><rect fill="#FFFFFF" height="356.3252" style="stroke:#181818;stroke-width:1.0;" width="10" x="2307.5" y="1202.4556"/><rect fill="#FFFFFF" height="43.559" style="stroke:#181818;stroke-width:1.0;" width="10" x="2676.5" y="845.9834"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="976.6604"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1095.4845"/><rect fill="#FFFFFF" height="61.265" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1246.0146"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1368.5447"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1431.9567"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="2892" y="1495.3687"/><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="3105" y="739.0123"/><rect fill="#FFFFFF" height="52.412" style="stroke:#181818;stroke-width:1.0;" width="10" x="3105" y="1590.4868"/><polygon fill="#181818" points="509.5,91.4799,519.5,95.4799,509.5,99.4799,513.5,95.4799" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="90.5" x2="515.5" y1="95.4799" y2="95.4799"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="97.5" y="89.6709">Create Client("Bob", debugFlag)</text><polygon fill="#181818" points="940.5,123.186,950.5,127.186,940.5,131.186,944.5,127.186" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="531.5" x2="946.5" y1="127.186" y2="127.186"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="538.5" y="121.377">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="1309.5,166.745,1319.5,170.745,1309.5,174.745,1313.5,170.745" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1315.5" y1="170.745" y2="170.745"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340" x="969.5" y="164.936">loadDhParameters(getDhParametersFilenameLocation())</text><path d="M1336,140.186 L1336,185.186 L1651,185.186 L1651,150.186 L1641,140.186 L1336,140.186 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1641,140.186 L1641,150.186 L1651,150.186 L1641,140.186 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="1342" y="159.083">Client DHParamsLoader reads "rfc3526-group-17"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1342" y="176.789">p and g from file</text><polygon fill="#181818" points="973.5,210.304,963.5,214.304,973.5,218.304,969.5,214.304" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1325.5" y1="214.304" y2="214.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="979.5" y="208.495">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1009.5" y1="246.363" y2="246.363"/><line style="stroke:#181818;stroke-width:1.0;" x1="1009.5" x2="1009.5" y1="246.363" y2="259.363"/><line style="stroke:#181818;stroke-width:1.0;" x1="968.5" x2="1009.5" y1="259.363" y2="259.363"/><polygon fill="#181818" points="978.5,255.363,968.5,259.363,978.5,263.363,974.5,259.363" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="974.5" y="240.554">generatePrivateKey()</text><path d="M1112,227.304 L1112,272.304 L1414,272.304 L1414,237.304 L1404,227.304 L1112,227.304 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1404,227.304 L1404,237.304 L1414,237.304 L1404,227.304 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="1118" y="246.201">Client uses OpenSSL's BN_rand_range to get 'a'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1118" y="263.907">Ensures 1 &lt; a &lt; p-1</text><polygon fill="#181818" points="1521,297.4221,1531,301.4221,1521,305.4221,1525,301.4221" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="967.5" x2="1527" y1="301.4221" y2="301.4221"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="974.5" y="295.6131">hexToUniqueBIGNUM(p)</text><polygon fill="#181818" points="973.5,329.1281,963.5,333.1281,973.5,337.1281,969.5,333.1281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1537" y1="333.1281" y2="333.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="979.5" y="327.3191">UniqueBIGNUM</text><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1009.5" y1="365.1871" y2="365.1871"/><line style="stroke:#181818;stroke-width:1.0;" x1="1009.5" x2="1009.5" y1="365.1871" y2="378.1871"/><line style="stroke:#181818;stroke-width:1.0;" x1="968.5" x2="1009.5" y1="378.1871" y2="378.1871"/><polygon fill="#181818" points="978.5,374.1871,968.5,378.1871,978.5,382.1871,974.5,378.1871" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="974.5" y="359.3781">generatePublicKey()</text><path d="M1106,346.1281 L1106,391.1281 L1305,391.1281 L1305,356.1281 L1295,346.1281 L1106,346.1281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1295,346.1281 L1295,356.1281 L1305,356.1281 L1295,346.1281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1112" y="365.0251">Client computes A = (g^a) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="1112" y="382.7311">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="1521,416.2461,1531,420.2461,1521,424.2461,1525,420.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="967.5" x2="1527" y1="420.2461" y2="420.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="974.5" y="414.4371">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="973.5,447.9521,963.5,451.9521,973.5,455.9521,969.5,451.9521" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1537" y1="451.9521" y2="451.9521"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="979.5" y="446.1431">Public Key A (hex)</text><polygon fill="#181818" points="542.5,479.6582,532.5,483.6582,542.5,487.6582,538.5,483.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="536.5" x2="956.5" y1="483.6582" y2="483.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="548.5" y="477.8492">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="514.5,511.3642,524.5,515.3642,514.5,519.3642,518.5,515.3642" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="90.5" x2="520.5" y1="515.3642" y2="515.3642"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="97.5" y="509.5552">diffieHellmanKeyExchange(productionPort)</text><polygon fill="#181818" points="1730,543.0702,1740,547.0702,1730,551.0702,1734,547.0702" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="1736" y1="547.0702" y2="547.0702"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="543.5" y="541.2612">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="547.5,595.4822,537.5,599.4822,547.5,603.4822,543.5,599.4822" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="541.5" x2="1746" y1="599.4822" y2="599.4822"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="553.5" y="593.6732">clientNonceHex</text><path d="M281,560.0702 L281,623.0702 L516,623.0702 L516,570.0702 L506,560.0702 L281,560.0702 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M506,560.0702 L506,570.0702 L516,570.0702 L506,560.0702 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="287" y="578.9672">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="287" y="596.6732">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="287" y="614.3792">groupName, publicKeyA</text><polygon fill="#181818" points="1869.5,647.8943,1879.5,651.8943,1869.5,655.8943,1873.5,651.8943" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="1875.5" y1="651.8943" y2="651.8943"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="543.5" y="646.0853">HTTP POST /keyExchange (ClientHello JSON)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1891.5" x2="1933.5" y1="688.9533" y2="688.9533"/><line style="stroke:#181818;stroke-width:1.0;" x1="1933.5" x2="1933.5" y1="688.9533" y2="701.9533"/><line style="stroke:#181818;stroke-width:1.0;" x1="1892.5" x2="1933.5" y1="701.9533" y2="701.9533"/><polygon fill="#181818" points="1902.5,697.9533,1892.5,701.9533,1902.5,705.9533,1898.5,701.9533" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="1898.5" y="683.1443">Parse ClientHello JSON</text><path d="M2045,664.8943 L2045,709.8943 L2282,709.8943 L2282,674.8943 L2272,664.8943 L2045,664.8943 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2272,664.8943 L2272,674.8943 L2282,674.8943 L2272,664.8943 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="2051" y="683.7913">Server extracts clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="2051" y="701.4973">publicKeyA from client request.</text><polygon fill="#181818" points="3093,735.0123,3103,739.0123,3093,743.0123,3097,739.0123" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1891.5" x2="3099" y1="739.0123" y2="739.0123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="1898.5" y="733.2033">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="1902.5,766.7183,1892.5,770.7183,1902.5,774.7183,1898.5,770.7183" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1896.5" x2="3109" y1="770.7183" y2="770.7183"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="1908.5" y="764.9093">serverNonceHex</text><polygon fill="#181818" points="2295.5,798.4243,2305.5,802.4243,2295.5,806.4243,2299.5,802.4243" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1891.5" x2="2301.5" y1="802.4243" y2="802.4243"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="1898.5" y="796.6153">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="2664.5,841.9834,2674.5,845.9834,2664.5,849.9834,2668.5,845.9834" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2670.5" y1="845.9834" y2="845.9834"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340" x="2324.5" y="840.1744">loadDhParameters(getDhParametersFilenameLocation())</text><path d="M2691,815.4243 L2691,860.4243 L3010,860.4243 L3010,825.4243 L3000,815.4243 L2691,815.4243 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3000,815.4243 L3000,825.4243 L3010,825.4243 L3000,815.4243 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="2697" y="834.3214">Server DHParamsLoader reads "rfc3526-group-17"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="2697" y="852.0274">p and g from file (must match client's)</text><polygon fill="#181818" points="2328.5,885.5424,2318.5,889.5424,2328.5,893.5424,2324.5,889.5424" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2680.5" y1="889.5424" y2="889.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="2334.5" y="883.7334">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2364.5" y1="921.6014" y2="921.6014"/><line style="stroke:#181818;stroke-width:1.0;" x1="2364.5" x2="2364.5" y1="921.6014" y2="934.6014"/><line style="stroke:#181818;stroke-width:1.0;" x1="2323.5" x2="2364.5" y1="934.6014" y2="934.6014"/><polygon fill="#181818" points="2333.5,930.6014,2323.5,934.6014,2333.5,938.6014,2329.5,934.6014" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="2329.5" y="915.7924">generatePrivateKey()</text><path d="M2467,902.5424 L2467,947.5424 L2774,947.5424 L2774,912.5424 L2764,902.5424 L2467,902.5424 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2764,902.5424 L2764,912.5424 L2774,912.5424 L2764,902.5424 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="2473" y="921.4394">Server uses OpenSSL's BN_rand_range to get 'b'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="2473" y="939.1454">Ensures 1 &lt; b &lt; p-1</text><polygon fill="#181818" points="2880,972.6604,2890,976.6604,2880,980.6604,2884,976.6604" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2322.5" x2="2886" y1="976.6604" y2="976.6604"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="2329.5" y="970.8514">hexToUniqueBIGNUM(p)</text><polygon fill="#181818" points="2328.5,1004.3665,2318.5,1008.3665,2328.5,1012.3665,2324.5,1008.3665" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2896" y1="1008.3665" y2="1008.3665"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="2334.5" y="1002.5575">UniqueBIGNUM</text><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2364.5" y1="1040.4255" y2="1040.4255"/><line style="stroke:#181818;stroke-width:1.0;" x1="2364.5" x2="2364.5" y1="1040.4255" y2="1053.4255"/><line style="stroke:#181818;stroke-width:1.0;" x1="2323.5" x2="2364.5" y1="1053.4255" y2="1053.4255"/><polygon fill="#181818" points="2333.5,1049.4255,2323.5,1053.4255,2333.5,1057.4255,2329.5,1053.4255" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="2329.5" y="1034.6165">generatePublicKey()</text><path d="M2461,1021.3665 L2461,1066.3665 L2663,1066.3665 L2663,1031.3665 L2653,1021.3665 L2461,1021.3665 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2653,1021.3665 L2653,1031.3665 L2663,1031.3665 L2653,1021.3665 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="2467" y="1040.2635">Server computes B = (g^b) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="2467" y="1057.9695">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="2880,1091.4845,2890,1095.4845,2880,1099.4845,2884,1095.4845" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2322.5" x2="2886" y1="1095.4845" y2="1095.4845"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="2329.5" y="1089.6755">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2328.5,1123.1905,2318.5,1127.1905,2328.5,1131.1905,2324.5,1127.1905" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2896" y1="1127.1905" y2="1127.1905"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="2334.5" y="1121.3815">Public Key B (hex)</text><polygon fill="#181818" points="1902.5,1154.8965,1892.5,1158.8965,1902.5,1162.8965,1898.5,1158.8965" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1896.5" x2="2311.5" y1="1158.8965" y2="1158.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="1908.5" y="1153.0875">Server:DiffieHellman instance ready</text><polygon fill="#181818" points="2295.5,1198.4556,2305.5,1202.4556,2295.5,1206.4556,2299.5,1202.4556" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1891.5" x2="2301.5" y1="1202.4556" y2="1202.4556"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="1898.5" y="1196.6466">deriveSharedSecret(publicKeyA, serverNonceHex, clientNonceHex)</text><path d="M2322,1171.8965 L2322,1216.8965 L2736,1216.8965 L2736,1181.8965 L2726,1171.8965 L2322,1171.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2726,1171.8965 L2726,1181.8965 L2736,1181.8965 L2726,1171.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="2328" y="1190.7936">Server computes shared secret s' = (publicKeyA ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="2328" y="1208.4996">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="2880,1242.0146,2890,1246.0146,2880,1250.0146,2884,1246.0146" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2886" y1="1246.0146" y2="1246.0146"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="2324.5" y="1240.2056">hexToUniqueBIGNUM(publicKeyA)</text><polygon fill="#181818" points="2328.5,1303.2796,2318.5,1307.2796,2328.5,1311.2796,2324.5,1307.2796" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2896" y1="1307.2796" y2="1307.2796"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="2334.5" y="1301.4706">UniqueBIGNUM</text><path d="M2907,1259.0146 L2907,1339.0146 L3294,1339.0146 L3294,1269.0146 L3284,1259.0146 L2907,1259.0146 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3284,1259.0146 L3284,1269.0146 L3294,1269.0146 L3284,1259.0146 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="2913" y="1277.9116">Converts s' to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="2913" y="1295.6176">Converts nonces to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="2913" y="1313.3236">Concatenates s' || clientNonce || serverNonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366" x="2913" y="1331.0297">Hashes concatenated data with SHA256 to get symmetric key</text><polygon fill="#181818" points="2880,1364.5447,2890,1368.5447,2880,1372.5447,2884,1368.5447" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2886" y1="1368.5447" y2="1368.5447"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="2324.5" y="1362.7357">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="2328.5,1396.2507,2318.5,1400.2507,2328.5,1404.2507,2324.5,1400.2507" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2896" y1="1400.2507" y2="1400.2507"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="2334.5" y="1394.4417">serverNonceBytes</text><polygon fill="#181818" points="2880,1427.9567,2890,1431.9567,2880,1435.9567,2884,1431.9567" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2886" y1="1431.9567" y2="1431.9567"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="2324.5" y="1426.1477">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="2328.5,1459.6627,2318.5,1463.6627,2328.5,1467.6627,2324.5,1463.6627" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2896" y1="1463.6627" y2="1463.6627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="2334.5" y="1457.8537">clientNonceBytes</text><polygon fill="#181818" points="2880,1491.3687,2890,1495.3687,2880,1499.3687,2884,1495.3687" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2317.5" x2="2886" y1="1495.3687" y2="1495.3687"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="2324.5" y="1489.5597">toHexString(keyMaterial)</text><polygon fill="#181818" points="2328.5,1523.0748,2318.5,1527.0748,2328.5,1531.0748,2324.5,1527.0748" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2322.5" x2="2896" y1="1527.0748" y2="1527.0748"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="2334.5" y="1521.2658">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="1902.5,1554.7808,1892.5,1558.7808,1902.5,1562.7808,1898.5,1558.7808" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1896.5" x2="2311.5" y1="1558.7808" y2="1558.7808"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="1908.5" y="1552.9718">_derivedSymmetricKeyHex (symmetric key)</text><polygon fill="#181818" points="3093,1586.4868,3103,1590.4868,3093,1594.4868,3097,1590.4868" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1891.5" x2="3099" y1="1590.4868" y2="1590.4868"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="479" x="1898.5" y="1584.6778">encryptMessageAes256CbcMode(confirmationMsg, symmetricKey, generatedIv)</text><polygon fill="#181818" points="1902.5,1638.8988,1892.5,1642.8988,1902.5,1646.8988,1898.5,1642.8988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1896.5" x2="3109" y1="1642.8988" y2="1642.8988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1908.5" y="1637.0898">ciphertext, ivHex</text><path d="M1602,1603.4868 L1602,1666.4868 L1876,1666.4868 L1876,1613.4868 L1866,1603.4868 L1602,1603.4868 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1866,1603.4868 L1866,1613.4868 L1876,1613.4868 L1866,1603.4868 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="1608" y="1622.3838">Server constructs JSON response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="1608" y="1640.0898">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="1608" y="1657.7958">encrypted confirmation (ciphertext, ivHex)</text><polygon fill="#181818" points="547.5,1691.3109,537.5,1695.3109,547.5,1699.3109,543.5,1695.3109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="541.5" x2="1885.5" y1="1695.3109" y2="1695.3109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="553.5" y="1689.5019">HTTP 201 OK (ServerHello JSON)</text><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="578.5" y1="1732.3699" y2="1732.3699"/><line style="stroke:#181818;stroke-width:1.0;" x1="578.5" x2="578.5" y1="1732.3699" y2="1745.3699"/><line style="stroke:#181818;stroke-width:1.0;" x1="537.5" x2="578.5" y1="1745.3699" y2="1745.3699"/><polygon fill="#181818" points="547.5,1741.3699,537.5,1745.3699,547.5,1749.3699,543.5,1745.3699" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="543.5" y="1726.5609">Parse ServerHello JSON response</text><path d="M752,1708.3109 L752,1753.3109 L1025,1753.3109 L1025,1718.3109 L1015,1708.3109 L752,1708.3109 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1015,1708.3109 L1015,1718.3109 L1025,1718.3109 L1015,1708.3109 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="758" y="1727.2079">Client extracts sessionId, serverNonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="758" y="1744.9139">groupName, publicKeyB, ciphertext, ivHex</text><polygon fill="#181818" points="1521,1778.4289,1531,1782.4289,1521,1786.4289,1525,1782.4289" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="1527" y1="1782.4289" y2="1782.4289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="543.5" y="1776.6199">hexToBytes(ivHex)</text><polygon fill="#181818" points="547.5,1810.1349,537.5,1814.1349,547.5,1818.1349,543.5,1814.1349" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="541.5" x2="1537" y1="1814.1349" y2="1814.1349"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="553.5" y="1808.3259">iv (vector&lt;uint8_t&gt;)</text><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="578.5" y1="1845.8409" y2="1845.8409"/><line style="stroke:#181818;stroke-width:1.0;" x1="578.5" x2="578.5" y1="1845.8409" y2="1858.8409"/><line style="stroke:#181818;stroke-width:1.0;" x1="537.5" x2="578.5" y1="1858.8409" y2="1858.8409"/><polygon fill="#181818" points="547.5,1854.8409,537.5,1858.8409,547.5,1862.8409,543.5,1858.8409" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="543.5" y="1840.0319">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="940.5,1898.4,950.5,1902.4,940.5,1906.4,944.5,1902.4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="946.5" y1="1902.4" y2="1902.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="543.5" y="1896.591">deriveSharedSecret(publicKeyB, serverNonceHex, clientNonceHex)</text><path d="M967,1871.8409 L967,1916.8409 L1374,1916.8409 L1374,1881.8409 L1364,1871.8409 L967,1871.8409 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1364,1871.8409 L1364,1881.8409 L1374,1881.8409 L1364,1871.8409 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386" x="973" y="1890.738">Client computes shared secret s = (publicKeyB ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="973" y="1908.444">Uses OpenSSL's BN_mod_exp</text><polygon fill="#181818" points="1521,1941.959,1531,1945.959,1521,1949.959,1525,1945.959" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1527" y1="1945.959" y2="1945.959"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="969.5" y="1940.15">hexToUniqueBIGNUM(publicKeyB)</text><polygon fill="#181818" points="973.5,2003.224,963.5,2007.224,973.5,2011.224,969.5,2007.224" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1537" y1="2007.224" y2="2007.224"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="979.5" y="2001.415">UniqueBIGNUM</text><path d="M1548,1958.959 L1548,2038.959 L1847,2038.959 L1847,1968.959 L1837,1958.959 L1548,1958.959 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1837,1958.959 L1837,1968.959 L1847,1968.959 L1837,1958.959 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1554" y="1977.856">Converts s to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="1554" y="1995.562">Converts nonces to raw bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="1554" y="2013.268">Concatenates s || clientNonce || serverNonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="1554" y="2030.9741">Hashes concatenated data with SHA256</text><polygon fill="#181818" points="1521,2064.4891,1531,2068.4891,1521,2072.4891,1525,2068.4891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1527" y1="2068.4891" y2="2068.4891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="969.5" y="2062.6801">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="973.5,2096.1951,963.5,2100.1951,973.5,2104.1951,969.5,2100.1951" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1537" y1="2100.1951" y2="2100.1951"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="979.5" y="2094.3861">serverNonceBytes</text><polygon fill="#181818" points="1521,2127.9011,1531,2131.9011,1521,2135.9011,1525,2131.9011" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1527" y1="2131.9011" y2="2131.9011"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="969.5" y="2126.0921">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="973.5,2159.6071,963.5,2163.6071,973.5,2167.6071,969.5,2163.6071" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1537" y1="2163.6071" y2="2163.6071"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="979.5" y="2157.7981">clientNonceBytes</text><polygon fill="#181818" points="1521,2191.3131,1531,2195.3131,1521,2199.3131,1525,2195.3131" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="962.5" x2="1527" y1="2195.3131" y2="2195.3131"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="969.5" y="2189.5041">toHexString(keyMaterial)</text><polygon fill="#181818" points="973.5,2223.0192,963.5,2227.0192,973.5,2231.0192,969.5,2227.0192" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="967.5" x2="1537" y1="2227.0192" y2="2227.0192"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="979.5" y="2221.2102">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="547.5,2254.7252,537.5,2258.7252,547.5,2262.7252,543.5,2258.7252" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="541.5" x2="956.5" y1="2258.7252" y2="2258.7252"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="553.5" y="2252.9162">_derivedSymmetricKeyHex</text><line style="stroke:#181818;stroke-width:1.0;" x1="536.5" x2="583.5" y1="2285.4312" y2="2285.4312"/><line style="stroke:#181818;stroke-width:1.0;" x1="583.5" x2="583.5" y1="2285.4312" y2="2298.4312"/><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="583.5" y1="2298.4312" y2="2298.4312"/><polygon fill="#181818" points="552.5,2294.4312,542.5,2298.4312,552.5,2302.4312,548.5,2298.4312" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="548.5" y="2279.6222">confirmationServerResponse(...)</text><polygon fill="#181818" points="1730,2331.1372,1740,2335.1372,1730,2339.1372,1734,2335.1372" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="541.5" x2="1736" y1="2335.1372" y2="2335.1372"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="548.5" y="2329.3282">decryptMessageAes256CbcMode(ciphertext, derivedKey, iv)</text><polygon fill="#181818" points="552.5,2362.8432,542.5,2366.8432,552.5,2370.8432,548.5,2366.8432" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="546.5" x2="1746" y1="2366.8432" y2="2366.8432"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="558.5" y="2361.0342">decryptedPlaintext</text><line style="stroke:#181818;stroke-width:1.0;" x1="541.5" x2="583.5" y1="2412.7553" y2="2412.7553"/><line style="stroke:#181818;stroke-width:1.0;" x1="583.5" x2="583.5" y1="2412.7553" y2="2425.7553"/><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="583.5" y1="2425.7553" y2="2425.7553"/><polygon fill="#181818" points="552.5,2421.7553,542.5,2425.7553,552.5,2429.7553,548.5,2425.7553" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="548.5" y="2406.9463">Parse decryptedPlaintext (JSON)</text><path d="M752,2379.8432 L752,2442.8432 L995,2442.8432 L995,2389.8432 L985,2379.8432 L752,2379.8432 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M985,2379.8432 L985,2389.8432 L995,2389.8432 L985,2379.8432 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="758" y="2398.7402">Compares extracted fields</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="758" y="2416.4463">(sessionId, clientId, nonces, message)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="758" y="2434.1523">with expected values.</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="541.5" x2="583.5" y1="2476.6673" y2="2476.6673"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="583.5" x2="583.5" y1="2476.6673" y2="2489.6673"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="536.5" x2="583.5" y1="2489.6673" y2="2489.6673"/><polygon fill="#181818" points="546.5,2485.6673,536.5,2489.6673,546.5,2493.6673,542.5,2489.6673" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="548.5" y="2470.8583">(bool validationResult, string decryptedMessage)</text><path d="M10,2499.6673 L73,2499.6673 L73,2509.3733 L63,2519.3733 L10,2519.3733 L10,2499.6673 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="100.0999" style="stroke:#000000;stroke-width:1.5;" width="572" x="10" y="2499.6673"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="25" y="2514.5643">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="139" x="88" y="2513.4262">[validationResult == true]</text><polygon fill="#181818" points="101.5,2539.0793,91.5,2543.0793,101.5,2547.0793,97.5,2543.0793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="95.5" x2="525.5" y1="2543.0793" y2="2543.0793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407" x="107.5" y="2537.2703">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="582" y1="2552.0793" y2="2552.0793"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141" x="15" y="2563.8382">[validationResult == false]</text><polygon fill="#181818" points="101.5,2587.7672,91.5,2591.7672,101.5,2595.7672,97.5,2591.7672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="95.5" x2="525.5" y1="2591.7672" y2="2591.7672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="107.5" y="2585.9582">Logs "Diffie Hellman key exchange failed"</text><line style="stroke:#181818;stroke-width:1.0;" x1="90.5" x2="132.5" y1="2635.4732" y2="2635.4732"/><line style="stroke:#181818;stroke-width:1.0;" x1="132.5" x2="132.5" y1="2635.4732" y2="2648.4732"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.5" x2="132.5" y1="2648.4732" y2="2648.4732"/><polygon fill="#181818" points="95.5,2644.4732,85.5,2648.4732,95.5,2652.4732,91.5,2648.4732" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="97.5" y="2629.6642">Program ends</text><!--SRC=[lLbjRzis4FxkNq5u62m3JhPqQ3SKRO4eSUQiSMBKoOTzgK5Bj2nCRoCbrndwutSKzK9AfApOsGB4y0llUFVSyUxXQHtlqV0gy4cKeccqysaSXV1-Y7wuyxrj-YS9WlZR0C5VWcdgEtw2OUKmn7w4B9f5GlHYF4IOeJbysrvRQBViU2sMYIzC2zzV-vkDJsQmSuWZIU1wPXQPBJ358RkBiKke8YE-CahE2MFO8zDzIh6J-d5qWnq_yDDdISbyUcEKdqOEVKwuu5FQb9i-3KZaedMy7mpM7ESbeJj2TJZRGKRQUnJhhSl5hK1EV04VJMiru8aVTE2L8ctmIXaJU8LaDtXYaHQyGbuFdlXH1eyht-6KY0GRy5Tqzgb06Rr7LvJmNyLdQmY9DfmWbwmpxoR0thYMBp9lK4XMEgvdjHO5GSkifK2qKY0f4x21oW3UN6zpU4bAABCyaigVR_o0HF3-BdOmXy4QZtEbhQsaGF2_A8RVA4-SwglQ5gG6585RBaD3kd5-UVlctPb7uomvk_Xrg8Wc20FQ7jhGE4GRCAlwbKU1xwTuMwW-Kn7yGjACHgmq87SHXJZ9HLrYyig88wZqI4Geo2neBlgPF5i6Y7g2ap72q4D2ekNoRiIGVR-Yu3b_yGXAOzWmHICyKaId4SieY5sW3mZ3Fy2dXqVl21m1y6HBze_nK-J_dH7xzlVxfxcLZ2kXXZVbeQdrSHqDj6LTrUeMogKg3VpzWC_MWU-SZhiJXqcM0eYNw2EolAzuZ7v4YRBogHMQC7PNP9-y76o1ocCy8tjhbPGkd4DmooDsBEe23mJQm1CBWZe-3llQSgMIQLeWyYEMuiWX-Kb-7cWZsQg9hgm2h9tkdItFSIkXiPlbrNeHqxHT7AMOLVgcJr96NF6Q7NiK9rlVkO_1C2lYhql_7wBD4IZbjL9GfNZiv6zoDH0iFLoWO51bM40swQ2LN00H1QyO-cFvS8-6Gkjgo-bBNUY- -UcssF3MdSXRJwerUNcyX-8rGLNUN0wKv6j0L3Lby6Rs-BX0YuVb8_hfhnfpP8dLF1fnRc43fxglLtRKMXjRG6bb9J2rmaEdiA0IHBHgTWY5l2LKxekk81P24aBLOUbv-r1ssVx23DAWKsHHhR_891aRbhzNagcHK9MkBcDxqG63cL91hBMB0gMogXFeWN7h1aqua1EDt3Y6DXZf0xB2ZANG_5EdF78ZDcx9jWgwZ9b4CgIuT98COyHLij4LdIxIqI_c_I7lHKRM8wqAcPIi6wIa4rwzupr8Yi5xkMsg-ilsAK6h9It6g3LLQyBwie0soCnhnxCYEROWEUisoUbFTeuEOZ_oynhHbCYGtI139yMqxM6ZqEjkkqsUr9aq1yi_r0f_HvPRJ8cx90u5yEg6E6bqcac3nlJj3XrPrSmebbi2-t9J41ln19Cwz5UKLCNArcTTluphhCWzoaLbKkS9QoR1o-k5Dg_wWdiLHo01D0XmX39ByJUqVWQKpGjpVi8EBeO-3HqxZzS8VVykfmN_A6LDItg6sHRad5g9YroSOi5QbxFBDs_VbJs1FOVG-2WSFM2P9uRFvhvOQZw_JkmadNOBiCFnws6rwTITOhMaypMjJdavNaBC8i-2eCr11VLny3eshqIrSfTbNi01b0dmmK9iBBG6pSXIKd0ywDMXJVS28kQ0nJZnaZ18zQkrCuzTOi5vsFWqpFdld7cJElV1aadLsTtRtKat1vXCRk6Wm_reWlnTxyj3-qQgr6xrLWfiBO6lrBEPdswep0pyuzSnwT18Dr1xqZZbEM1G8MHuaDNoOcoufKcHa2_Z-VNrpSyNwE4piiIQvfsr1KTrQsqE3QgxQbEH2eIcJ1VorMNL04_ddTsU669gkiQtPdMYn4Wm6gOxkb4HwF1toDeH9utfXyoFqjzMwQVnm3WcCY6u17cEO0x0DMy7CETPASETUN7tqGwrksYCtO_6d3pnQr0NXRdO2dEv_4-7WXrinVw_Hh47iQkOYPbhz2ObAY5v0H_fmqMEnB-RRXm3lf5cT0UWXvK7IVqBh3JIYkEiF4WdZh7n48qm3hZrm-mkTGSUHoWrKEvnefTyAHg8TNv-hYrIpLQYJh9Tqi4tfAPHs9yJ3Nzdn5RY5_ePTx4VSHS1ZEcvRZEaChimTjIsGcJLBRgpl8Jm81QETj5RuLn38mbSjMvOKiEj1yMYsanGA60RjsaCL6MIwznXU9xDphkU8Qe8MUiu3hYOx-PXXW1d0KI0vHbU-pkNzsvX9v33GThIX3v-H435Y0RQ_Cd9UtGNUp3j50C5L4uKu6I1KyKGdsMEGuWxp4UTbKKb789R110StTuR7B2JDjzW6AgwmvB133I-bu-02fqBoYVi8L_DvENvC_H_0G00]--></g></svg>