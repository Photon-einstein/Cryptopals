<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="4564px" preserveAspectRatio="none" style="width:3768px;height:4564px;background:#FFFFFF;" version="1.1" viewBox="0 0 3768 4564" width="3768px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="4558.223" style="stroke:#181818;stroke-width:0.25;" width="1182" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="64" x="567" y="9.9485">Client Environment</text><rect fill="#F08080" height="4558.223" style="stroke:#181818;stroke-width:0.25;" width="1535.5" x="1191" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="73.5" x="1922" y="9.9485">Attacker Environment</text><rect fill="#ADD8E6" height="4558.223" style="stroke:#181818;stroke-width:0.25;" width="935" x="2830" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="65.5" x="3264.75" y="9.9485">Server Environment</text><rect fill="#FFFFFF" height="4494.302" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="2798.9723" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="232.5891" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2578.2792"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="2890.2713"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="671.75" y="2413.2491"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="95.299"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="146.858"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="184.211"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2473.2346"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2542.5732"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="933.25" y="111.152"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="202.564"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="2510.8671"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="250.1231"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2596.6322"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2906.1243"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2937.8303"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2991.8893"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4347.6589"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4401.7179"/><rect fill="#FFFFFF" height="1894.8309" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="318.3881"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1209" y="464.7122"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="3051.3013"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1663" y="505.4182"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1884" y="521.2712"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1886.5" y="572.8302"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1886.5" y="610.1832"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1884" y="770.3603"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="2133.5" y="1032.5084"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="2136" y="1084.0675"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2136" y="1121.4205"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2318" y="537.1242"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2318" y="1048.3614"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="429.0062"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="643.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="808.5663"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="840.2723"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="916.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="1139.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="691.0953"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="722.8013"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="1187.3325"/><rect fill="#FFFFFF" height="39.4855" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="2134.248"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3218.1254"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3272.1844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3306.8905"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3360.9495"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3978.5988"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="4032.6578"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="4067.3638"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="4121.4228"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2677.25" y="964.2434"/><rect fill="#FFFFFF" height="931.0624" style="stroke:#181818;stroke-width:0.5;" width="5" x="2677.25" y="1016.6554"/><rect fill="#FFFFFF" height="670.3408" style="stroke:#181818;stroke-width:0.5;" width="5" x="2852.25" y="1255.5975"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2854.75" y="1433.1276"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2854.75" y="1818.0408"/><rect fill="#FFFFFF" height="410.7662" style="stroke:#181818;stroke-width:0.5;" width="5" x="2852.25" y="3423.3615"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="3241.75" y="1473.8336"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="3402.25" y="1489.6867"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3404.75" y="1541.2457"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3404.75" y="1578.5987"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="3402.25" y="1744.7023"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3402.25" y="1782.3348"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3503.25" y="1505.5397"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3611" y="1397.4216"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3611" y="1611.9517"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="1659.5107"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="1691.2167"/><rect fill="#FFFFFF" height="30.6325" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="1858.7468"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3590.1856"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3644.2446"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3698.3036"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3752.3627"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="2821.8683"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="1188" y="3170.5664"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2827" y="3542.6266"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="1188" y="3863.9807"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="4233.0409"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="4425.071"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="42.5" x2="42.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="674" x2="674" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="751" x2="751" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="935.5" x2="935.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1041.5" x2="1041.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1146" x2="1146" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1209" x2="1209" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1665.5" x2="1665.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1886.5" x2="1886.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2136" x2="2136" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2320.5" x2="2320.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2431.5" x2="2431.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2541.5" x2="2541.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2679.5" x2="2679.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2854.5" x2="2854.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3244" x2="3244" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3404.5" x2="3404.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3505.5" x2="3505.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3613.5" x2="3613.5" y1="30.887" y2="4542.689"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3720" x2="3720" y1="30.887" y2="4542.689"/><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="24.836">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="4553.172">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="24.836">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="4553.172">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="69.5" x="639.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="62.5" x="643" y="24.836">Client:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="69.5" x="639.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="62.5" x="643" y="4553.172">Client:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="714" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="717.5" y="24.836">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="714" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="717.5" y="4553.172">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="892.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="896" y="24.836">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="892.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="896" y="4553.172">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="984" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="987.5" y="24.836">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="984" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="987.5" y="4553.172">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="1104" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="1107.5" y="24.836">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="1104" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="1107.5" y="4553.172">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="1193" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="1196.5" y="24.836">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="1193" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="1196.5" y="4553.172">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1615.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1619" y="24.836">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1615.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1619" y="4553.172">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1829.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1833" y="24.836">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1829.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1833" y="4553.172">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="2078" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="2081.5" y="24.836">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="2078" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="2081.5" y="4553.172">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2274.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2278" y="24.836">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2274.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2278" y="4553.172">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2371.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2375" y="24.836">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2371.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2375" y="4553.172">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2497" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2500.5" y="24.836">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2497" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2500.5" y="4553.172">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2635" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2638.5" y="24.836">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2635" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2638.5" y="4553.172">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2832" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2835.5" y="24.836">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2832" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2835.5" y="4553.172">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="71.5" x="3208.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="64.5" x="3212" y="24.836">Server:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="71.5" x="3208.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="64.5" x="3212" y="4553.172">Server:SessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="3366.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="3370" y="24.836">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="3366.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="3370" y="4553.172">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="3461.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="3465" y="24.836">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="3461.5" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="3465" y="4553.172">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3555" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3558.5" y="24.836">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3555" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3558.5" y="4553.172">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3677" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3680.5" y="24.836">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3677" y="4542.189"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3680.5" y="4553.172">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="4494.302" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="2798.9723" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="232.5891" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2578.2792"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="2890.2713"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="671.75" y="2413.2491"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="95.299"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="146.858"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="751.25" y="184.211"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2473.2346"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="748.75" y="2542.5732"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="933.25" y="111.152"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="202.564"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1039" y="2510.8671"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="250.1231"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2596.6322"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2906.1243"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2937.8303"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="2991.8893"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4347.6589"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1143.5" y="4401.7179"/><rect fill="#FFFFFF" height="1894.8309" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="318.3881"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1209" y="464.7122"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="1206.5" y="3051.3013"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1663" y="505.4182"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1884" y="521.2712"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1886.5" y="572.8302"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1886.5" y="610.1832"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1884" y="770.3603"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="2133.5" y="1032.5084"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="2136" y="1084.0675"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2136" y="1121.4205"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2318" y="537.1242"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2318" y="1048.3614"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="429.0062"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="643.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="808.5663"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="840.2723"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="916.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2429.25" y="1139.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="691.0953"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="722.8013"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="1187.3325"/><rect fill="#FFFFFF" height="39.4855" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="2134.248"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3218.1254"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3272.1844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3306.8905"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3360.9495"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="3978.5988"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="4032.6578"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="4067.3638"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2539.25" y="4121.4228"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2677.25" y="964.2434"/><rect fill="#FFFFFF" height="931.0624" style="stroke:#181818;stroke-width:0.5;" width="5" x="2677.25" y="1016.6554"/><rect fill="#FFFFFF" height="670.3408" style="stroke:#181818;stroke-width:0.5;" width="5" x="2852.25" y="1255.5975"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2854.75" y="1433.1276"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2854.75" y="1818.0408"/><rect fill="#FFFFFF" height="410.7662" style="stroke:#181818;stroke-width:0.5;" width="5" x="2852.25" y="3423.3615"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="3241.75" y="1473.8336"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="3402.25" y="1489.6867"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3404.75" y="1541.2457"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="3404.75" y="1578.5987"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="3402.25" y="1744.7023"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3402.25" y="1782.3348"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3503.25" y="1505.5397"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3611" y="1397.4216"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3611" y="1611.9517"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="1659.5107"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="1691.2167"/><rect fill="#FFFFFF" height="30.6325" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="1858.7468"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3590.1856"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3644.2446"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3698.3036"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3717.5" y="3752.3627"/><polygon fill="#181818" points="254.75,45.74,259.75,47.74,254.75,49.74,256.75,47.74" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="47.74" y2="47.74"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="48.75" y="44.8355">Create Client("Bob", debugFlag, groupNameDH)</text><polygon fill="#181818" points="50.75,61.593,45.75,63.593,50.75,65.593,48.75,63.593" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="63.593" y2="63.593"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="31" x="53.75" y="60.6885">new Client</text><polygon fill="#181818" points="254.75,77.446,259.75,79.446,254.75,81.446,256.75,79.446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="79.446" y2="79.446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="130" x="48.75" y="76.5415">diffieHellmanKeyExchange(productionPort)</text><polygon fill="#181818" points="742.75,93.299,747.75,95.299,742.75,97.299,744.75,95.299" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="95.299" y2="95.299"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="215.5" x="269.25" y="92.3945">Create DiffieHellman(_debugFlag, _parameterInjection, _groupNameDH)</text><polygon fill="#181818" points="927.25,109.152,932.25,111.152,927.25,113.152,929.25,111.152" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="753.75" x2="930.25" y1="111.152" y2="111.152"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="757.25" y="108.2475">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="759.25,125.005,754.25,127.005,759.25,129.005,757.25,127.005" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="756.25" x2="935.25" y1="127.005" y2="127.005"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="762.25" y="124.1005">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="756.25" x2="777.25" y1="142.858" y2="142.858"/><line style="stroke:#181818;stroke-width:0.5;" x1="777.25" x2="777.25" y1="142.858" y2="149.358"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.75" x2="777.25" y1="149.358" y2="149.358"/><polygon fill="#181818" points="761.75,147.358,756.75,149.358,761.75,151.358,759.75,149.358" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="759.75" y="139.9535">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="753.75" x2="777.25" y1="177.711" y2="177.711"/><line style="stroke:#181818;stroke-width:0.5;" x1="777.25" x2="777.25" y1="177.711" y2="184.211"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.75" x2="777.25" y1="184.211" y2="184.211"/><polygon fill="#181818" points="761.75,182.211,756.75,184.211,761.75,186.211,759.75,184.211" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="759.75" y="174.8065">generatePublicKey()</text><polygon fill="#181818" points="1033,200.564,1038,202.564,1033,204.564,1035,202.564" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="756.25" x2="1036" y1="202.564" y2="202.564"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="759.75" y="199.6595">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="759.25,216.417,754.25,218.417,759.25,220.417,757.25,218.417" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="756.25" x2="1041" y1="218.417" y2="218.417"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="762.25" y="215.5125">Public Key A (hex)</text><polygon fill="#181818" points="271.25,232.2701,266.25,234.2701,271.25,236.2701,269.25,234.2701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="234.2701" y2="234.2701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="274.25" y="231.3656">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="1137.5,248.1231,1142.5,250.1231,1137.5,252.1231,1139.5,250.1231" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="250.1231" y2="250.1231"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="247.2186">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="271.25,263.9761,266.25,265.9761,271.25,267.9761,269.25,265.9761" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="265.9761" y2="265.9761"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47.5" x="274.25" y="263.0716">clientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="288.9321" y2="288.9321"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="288.9321" y2="295.4321"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="295.4321" y2="295.4321"/><polygon fill="#181818" points="271.25,293.4321,266.25,295.4321,271.25,297.4321,269.25,295.4321" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="269.25" y="286.0276">built "keyExchange" message</text><path d="M140.5,272.4761 L140.5,303.9761 L258,303.9761 L258,277.4761 L253,272.4761 L140.5,272.4761 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,272.4761 L253,277.4761 L258,277.4761 L253,272.4761 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107" x="143.5" y="281.9246">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="76.5" x="143.5" y="290.7776">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="72.5" x="143.5" y="299.6306">groupName, publicKeyA</text><polygon fill="#181818" points="1200.5,316.3881,1205.5,318.3881,1200.5,320.3881,1202.5,318.3881" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1203.5" y1="318.3881" y2="318.3881"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="269.25" y="315.4836">HTTP POST /keyExchange (ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="334.2411" y2="334.2411"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="334.2411" y2="340.7411"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="340.7411" y2="340.7411"/><polygon fill="#181818" points="1217,338.7411,1212,340.7411,1217,342.7411,1215,340.7411" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1215" y="331.3366">extract client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="356.5941" y2="356.5941"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="356.5941" y2="363.0941"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="363.0941" y2="363.0941"/><polygon fill="#181818" points="1217,361.0941,1212,363.0941,1217,365.0941,1215,363.0941" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="137.5" x="1215" y="353.6896">extract client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="378.9471" y2="378.9471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="378.9471" y2="385.4471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="385.4471" y2="385.4471"/><polygon fill="#181818" points="1217,383.4471,1212,385.4471,1217,387.4471,1215,385.4471" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156.5" x="1215" y="376.0426">extract client's group name as extractedGroupName</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="403.9766" y2="403.9766"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="403.9766" y2="410.4766"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="410.4766" y2="410.4766"/><polygon fill="#181818" points="1217,408.4766,1212,410.4766,1217,412.4766,1215,410.4766" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145.5" x="1215" y="401.0721">extract client's public key as extractedPublicKeyA</text><path d="M1366.5,391.9471 L1366.5,414.4471 L1571.5,414.4471 L1571.5,396.9471 L1566.5,391.9471 L1366.5,391.9471 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1566.5,391.9471 L1566.5,396.9471 L1571.5,396.9471 L1566.5,391.9471 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89.5" x="1369.5" y="401.3956">Mallory intercepts ClientHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="194.5" x="1369.5" y="410.2486">He extracts client's Id, client's Nonce, group name and public Key.</text><polygon fill="#181818" points="2423.25,427.0062,2428.25,429.0062,2423.25,431.0062,2425.25,429.0062" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2426.25" y1="429.0062" y2="429.0062"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132.5" x="1215" y="426.1017">hexToUniqueBIGNUM(extractedPublicKeyA)</text><polygon fill="#181818" points="1217,442.8592,1212,444.8592,1217,446.8592,1215,444.8592" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2431.25" y1="444.8592" y2="444.8592"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="1220" y="441.9547">peerPublicKey in UniqueBIGNUM format</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1235" y1="458.2122" y2="458.2122"/><line style="stroke:#181818;stroke-width:0.5;" x1="1235" x2="1235" y1="458.2122" y2="464.7122"/><line style="stroke:#181818;stroke-width:0.5;" x1="1214.5" x2="1235" y1="464.7122" y2="464.7122"/><polygon fill="#181818" points="1219.5,462.7122,1214.5,464.7122,1219.5,466.7122,1217.5,464.7122" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="1217.5" y="455.3077">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1235" y1="485.5652" y2="485.5652"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1235" x2="1235" y1="485.5652" y2="492.0652"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1211.5" x2="1235" y1="492.0652" y2="492.0652"/><polygon fill="#181818" points="1216.5,490.0652,1211.5,492.0652,1216.5,494.0652,1214.5,492.0652" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="1217.5" y="482.6607">sessionId</text><polygon fill="#181818" points="1657,503.4182,1662,505.4182,1657,507.4182,1659,505.4182" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1660" y1="505.4182" y2="505.4182"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="442" x="1215" y="502.5137">Create MallorySessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, extractedGroupName, _parameterInjection)</text><polygon fill="#181818" points="1878,519.2712,1883,521.2712,1878,523.2712,1880,521.2712" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1668" x2="1881" y1="521.2712" y2="521.2712"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="206.5" x="1671.5" y="518.3667">Create DiffieHellman(debugFlag, parameterInjection, groupNameDH)</text><polygon fill="#181818" points="2312,535.1242,2317,537.1242,2312,539.1242,2314,537.1242" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="2315" y1="537.1242" y2="537.1242"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1892.5" y="534.2197">loadDhParameters()</text><polygon fill="#181818" points="1894.5,550.9772,1889.5,552.9772,1894.5,554.9772,1892.5,552.9772" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1891.5" x2="2320" y1="552.9772" y2="552.9772"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1897.5" y="550.0727">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1891.5" x2="1912.5" y1="568.8302" y2="568.8302"/><line style="stroke:#181818;stroke-width:0.5;" x1="1912.5" x2="1912.5" y1="568.8302" y2="575.3302"/><line style="stroke:#181818;stroke-width:0.5;" x1="1892" x2="1912.5" y1="575.3302" y2="575.3302"/><polygon fill="#181818" points="1897,573.3302,1892,575.3302,1897,577.3302,1895,575.3302" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1895" y="565.9257">generatePrivateKey()</text><path d="M1964,561.2272 L1964,574.7272 L2079.5,574.7272 L2079.5,566.2272 L2074.5,561.2272 L1964,561.2272 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2074.5,561.2272 L2074.5,566.2272 L2079.5,566.2272 L2074.5,561.2272 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="1967" y="570.6757">Mallory generates private key 'm_s'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1891.5" x2="1912.5" y1="606.1832" y2="606.1832"/><line style="stroke:#181818;stroke-width:0.5;" x1="1912.5" x2="1912.5" y1="606.1832" y2="612.6832"/><line style="stroke:#181818;stroke-width:0.5;" x1="1892" x2="1912.5" y1="612.6832" y2="612.6832"/><polygon fill="#181818" points="1897,610.6832,1892,612.6832,1897,614.6832,1895,612.6832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1895" y="603.2787">generatePublicKey()</text><path d="M1961,598.5802 L1961,612.0802 L2110.5,612.0802 L2110.5,603.5802 L2105.5,598.5802 L1961,598.5802 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2105.5,598.5802 L2105.5,603.5802 L2110.5,603.5802 L2105.5,598.5802 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139" x="1964" y="608.0287">Mallory computes public key M_S = (g^m_) % p</text><polygon fill="#181818" points="2423.25,641.5362,2428.25,643.5362,2423.25,645.5362,2425.25,643.5362" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="2426.25" y1="643.5362" y2="643.5362"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1892.5" y="640.6317">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1894.5,657.3892,1889.5,659.3892,1894.5,661.3892,1892.5,659.3892" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1891.5" x2="2431.25" y1="659.3892" y2="659.3892"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="1897.5" y="656.4847">Public Key M_S (hex)</text><polygon fill="#181818" points="1673.5,673.2423,1668.5,675.2423,1673.5,677.2423,1671.5,675.2423" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1670.5" x2="1886" y1="675.2423" y2="675.2423"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1676.5" y="672.3378">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="2533.25,689.0953,2538.25,691.0953,2533.25,693.0953,2535.25,691.0953" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1668" x2="2536.25" y1="691.0953" y2="691.0953"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="1671.5" y="688.1908">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="1673.5,704.9483,1668.5,706.9483,1673.5,708.9483,1671.5,706.9483" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1670.5" x2="2541.25" y1="706.9483" y2="706.9483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109.5" x="1676.5" y="704.0438">result stored in _serverNonceHexAM</text><polygon fill="#181818" points="2533.25,720.8013,2538.25,722.8013,2533.25,724.8013,2535.25,722.8013" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1668" x2="2536.25" y1="722.8013" y2="722.8013"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1671.5" y="719.8968">generateRandomIV(ivLength)</text><polygon fill="#181818" points="1673.5,736.6543,1668.5,738.6543,1673.5,740.6543,1671.5,738.6543" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1670.5" x2="2541.25" y1="738.6543" y2="738.6543"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="1676.5" y="735.7498">result stored in _ivAM</text><polygon fill="#181818" points="1217,752.5073,1212,754.5073,1217,756.5073,1215,754.5073" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1665" y1="754.5073" y2="754.5073"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="228" x="1220" y="751.6028">returns mallorySessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="1878,768.3603,1883,770.3603,1878,772.3603,1880,770.3603" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1881" y1="770.3603" y2="770.3603"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="440" x="1215" y="767.4558">deriveSharedSecret(extractedPublicKeyA, _diffieHellmanMap[sessionId]-&gt;_serverNonceHexAM, _diffieHellmanMap[sessionId]-&gt;_clientNonceHexAM)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="1910" y1="786.2133" y2="786.2133"/><line style="stroke:#181818;stroke-width:0.5;" x1="1910" x2="1910" y1="786.2133" y2="792.7133"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889.5" x2="1910" y1="792.7133" y2="792.7133"/><polygon fill="#181818" points="1894.5,790.7133,1889.5,792.7133,1894.5,794.7133,1892.5,792.7133" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1892.5" y="783.3088">_sharedSecret = (peerPublicKey ^ _privateKey) % _p</text><polygon fill="#181818" points="2423.25,806.5663,2428.25,808.5663,2423.25,810.5663,2425.25,808.5663" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="2426.25" y1="808.5663" y2="808.5663"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1892.5" y="805.6618">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="1894.5,822.4193,1889.5,824.4193,1894.5,826.4193,1892.5,824.4193" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1891.5" x2="2431.25" y1="824.4193" y2="824.4193"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="1897.5" y="821.5148">serverNonceBytes</text><polygon fill="#181818" points="2423.25,838.2723,2428.25,840.2723,2423.25,842.2723,2425.25,840.2723" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="2426.25" y1="840.2723" y2="840.2723"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="86.5" x="1892.5" y="837.3678">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="1894.5,854.1253,1889.5,856.1253,1894.5,858.1253,1892.5,856.1253" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1891.5" x2="2431.25" y1="856.1253" y2="856.1253"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52" x="1897.5" y="853.2208">clientNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="1910" y1="871.9784" y2="871.9784"/><line style="stroke:#181818;stroke-width:0.5;" x1="1910" x2="1910" y1="871.9784" y2="878.4784"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889.5" x2="1910" y1="878.4784" y2="878.4784"/><polygon fill="#181818" points="1894.5,876.4784,1889.5,878.4784,1894.5,880.4784,1892.5,878.4784" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="237.5" x="1892.5" y="869.0739">dataToHash = sharedSecretRawBytes || clientNonceBytes || serverNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="1910" y1="894.3314" y2="894.3314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1910" x2="1910" y1="894.3314" y2="900.8314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889.5" x2="1910" y1="900.8314" y2="900.8314"/><polygon fill="#181818" points="1894.5,898.8314,1889.5,900.8314,1894.5,902.8314,1892.5,900.8314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138.5" x="1892.5" y="891.4269">_derivedSymmetricKey = SHA256(dataToHash)</text><polygon fill="#181818" points="2423.25,914.6844,2428.25,916.6844,2423.25,918.6844,2425.25,916.6844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1889" x2="2426.25" y1="916.6844" y2="916.6844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109" x="1892.5" y="913.7799">toHexString(_derivedSymmetricKey)</text><polygon fill="#181818" points="1894.5,930.5374,1889.5,932.5374,1894.5,934.5374,1892.5,932.5374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1891.5" x2="2431.25" y1="932.5374" y2="932.5374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127" x="1897.5" y="929.6329">result stored in _derivedSymmetricKeyHex</text><polygon fill="#181818" points="1217,946.3904,1212,948.3904,1217,950.3904,1215,948.3904" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="1886" y1="948.3904" y2="948.3904"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115" x="1220" y="945.4859">result stored in _derivedSymmetricKey</text><polygon fill="#181818" points="2671.25,962.2434,2676.25,964.2434,2671.25,966.2434,2673.25,964.2434" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2674.25" y1="964.2434" y2="964.2434"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="333" x="1215" y="961.3389">generate fake Client(_diffieHellmanMap[sessionId]-&gt;_clientIdAM, _debugFlag, groupName, _parameterInjection)</text><polygon fill="#181818" points="1217,988.4494,1212,990.4494,1217,992.4494,1215,990.4494" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2679.25" y1="990.4494" y2="990.4494"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142" x="1220" y="987.5449">new client, to act as a fake one to the real server</text><path d="M1018,970.7434 L1018,1002.2434 L1204,1002.2434 L1204,975.7434 L1199,970.7434 L1018,970.7434 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,970.7434 L1199,975.7434 L1204,975.7434 L1199,970.7434 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="1021" y="980.1919">Mallory constructs her own ClientHello to Server</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="1021" y="989.0449">with Client's Id, malloryNonceToServer,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="175.5" x="1021" y="997.8979">groupName, publicKeyM_S (Mallory's public key for Server)</text><polygon fill="#181818" points="2671.25,1014.6554,2676.25,1016.6554,2671.25,1018.6554,2673.25,1016.6554" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2674.25" y1="1016.6554" y2="1016.6554"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168" x="1215" y="1013.7509">diffieHellmanKeyExchange(const int portServerNumber)</text><polygon fill="#181818" points="2144,1030.5084,2139,1032.5084,2144,1034.5084,2142,1032.5084" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2141" x2="2676.75" y1="1032.5084" y2="1032.5084"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="215.5" x="2147" y="1029.6039">Create DiffieHellman(_debugFlag, _parameterInjection, _groupNameDH)</text><polygon fill="#181818" points="2312,1046.3614,2317,1048.3614,2312,1050.3614,2314,1048.3614" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2138.5" x2="2315" y1="1048.3614" y2="1048.3614"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="2142" y="1045.4569">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="2144,1062.2145,2139,1064.2145,2144,1066.2145,2142,1064.2145" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2141" x2="2320" y1="1064.2145" y2="1064.2145"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="2147" y="1061.31">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="2141" x2="2162" y1="1080.0675" y2="1080.0675"/><line style="stroke:#181818;stroke-width:0.5;" x1="2162" x2="2162" y1="1080.0675" y2="1086.5675"/><line style="stroke:#181818;stroke-width:0.5;" x1="2141.5" x2="2162" y1="1086.5675" y2="1086.5675"/><polygon fill="#181818" points="2146.5,1084.5675,2141.5,1086.5675,2146.5,1088.5675,2144.5,1086.5675" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="2144.5" y="1077.163">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="2138.5" x2="2162" y1="1114.9205" y2="1114.9205"/><line style="stroke:#181818;stroke-width:0.5;" x1="2162" x2="2162" y1="1114.9205" y2="1121.4205"/><line style="stroke:#181818;stroke-width:0.5;" x1="2141.5" x2="2162" y1="1121.4205" y2="1121.4205"/><polygon fill="#181818" points="2146.5,1119.4205,2141.5,1121.4205,2146.5,1123.4205,2144.5,1121.4205" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2144.5" y="1112.016">generatePublicKey()</text><polygon fill="#181818" points="2423.25,1137.7735,2428.25,1139.7735,2423.25,1141.7735,2425.25,1139.7735" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2141" x2="2426.25" y1="1139.7735" y2="1139.7735"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="2144.5" y="1136.869">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2144,1153.6265,2139,1155.6265,2144,1157.6265,2142,1155.6265" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2141" x2="2431.25" y1="1155.6265" y2="1155.6265"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="2147" y="1152.722">Public Key M_S (hex)</text><polygon fill="#181818" points="2671.25,1169.4795,2676.25,1171.4795,2671.25,1173.4795,2673.25,1171.4795" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2136" x2="2674.25" y1="1171.4795" y2="1171.4795"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="2139.5" y="1168.575">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="2549.75,1185.3325,2544.75,1187.3325,2549.75,1189.3325,2547.75,1187.3325" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2546.75" x2="2676.75" y1="1187.3325" y2="1187.3325"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="2552.75" y="1184.428">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="2671.25,1201.1855,2676.25,1203.1855,2671.25,1205.1855,2673.25,1203.1855" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2541.75" x2="2674.25" y1="1203.1855" y2="1203.1855"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="2545.25" y="1200.281">fakeClientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="2682.25" x2="2703.25" y1="1226.1415" y2="1226.1415"/><line style="stroke:#181818;stroke-width:0.5;" x1="2703.25" x2="2703.25" y1="1226.1415" y2="1232.6415"/><line style="stroke:#181818;stroke-width:0.5;" x1="2682.75" x2="2703.25" y1="1232.6415" y2="1232.6415"/><polygon fill="#181818" points="2687.75,1230.6415,2682.75,1232.6415,2687.75,1234.6415,2685.75,1232.6415" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="2685.75" y="1223.237">built "keyExchange" message</text><path d="M2542.5,1209.6855 L2542.5,1241.1855 L2674.5,1241.1855 L2674.5,1214.6855 L2669.5,1209.6855 L2542.5,1209.6855 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2669.5,1209.6855 L2669.5,1214.6855 L2674.5,1214.6855 L2669.5,1209.6855 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="2545.5" y="1219.134">Fake client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102.5" x="2545.5" y="1227.987">with real clientId, fakeClientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81" x="2545.5" y="1236.84">groupName, publicKeyM_S</text><polygon fill="#181818" points="2846.25,1253.5975,2851.25,1255.5975,2846.25,1257.5975,2848.25,1255.5975" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2682.25" x2="2849.25" y1="1255.5975" y2="1255.5975"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="160.5" x="2685.75" y="1252.693">HTTP POST /keyExchange (Mallory's ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="1271.4506" y2="1271.4506"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="1271.4506" y2="1277.9506"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="1277.9506" y2="1277.9506"/><polygon fill="#181818" points="2862.75,1275.9506,2857.75,1277.9506,2862.75,1279.9506,2860.75,1277.9506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2860.75" y="1268.5461">Parse ClientHello JSON (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="1293.8036" y2="1293.8036"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="1293.8036" y2="1300.3036"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="1300.3036" y2="1300.3036"/><polygon fill="#181818" points="2862.75,1298.3036,2857.75,1300.3036,2862.75,1302.3036,2860.75,1300.3036" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="148.5" x="2860.75" y="1290.8991">extract fake client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="1316.1566" y2="1316.1566"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="1316.1566" y2="1322.6566"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="1322.6566" y2="1322.6566"/><polygon fill="#181818" points="2862.75,1320.6566,2857.75,1322.6566,2862.75,1324.6566,2860.75,1322.6566" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2860.75" y="1313.2521">extract fake client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="1338.5096" y2="1338.5096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="1338.5096" y2="1345.0096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="1345.0096" y2="1345.0096"/><polygon fill="#181818" points="2862.75,1343.0096,2857.75,1345.0096,2862.75,1347.0096,2860.75,1345.0096" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170.5" x="2860.75" y="1335.6051">extract fake client's group name as extractedGroupName</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="1367.9656" y2="1367.9656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="1367.9656" y2="1374.4656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="1374.4656" y2="1374.4656"/><polygon fill="#181818" points="2862.75,1372.4656,2857.75,1374.4656,2862.75,1376.4656,2860.75,1374.4656" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="159.5" x="2860.75" y="1365.0611">extract fake client's public key as extractedPublicKeyA</text><path d="M3026,1351.5096 L3026,1383.0096 L3178,1383.0096 L3178,1356.5096 L3173,1351.5096 L3026,1351.5096 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3173,1351.5096 L3173,1356.5096 L3178,1356.5096 L3173,1351.5096 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="106" x="3029" y="1360.9581">Server extracts clients id, (Alice's Id),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141.5" x="3029" y="1369.8111">malloryNonceToServer (thinks it's client nonce),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="129" x="3029" y="1378.6641">publicKeyM_S (thinks it's client publicKeyA).</text><polygon fill="#181818" points="3605,1395.4216,3610,1397.4216,3605,1399.4216,3607,1397.4216" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3608" y1="1397.4216" y2="1397.4216"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2860.75" y="1394.5171">BIGNUMToHex(extractedPublicKeyA)</text><polygon fill="#181818" points="2862.75,1411.2746,2857.75,1413.2746,2862.75,1415.2746,2860.75,1413.2746" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3613" y1="1413.2746" y2="1413.2746"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="59" x="2865.75" y="1410.3701">peerPublicKey (hex)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2880.75" y1="1426.6276" y2="1426.6276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2880.75" x2="2880.75" y1="1426.6276" y2="1433.1276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2860.25" x2="2880.75" y1="1433.1276" y2="1433.1276"/><polygon fill="#181818" points="2865.25,1431.1276,2860.25,1433.1276,2865.25,1435.1276,2863.25,1433.1276" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="2863.25" y="1423.7231">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="2880.75" y1="1453.9806" y2="1453.9806"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2880.75" x2="2880.75" y1="1453.9806" y2="1460.4806"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2857.25" x2="2880.75" y1="1460.4806" y2="1460.4806"/><polygon fill="#181818" points="2862.25,1458.4806,2857.25,1460.4806,2862.25,1462.4806,2860.25,1460.4806" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="2863.25" y="1451.0761">sessionId</text><polygon fill="#181818" points="3235.75,1471.8336,3240.75,1473.8336,3235.75,1475.8336,3237.75,1473.8336" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3238.75" y1="1473.8336" y2="1473.8336"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="375" x="2860.75" y="1470.9291">Create ServerSessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, extractedGroupName)</text><polygon fill="#181818" points="3396.25,1487.6867,3401.25,1489.6867,3396.25,1491.6867,3398.25,1489.6867" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3246.75" x2="3399.25" y1="1489.6867" y2="1489.6867"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="3250.25" y="1486.7822">Create DiffieHellman(debugFlag, groupNameDH)</text><polygon fill="#181818" points="3497.25,1503.5397,3502.25,1505.5397,3497.25,1507.5397,3499.25,1505.5397" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3407.25" x2="3500.25" y1="1505.5397" y2="1505.5397"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="3410.75" y="1502.6352">loadDhParameters()</text><polygon fill="#181818" points="3412.75,1519.3927,3407.75,1521.3927,3412.75,1523.3927,3410.75,1521.3927" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3409.75" x2="3505.25" y1="1521.3927" y2="1521.3927"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="3415.75" y="1518.4882">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="3409.75" x2="3430.75" y1="1537.2457" y2="1537.2457"/><line style="stroke:#181818;stroke-width:0.5;" x1="3430.75" x2="3430.75" y1="1537.2457" y2="1543.7457"/><line style="stroke:#181818;stroke-width:0.5;" x1="3410.25" x2="3430.75" y1="1543.7457" y2="1543.7457"/><polygon fill="#181818" points="3415.25,1541.7457,3410.25,1543.7457,3415.25,1545.7457,3413.25,1543.7457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="3413.25" y="1534.3412">generatePrivateKey()</text><path d="M3482,1529.6427 L3482,1543.1427 L3594.5,1543.1427 L3594.5,1534.6427 L3589.5,1529.6427 L3482,1529.6427 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3589.5,1529.6427 L3589.5,1534.6427 L3594.5,1534.6427 L3589.5,1529.6427 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102" x="3485" y="1539.0912">Server generates private key 'm_a'</text><line style="stroke:#181818;stroke-width:0.5;" x1="3409.75" x2="3430.75" y1="1574.5987" y2="1574.5987"/><line style="stroke:#181818;stroke-width:0.5;" x1="3430.75" x2="3430.75" y1="1574.5987" y2="1581.0987"/><line style="stroke:#181818;stroke-width:0.5;" x1="3410.25" x2="3430.75" y1="1581.0987" y2="1581.0987"/><polygon fill="#181818" points="3415.25,1579.0987,3410.25,1581.0987,3415.25,1583.0987,3413.25,1581.0987" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="3413.25" y="1571.6942">generatePublicKey()</text><path d="M3479,1566.9957 L3479,1580.4957 L3629,1580.4957 L3629,1571.9957 L3624,1566.9957 L3479,1566.9957 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3624,1566.9957 L3624,1571.9957 L3629,1571.9957 L3624,1566.9957 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="3482" y="1576.4442">Server computes public key M_A = (g^m_a) % p</text><polygon fill="#181818" points="3605,1609.9517,3610,1611.9517,3605,1613.9517,3607,1611.9517" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3407.25" x2="3608" y1="1611.9517" y2="1611.9517"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="3410.75" y="1609.0472">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="3412.75,1625.8047,3407.75,1627.8047,3412.75,1629.8047,3410.75,1627.8047" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3409.75" x2="3613" y1="1627.8047" y2="1627.8047"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="3415.75" y="1624.9002">Public Key M_A (hex)</text><polygon fill="#181818" points="3252.25,1641.6577,3247.25,1643.6577,3252.25,1645.6577,3250.25,1643.6577" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3249.25" x2="3404.25" y1="1643.6577" y2="1643.6577"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="3255.25" y="1640.7532">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="3711.5,1657.5107,3716.5,1659.5107,3711.5,1661.5107,3713.5,1659.5107" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3246.75" x2="3714.5" y1="1659.5107" y2="1659.5107"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="3250.25" y="1656.6062">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="3252.25,1673.3637,3247.25,1675.3637,3252.25,1677.3637,3250.25,1675.3637" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3249.25" x2="3719.5" y1="1675.3637" y2="1675.3637"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="99.5" x="3255.25" y="1672.4592">result stored in _serverNonceHex</text><polygon fill="#181818" points="3711.5,1689.2167,3716.5,1691.2167,3711.5,1693.2167,3713.5,1691.2167" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="3246.75" x2="3714.5" y1="1691.2167" y2="1691.2167"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="3250.25" y="1688.3122">generateRandomIV(ivLength)</text><polygon fill="#181818" points="3252.25,1705.0697,3247.25,1707.0697,3252.25,1709.0697,3250.25,1707.0697" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="3249.25" x2="3719.5" y1="1707.0697" y2="1707.0697"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="3255.25" y="1704.1652">result stored in _iv</text><polygon fill="#181818" points="2862.75,1720.9228,2857.75,1722.9228,2862.75,1724.9228,2860.75,1722.9228" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3243.75" y1="1722.9228" y2="1722.9228"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="205.5" x="2865.75" y="1720.0183">returns SessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="3396.25,1742.7023,3401.25,1744.7023,3396.25,1746.7023,3398.25,1744.7023" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3399.25" y1="1744.7023" y2="1744.7023"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="233" x="2860.75" y="1741.7978">deriveSharedSecret(extractedPublicKeyA, _serverNonceHex, _clientNonceHex)</text><path d="M3409.5,1729.4228 L3409.5,1751.9228 L3633.5,1751.9228 L3633.5,1734.4228 L3628.5,1729.4228 L3409.5,1729.4228 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3628.5,1729.4228 L3628.5,1734.4228 L3633.5,1734.4228 L3628.5,1729.4228 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="213.5" x="3412.5" y="1738.8713">Server computes shared secret M_S = (publicKeyM_A ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="157.5" x="3412.5" y="1747.7243">This is the shared secret between Mallory and Server.</text><polygon fill="#181818" points="2862.75,1764.4818,2857.75,1766.4818,2862.75,1768.4818,2860.75,1766.4818" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3404.25" y1="1766.4818" y2="1766.4818"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80.5" x="2865.75" y="1763.5773">_derivedSymmetricKeyHex</text><polygon fill="#181818" points="3396.25,1780.3348,3401.25,1782.3348,3396.25,1784.3348,3398.25,1782.3348" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3399.25" y1="1782.3348" y2="1782.3348"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80" x="2860.75" y="1779.4303">getConfirmationMessage()</text><polygon fill="#181818" points="2862.75,1796.1878,2857.75,1798.1878,2862.75,1800.1878,2860.75,1798.1878" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3404.25" y1="1798.1878" y2="1798.1878"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="150.5" x="2865.75" y="1795.2833">returns server's confirmation message as message</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2880.75" y1="1811.5408" y2="1811.5408"/><line style="stroke:#181818;stroke-width:0.5;" x1="2880.75" x2="2880.75" y1="1811.5408" y2="1818.0408"/><line style="stroke:#181818;stroke-width:0.5;" x1="2860.25" x2="2880.75" y1="1818.0408" y2="1818.0408"/><polygon fill="#181818" points="2865.25,1816.0408,2860.25,1818.0408,2865.25,1820.0408,2863.25,1818.0408" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80.5" x="2863.25" y="1808.6363">build confirmation payload</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="2880.75" y1="1838.8938" y2="1838.8938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2880.75" x2="2880.75" y1="1838.8938" y2="1845.3938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2857.25" x2="2880.75" y1="1845.3938" y2="1845.3938"/><polygon fill="#181818" points="2862.25,1843.3938,2857.25,1845.3938,2862.25,1847.3938,2860.25,1845.3938" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="277" x="2863.25" y="1835.9893">confirmation payload build with fields: message, sessionId, clientId, clientNonce, serverNonce</text><polygon fill="#181818" points="3711.5,1856.7468,3716.5,1858.7468,3711.5,1860.7468,3713.5,1858.7468" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3714.5" y1="1858.7468" y2="1858.7468"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="237" x="2860.75" y="1855.8423">encryptMessageAes256CbcMode(confirmationMsg, _derivedSymmetricKey, _iv)</text><polygon fill="#181818" points="2862.75,1887.3793,2857.75,1889.3793,2862.75,1891.3793,2860.75,1889.3793" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3719.5" y1="1889.3793" y2="1889.3793"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2865.75" y="1886.4748">ciphertext</text><path d="M2681,1865.2468 L2681,1905.2468 L2849.5,1905.2468 L2849.5,1870.2468 L2844.5,1865.2468 L2681,1865.2468 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2844.5,1865.2468 L2844.5,1870.2468 L2849.5,1870.2468 L2844.5,1865.2468 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138" x="2684" y="1874.6953">Server constructs JSON response (ServerHello)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121" x="2684" y="1883.5483">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2684" y="1892.4013">encrypted confirmation (ciphertext_MS, ivHex_MS)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="158" x="2684" y="1901.2543">Server believes it's sending to Alice instead of Mallory</text><polygon fill="#181818" points="2687.75,1923.9384,2682.75,1925.9384,2687.75,1927.9384,2685.75,1925.9384" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2684.75" x2="2854.25" y1="1925.9384" y2="1925.9384"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95.5" x="2690.75" y="1923.0339">HTTP 201 OK (ServerHello JSON)</text><path d="M2859.5,1910.6589 L2859.5,1933.1589 L3090.5,1933.1589 L3090.5,1915.6589 L3085.5,1910.6589 L2859.5,1910.6589 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3085.5,1910.6589 L3085.5,1915.6589 L3090.5,1915.6589 L3085.5,1910.6589 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="2862.5" y="1920.1074">Mallory's fake client intercepts ServerHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="220.5" x="2862.5" y="1928.9604">He extracts sessionId, serverNonce, publicKeyB, ciphertext_MS, ivHex_MS.</text><polygon fill="#181818" points="1217,1945.7179,1212,1947.7179,1217,1949.7179,1215,1947.7179" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2679.25" y1="1947.7179" y2="1947.7179"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107.5" x="1220" y="1944.8134">returns server's response decrypted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="1963.5709" y2="1963.5709"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="1963.5709" y2="1970.0709"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="1970.0709" y2="1970.0709"/><polygon fill="#181818" points="1217,1968.0709,1212,1970.0709,1217,1972.0709,1215,1970.0709" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122" x="1215" y="1960.6664">Parse ServerHello JSON (from real server)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="1985.9239" y2="1985.9239"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="1985.9239" y2="1992.4239"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="1992.4239" y2="1992.4239"/><polygon fill="#181818" points="1217,1990.4239,1212,1992.4239,1217,1994.4239,1215,1992.4239" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145" x="1215" y="1983.0194">extracts server's session id as sessionIdExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2008.2769" y2="2008.2769"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2008.2769" y2="2014.7769"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2014.7769" y2="2014.7769"/><polygon fill="#181818" points="1217,2012.7769,1212,2014.7769,1217,2016.7769,1215,2014.7769" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="113" x="1215" y="2005.3724">extracts client's id as clientIdExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2030.6299" y2="2030.6299"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2030.6299" y2="2037.1299"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2037.1299" y2="2037.1299"/><polygon fill="#181818" points="1217,2035.1299,1212,2037.1299,1217,2039.1299,1215,2037.1299" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="140.5" x="1215" y="2027.7254">extracts client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2052.9829" y2="2052.9829"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2052.9829" y2="2059.4829"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2059.4829" y2="2059.4829"/><polygon fill="#181818" points="1217,2057.4829,1212,2059.4829,1217,2061.4829,1215,2059.4829" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144.5" x="1215" y="2050.0784">extracts server's nonce as serverNonceExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2075.3359" y2="2075.3359"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2075.3359" y2="2081.8359"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2081.8359" y2="2081.8359"/><polygon fill="#181818" points="1217,2079.8359,1212,2081.8359,1217,2083.8359,1215,2081.8359" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141" x="1215" y="2072.4314">extracts server's message as messageExtracted</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="2104.7919" y2="2104.7919"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="2104.7919" y2="2111.2919"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="2111.2919" y2="2111.2919"/><polygon fill="#181818" points="1217,2109.2919,1212,2111.2919,1217,2113.2919,1215,2111.2919" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="325.5" x="1215" y="2101.8874">confirmationString is built with the fields: sessionId, clientId, clientNonce, serverNonce and messageExtracted</text><path d="M1546.5,2088.3359 L1546.5,2119.8359 L1773.5,2119.8359 L1773.5,2093.3359 L1768.5,2088.3359 L1546.5,2088.3359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1768.5,2088.3359 L1768.5,2093.3359 L1773.5,2093.3359 L1768.5,2088.3359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="1549.5" y="2097.7844">Mallory in this example just scoops the data exchanged between the real</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="210.5" x="1549.5" y="2106.6374">server and the client, it does not tamper the message, just changes the</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="1549.5" y="2115.4904">nonce's and iv's to ensure total control over each leg of the channel.</text><polygon fill="#181818" points="2533.25,2132.248,2538.25,2134.248,2533.25,2136.248,2535.25,2134.248" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="2134.248" y2="2134.248"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="265" x="1215" y="2131.3435">encryptMessageAes256CbcMode(confirmationString, _derivedSymmetricKey_AM, _ivAM)</text><polygon fill="#181818" points="1217,2171.7335,1212,2173.7335,1217,2175.7335,1215,2173.7335" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="2173.7335" y2="2173.7335"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="1220" y="2170.829">ciphertext_AM</text><path d="M982,2140.748 L982,2198.748 L1204,2198.748 L1204,2145.748 L1199,2140.748 L982,2140.748 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,2140.748 L1199,2145.748 L1204,2145.748 L1199,2140.748 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="985" y="2150.1965">Mallory constructs her own ServerHello to Client</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199.5" x="985" y="2159.0495">with original sessionId, serverNonce_AM (Mallory's), publicKeyM_A,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="211.5" x="985" y="2167.9025">encrypted confirmation (ciphertext_AM) and initialization vector _ivAM.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="985" y="2176.7555">Mallory sends her own public key (M_A) to the client,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="985" y="2185.6085">making Alice believe M_A is Bob's public key.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="985" y="2194.4615">Mallory uses his own nonce he generated for this leg of the attack.</text><polygon fill="#181818" points="271.25,2211.219,266.25,2213.219,271.25,2215.219,269.25,2213.219" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1208.5" y1="2213.219" y2="2213.219"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="274.25" y="2210.3145">HTTP 201 OK (Mallory's ServerHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2231.7485" y2="2231.7485"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2231.7485" y2="2238.2485"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2238.2485" y2="2238.2485"/><polygon fill="#181818" points="271.25,2236.2485,266.25,2238.2485,271.25,2240.2485,269.25,2238.2485" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142.5" x="269.25" y="2228.844">Parse ServerHello JSON response (from Mallory)</text><path d="M417.5,2219.719 L417.5,2242.219 L627,2242.219 L627,2224.719 L622,2219.719 L417.5,2219.719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M622,2219.719 L622,2224.719 L627,2224.719 L622,2219.719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="420.5" y="2229.1675">Client extracts sessionId, serverNonce (Mallory's),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199" x="420.5" y="2238.0205">groupName, publicKeyB (Mallory's M_A), ciphertext_AM, ivHex_AM</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2256.778" y2="2256.778"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2256.778" y2="2263.278"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2263.278" y2="2263.278"/><polygon fill="#181818" points="271.25,2261.278,266.25,2263.278,271.25,2265.278,269.25,2263.278" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="2253.8735">Parse ServerHello JSON (from fake server)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2279.1311" y2="2279.1311"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2279.1311" y2="2285.6311"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2285.6311" y2="2285.6311"/><polygon fill="#181818" points="271.25,2283.6311,266.25,2285.6311,271.25,2287.6311,269.25,2285.6311" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="269.25" y="2276.2265">extracts server's session id as sessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2301.4841" y2="2301.4841"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2301.4841" y2="2307.9841"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2307.9841" y2="2307.9841"/><polygon fill="#181818" points="271.25,2305.9841,266.25,2307.9841,271.25,2309.9841,269.25,2307.9841" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145" x="269.25" y="2298.5796">extracts server's nonce as extractedNonceServer</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2323.8371" y2="2323.8371"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2323.8371" y2="2330.3371"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2330.3371" y2="2330.3371"/><polygon fill="#181818" points="271.25,2328.3371,266.25,2330.3371,271.25,2332.3371,269.25,2330.3371" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="137.5" x="269.25" y="2320.9326">extracts group name as extractedGroupName</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2346.1901" y2="2346.1901"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2346.1901" y2="2352.6901"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2352.6901" y2="2352.6901"/><polygon fill="#181818" points="271.25,2350.6901,266.25,2352.6901,271.25,2354.6901,269.25,2352.6901" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="165" x="269.25" y="2343.2856">extracts fake server's public key as extractedPublicKeyB</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2368.5431" y2="2368.5431"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2368.5431" y2="2375.0431"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2375.0431" y2="2375.0431"/><polygon fill="#181818" points="271.25,2373.0431,266.25,2375.0431,271.25,2377.0431,269.25,2375.0431" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="269.25" y="2365.6386">extracts fake server's ciphertext as ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2390.8961" y2="2390.8961"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2390.8961" y2="2397.3961"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2397.3961" y2="2397.3961"/><polygon fill="#181818" points="271.25,2395.3961,266.25,2397.3961,271.25,2399.3961,269.25,2397.3961" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83.5" x="269.25" y="2387.9916">extracts fake server's iv as iv</text><polygon fill="#181818" points="665.75,2411.2491,670.75,2413.2491,665.75,2415.2491,667.75,2413.2491" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="668.75" y1="2413.2491" y2="2413.2491"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="284" x="269.25" y="2410.3446">Create SessionData(diffieHellman, extractedNonceServer, clientNonceHex, extractedClientId, iv)</text><polygon fill="#181818" points="271.25,2427.1021,266.25,2429.1021,271.25,2431.1021,269.25,2429.1021" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="673.75" y1="2429.1021" y2="2429.1021"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="205.5" x="274.25" y="2426.1976">returns SessionData, stored in the map _diffieHellmanMap[sessionId]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2444.9551" y2="2444.9551"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2444.9551" y2="2451.4551"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2451.4551" y2="2451.4551"/><polygon fill="#181818" points="271.25,2449.4551,266.25,2451.4551,271.25,2453.4551,269.25,2451.4551" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118.5" x="269.25" y="2442.0506">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="742.75,2471.2346,747.75,2473.2346,742.75,2475.2346,744.75,2473.2346" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="2473.2346" y2="2473.2346"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="227" x="269.25" y="2470.3301">deriveSharedSecret(extractedPublicKeyB, serverNonceHex, clientNonceHex)</text><path d="M756,2457.9551 L756,2480.4551 L968.5,2480.4551 L968.5,2462.9551 L963.5,2457.9551 L756,2457.9551 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963.5,2457.9551 L963.5,2462.9551 L968.5,2462.9551 L963.5,2457.9551 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="759" y="2467.4036">Client computes shared secret s = (publicKeyM_B ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="174.5" x="759" y="2476.2566">This is the shared secret between Client (Alice) and Mallory.</text><polygon fill="#181818" points="271.25,2493.0141,266.25,2495.0141,271.25,2497.0141,269.25,2495.0141" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="2495.0141" y2="2495.0141"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="158" x="274.25" y="2492.1096">_derivedSymmetricKeyHex (Alice-Mallory shared key)</text><polygon fill="#181818" points="1033,2508.8671,1038,2510.8671,1033,2512.8671,1035,2510.8671" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1036" y1="2510.8671" y2="2510.8671"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="269.25" y="2507.9626">hexToBytes(_diffieHellmanMap[sessionId]-&gt;_derivedKeyHex)</text><polygon fill="#181818" points="271.25,2524.7202,266.25,2526.7202,271.25,2528.7202,269.25,2526.7202" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1041" y1="2526.7202" y2="2526.7202"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="57" x="274.25" y="2523.8157">returns derivedKey</text><polygon fill="#181818" points="742.75,2540.5732,747.75,2542.5732,742.75,2544.5732,744.75,2542.5732" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="745.75" y1="2542.5732" y2="2542.5732"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="80" x="269.25" y="2539.6687">getConfirmationMessage()</text><polygon fill="#181818" points="271.25,2556.4262,266.25,2558.4262,271.25,2560.4262,269.25,2558.4262" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="750.75" y1="2558.4262" y2="2558.4262"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="186.5" x="274.25" y="2555.5217">returns client's confirmation message as confirmationMessage</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="289.25" y1="2571.7792" y2="2571.7792"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2571.7792" y2="2578.2792"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2578.2792" y2="2578.2792"/><polygon fill="#181818" points="273.75,2576.2792,268.75,2578.2792,273.75,2580.2792,271.75,2578.2792" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="399" x="271.75" y="2568.8747">confirmationServerResponse(ciphertext, derivedKey, iv, sessionId, clientId, _clientNonceHex, _serverNonceHex, confirmationMessage)</text><polygon fill="#181818" points="1137.5,2594.6322,1142.5,2596.6322,1137.5,2598.6322,1139.5,2596.6322" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="1140.5" y1="2596.6322" y2="2596.6322"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="178" x="271.75" y="2593.7277">decryptMessageAes256CbcMode(ciphertext, derivedKey, iv)</text><polygon fill="#181818" points="273.75,2610.4852,268.75,2612.4852,273.75,2614.4852,271.75,2612.4852" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="1145.5" y1="2612.4852" y2="2612.4852"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="101" x="276.75" y="2609.5807">decryptedPlaintext (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2639.8677" y2="2639.8677"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2639.8677" y2="2646.3677"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2646.3677" y2="2646.3677"/><polygon fill="#181818" points="273.75,2644.3677,268.75,2646.3677,273.75,2648.3677,271.75,2646.3677" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96" x="271.75" y="2636.9632">Parse decryptedPlaintext (JSON)</text><path d="M373.5,2618.9852 L373.5,2658.9852 L561.5,2658.9852 L561.5,2623.9852 L556.5,2618.9852 L373.5,2618.9852 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M556.5,2618.9852 L556.5,2623.9852 L561.5,2623.9852 L556.5,2618.9852 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96.5" x="376.5" y="2628.4337">Client compares extracted fields.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="177.5" x="376.5" y="2637.2867">Since Mallory forwarded a valid confirmation, this validation</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152.5" x="376.5" y="2646.1397">will likely pass, making Alice believe she successfully</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="74.5" x="376.5" y="2654.9927">communicated with Bob.</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2673.7502" y2="2673.7502"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2673.7502" y2="2680.2502"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2680.2502" y2="2680.2502"/><polygon fill="#181818" points="273.75,2678.2502,268.75,2680.2502,273.75,2682.2502,271.75,2680.2502" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131" x="271.75" y="2670.8457">extracts session's id from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2696.1032" y2="2696.1032"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2696.1032" y2="2702.6032"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2702.6032" y2="2702.6032"/><polygon fill="#181818" points="273.75,2700.6032,268.75,2702.6032,273.75,2704.6032,271.75,2702.6032" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125" x="271.75" y="2693.1987">extracts client's id from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2718.4563" y2="2718.4563"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2718.4563" y2="2724.9563"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2724.9563" y2="2724.9563"/><polygon fill="#181818" points="273.75,2722.9563,268.75,2724.9563,273.75,2726.9563,271.75,2724.9563" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="133" x="271.75" y="2715.5518">extracts clientNonce from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2740.8093" y2="2740.8093"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2740.8093" y2="2747.3093"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2747.3093" y2="2747.3093"/><polygon fill="#181818" points="273.75,2745.3093,268.75,2747.3093,273.75,2749.3093,271.75,2747.3093" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="135.5" x="271.75" y="2737.9048">extracts serverNonce from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2763.1623" y2="2763.1623"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2763.1623" y2="2769.6623"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2769.6623" y2="2769.6623"/><polygon fill="#181818" points="273.75,2767.6623,268.75,2769.6623,273.75,2771.6623,271.75,2769.6623" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="271.75" y="2760.2578">extracts message from resulting plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2785.5153" y2="2785.5153"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2785.5153" y2="2792.0153"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2792.0153" y2="2792.0153"/><polygon fill="#181818" points="273.75,2790.0153,268.75,2792.0153,273.75,2794.0153,271.75,2792.0153" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="288.5" x="271.75" y="2782.6108">compares the extracted fields with the ones in its memory, updating validationResult accordingly</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="289.25" y1="2810.3683" y2="2810.3683"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="289.25" x2="289.25" y1="2810.3683" y2="2816.8683"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="265.75" x2="289.25" y1="2816.8683" y2="2816.8683"/><polygon fill="#181818" points="270.75,2814.8683,265.75,2816.8683,270.75,2818.8683,268.75,2816.8683" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="271.75" y="2807.4638">(bool validationResult, string decryptedMessage)</text><path d="M5,2821.8683 L36.5,2821.8683 L36.5,2826.7213 L31.5,2831.7213 L5,2831.7213 L5,2821.8683 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="2821.8683"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="12.5" y="2829.3168">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="69.5" x="44" y="2828.7477">[validationResult == true]</text><polygon fill="#181818" points="50.75,2843.0743,45.75,2845.0743,50.75,2847.0743,48.75,2845.0743" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="2845.0743" y2="2845.0743"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="203.5" x="53.75" y="2842.1698">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><path d="M268,2834.2213 L268,2847.7213 L434.5,2847.7213 L434.5,2839.2213 L429.5,2834.2213 L268,2834.2213 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M429.5,2834.2213 L429.5,2839.2213 L434.5,2839.2213 L429.5,2834.2213 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="271" y="2843.6698">Client is unaware it succeeded with Mallory, not Bob.</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="5" x2="439.75" y1="2851.0743" y2="2851.0743"/><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="70.5" x="7.5" y="2856.9538">[validationResult == false]</text><polygon fill="#181818" points="50.75,2868.9183,45.75,2870.9183,50.75,2872.9183,48.75,2870.9183" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="2870.9183" y2="2870.9183"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="53.75" y="2868.0138">Logs "Diffie Hellman key exchange failed"</text><polygon fill="#181818" points="254.75,2888.2713,259.75,2890.2713,254.75,2892.2713,256.75,2890.2713" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="2890.2713" y2="2890.2713"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147.5" x="48.75" y="2887.3668">messageExchange(portServerNumber, sessionId)</text><polygon fill="#181818" points="1137.5,2904.1243,1142.5,2906.1243,1137.5,2908.1243,1139.5,2906.1243" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="2906.1243" y2="2906.1243"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="269.25" y="2903.2198">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="271.25,2919.9773,266.25,2921.9773,271.25,2923.9773,269.25,2921.9773" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="2921.9773" y2="2921.9773"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="41" x="274.25" y="2919.0728">newIVrotated</text><polygon fill="#181818" points="1137.5,2935.8303,1142.5,2937.8303,1137.5,2939.8303,1139.5,2937.8303" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="2937.8303" y2="2937.8303"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="79.5" x="269.25" y="2934.9258">getFormattedTimestamp()</text><polygon fill="#181818" points="271.25,2951.6833,266.25,2953.6833,271.25,2955.6833,269.25,2953.6833" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="2953.6833" y2="2953.6833"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="46.5" x="274.25" y="2950.7788">newTimeStamp</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2969.5363" y2="2969.5363"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2969.5363" y2="2976.0363"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2976.0363" y2="2976.0363"/><polygon fill="#181818" points="271.25,2974.0363,266.25,2976.0363,271.25,2978.0363,269.25,2976.0363" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="240" x="269.25" y="2966.6318">built message sent with clientId, sessionId, newTimeStamp as clientMessageSent</text><polygon fill="#181818" points="1137.5,2989.8893,1142.5,2991.8893,1137.5,2993.8893,1139.5,2991.8893" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="2991.8893" y2="2991.8893"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="224.5" x="269.25" y="2988.9848">encryptMessageAes256CbcMode(newPlaintext, _derivedSymmetricKey, _iv)</text><polygon fill="#181818" points="271.25,3005.7423,266.25,3007.7423,271.25,3009.7423,269.25,3007.7423" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="3007.7423" y2="3007.7423"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="274.25" y="3004.8378">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3026.2718" y2="3026.2718"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3026.2718" y2="3032.7718"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3032.7718" y2="3032.7718"/><polygon fill="#181818" points="271.25,3030.7718,266.25,3032.7718,271.25,3034.7718,269.25,3032.7718" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="269.25" y="3023.3673">built "client_message_exchange" message</text><path d="M96.5,3014.2423 L96.5,3036.7423 L258,3036.7423 L258,3019.2423 L253,3014.2423 L96.5,3014.2423 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,3014.2423 L253,3019.2423 L258,3019.2423 L253,3014.2423 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151" x="99.5" y="3023.6908">Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="99.5" y="3032.5438">with sessionId, newIVrotated and ciphertext</text><polygon fill="#181818" points="1200.5,3049.3013,1205.5,3051.3013,1200.5,3053.3013,1202.5,3051.3013" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1203.5" y1="3051.3013" y2="3051.3013"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="269.25" y="3048.3968">HTTP POST /messageExchange (client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3067.1544" y2="3067.1544"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3067.1544" y2="3073.6544"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3073.6544" y2="3073.6544"/><polygon fill="#181818" points="1217,3071.6544,1212,3073.6544,1217,3075.6544,1215,3073.6544" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="1215" y="3064.2499">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3089.5074" y2="3089.5074"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3089.5074" y2="3096.0074"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3096.0074" y2="3096.0074"/><polygon fill="#181818" points="1217,3094.0074,1212,3096.0074,1217,3098.0074,1215,3096.0074" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="1215" y="3086.6029">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3111.8604" y2="3111.8604"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3111.8604" y2="3118.3604"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3118.3604" y2="3118.3604"/><polygon fill="#181818" points="1217,3116.3604,1212,3118.3604,1217,3120.3604,1215,3118.3604" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="1215" y="3108.9559">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3134.2134" y2="3134.2134"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3134.2134" y2="3140.7134"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3140.7134" y2="3140.7134"/><polygon fill="#181818" points="1217,3138.7134,1212,3140.7134,1217,3142.7134,1215,3140.7134" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="1215" y="3131.3089">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3156.5664" y2="3156.5664"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3156.5664" y2="3163.0664"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3163.0664" y2="3163.0664"/><polygon fill="#181818" points="1217,3161.0664,1212,3163.0664,1217,3165.0664,1215,3163.0664" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="1215" y="3153.6619">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M1188,3170.5664 L1219.5,3170.5664 L1219.5,3175.4194 L1214.5,3180.4194 L1188,3180.4194 L1188,3170.5664 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="1188" y="3170.5664"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1195.5" y="3178.0149">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="86.5" x="1227" y="3177.4458">[sessionIdASFoundFlag == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3192.2724" y2="3192.2724"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3192.2724" y2="3198.7724"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3198.7724" y2="3198.7724"/><polygon fill="#181818" points="1217,3196.7724,1212,3198.7724,1217,3200.7724,1215,3198.7724" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1215" y="3189.3679">Throws an exception</text><polygon fill="#181818" points="2533.25,3216.1254,2538.25,3218.1254,2533.25,3220.1254,2535.25,3218.1254" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="3218.1254" y2="3218.1254"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="1215" y="3215.2209">hexToBytes(extractedIv)</text><polygon fill="#181818" points="1217,3231.9784,1212,3233.9784,1217,3235.9784,1215,3233.9784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="3233.9784" y2="3233.9784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="29.5" x="1220" y="3231.0739">iv as ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3249.8314" y2="3249.8314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3249.8314" y2="3256.3314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3256.3314" y2="3256.3314"/><polygon fill="#181818" points="1217,3254.3314,1212,3256.3314,1217,3258.3314,1215,3256.3314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1215" y="3246.9269">store new iv in bytes for that session id</text><polygon fill="#181818" points="2533.25,3270.1844,2538.25,3272.1844,2533.25,3274.1844,2535.25,3272.1844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="3272.1844" y2="3272.1844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="1215" y="3269.2799">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, ivAM)</text><polygon fill="#181818" points="1217,3287.5374,1212,3289.5374,1217,3291.5374,1215,3289.5374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="3289.5374" y2="3289.5374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1220" y="3286.6329">plaintext</text><path d="M1046.5,3278.6844 L1046.5,3292.1844 L1204,3292.1844 L1204,3283.6844 L1199,3278.6844 L1046.5,3278.6844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3278.6844 L1199,3283.6844 L1204,3283.6844 L1199,3278.6844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="1049.5" y="3288.1329">Mallory build fake client request to the real server</text><polygon fill="#181818" points="2533.25,3304.8905,2538.25,3306.8905,2533.25,3308.8905,2535.25,3306.8905" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="3306.8905" y2="3306.8905"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1215" y="3303.986">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1217,3320.7435,1212,3322.7435,1217,3324.7435,1215,3322.7435" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="3322.7435" y2="3322.7435"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="29" x="1220" y="3319.839">iv as ivMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3338.5965" y2="3338.5965"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3338.5965" y2="3345.0965"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3345.0965" y2="3345.0965"/><polygon fill="#181818" points="1217,3343.0965,1212,3345.0965,1217,3347.0965,1215,3345.0965" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187.5" x="1215" y="3335.692">store new iv in bytes for that session id for Mallory -&gt; Server leg</text><polygon fill="#181818" points="2533.25,3358.9495,2538.25,3360.9495,2533.25,3362.9495,2535.25,3360.9495" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="3360.9495" y2="3360.9495"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="192.5" x="1215" y="3358.045">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivMS)</text><polygon fill="#181818" points="1217,3376.3025,1212,3378.3025,1217,3380.3025,1215,3378.3025" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="3378.3025" y2="3378.3025"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40" x="1220" y="3375.398">ciphertextMS</text><path d="M1059,3367.4495 L1059,3380.9495 L1204,3380.9495 L1204,3372.4495 L1199,3367.4495 L1059,3367.4495 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3367.4495 L1199,3372.4495 L1204,3372.4495 L1199,3367.4495 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1062" y="3376.898">Mallory build body request for the real server</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3398.332" y2="3398.332"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3398.332" y2="3404.832"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3404.832" y2="3404.832"/><polygon fill="#181818" points="1217,3402.832,1212,3404.832,1217,3406.832,1215,3404.832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="1215" y="3395.4275">built fake "client_message_exchange" message</text><path d="M1004.5,3386.3025 L1004.5,3408.8025 L1204,3408.8025 L1204,3391.3025 L1199,3386.3025 L1004.5,3386.3025 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,3386.3025 L1199,3391.3025 L1204,3391.3025 L1199,3386.3025 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189" x="1007.5" y="3395.751">Mallory fake Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="1007.5" y="3404.604">with sessionId, ivMS and ciphertext</text><polygon fill="#181818" points="2846.25,3421.3615,2851.25,3423.3615,2846.25,3425.3615,2848.25,3423.3615" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2849.25" y1="3423.3615" y2="3423.3615"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="207" x="1215" y="3420.457">HTTP POST /messageExchange (fake client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3439.2145" y2="3439.2145"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3439.2145" y2="3445.7145"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3445.7145" y2="3445.7145"/><polygon fill="#181818" points="2862.75,3443.7145,2857.75,3445.7145,2862.75,3447.7145,2860.75,3445.7145" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="2860.75" y="3436.31">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3461.5675" y2="3461.5675"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3461.5675" y2="3468.0675"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3468.0675" y2="3468.0675"/><polygon fill="#181818" points="2862.75,3466.0675,2857.75,3468.0675,2862.75,3470.0675,2860.75,3468.0675" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2860.75" y="3458.663">extract session id as extractedSessionIdUuidFormat</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3483.9205" y2="3483.9205"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3483.9205" y2="3490.4205"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3490.4205" y2="3490.4205"/><polygon fill="#181818" points="2862.75,3488.4205,2857.75,3490.4205,2862.75,3492.4205,2860.75,3490.4205" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="2860.75" y="3481.016">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3506.2735" y2="3506.2735"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3506.2735" y2="3512.7735"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3512.7735" y2="3512.7735"/><polygon fill="#181818" points="2862.75,3510.7735,2857.75,3512.7735,2862.75,3514.7735,2860.75,3512.7735" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="2860.75" y="3503.369">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3528.6266" y2="3528.6266"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3528.6266" y2="3535.1266"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3535.1266" y2="3535.1266"/><polygon fill="#181818" points="2862.75,3533.1266,2857.75,3535.1266,2862.75,3537.1266,2860.75,3535.1266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="2860.75" y="3525.7221">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M2827,3542.6266 L2858.5,3542.6266 L2858.5,3547.4796 L2853.5,3552.4796 L2827,3552.4796 L2827,3542.6266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2827" y="3542.6266"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2834.5" y="3550.0751">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="130" x="2866" y="3549.506">[extractedSessionIdUuidFormat does not exist]</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3564.3326" y2="3564.3326"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3564.3326" y2="3570.8326"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3570.8326" y2="3570.8326"/><polygon fill="#181818" points="2862.75,3568.8326,2857.75,3570.8326,2862.75,3572.8326,2860.75,3570.8326" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="2860.75" y="3561.4281">Throws an exception</text><polygon fill="#181818" points="3711.5,3588.1856,3716.5,3590.1856,3711.5,3592.1856,3713.5,3590.1856" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3714.5" y1="3590.1856" y2="3590.1856"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="2860.75" y="3587.2811">hexToBytes(extractedIv)</text><polygon fill="#181818" points="2862.75,3604.0386,2857.75,3606.0386,2862.75,3608.0386,2860.75,3606.0386" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3719.5" y1="3606.0386" y2="3606.0386"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2865.75" y="3603.1341">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3621.8916" y2="3621.8916"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3621.8916" y2="3628.3916"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3628.3916" y2="3628.3916"/><polygon fill="#181818" points="2862.75,3626.3916,2857.75,3628.3916,2862.75,3630.3916,2860.75,3628.3916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2860.75" y="3618.9871">store new iv in bytes for that session id</text><polygon fill="#181818" points="3711.5,3642.2446,3716.5,3644.2446,3711.5,3646.2446,3713.5,3644.2446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3714.5" y1="3644.2446" y2="3644.2446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="2860.75" y="3641.3401">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, iv)</text><polygon fill="#181818" points="2862.75,3658.0976,2857.75,3660.0976,2862.75,3662.0976,2860.75,3660.0976" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3719.5" y1="3660.0976" y2="3660.0976"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="2865.75" y="3657.1931">plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3675.9506" y2="3675.9506"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3675.9506" y2="3682.4506"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3682.4506" y2="3682.4506"/><polygon fill="#181818" points="2862.75,3680.4506,2857.75,3682.4506,2862.75,3684.4506,2860.75,3682.4506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="212.5" x="2860.75" y="3673.0461">build server's confirmation with server id, extracted session id, plaintext</text><polygon fill="#181818" points="3711.5,3696.3036,3716.5,3698.3036,3711.5,3700.3036,3713.5,3698.3036" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3714.5" y1="3698.3036" y2="3698.3036"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="2860.75" y="3695.3991">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="2862.75,3712.1566,2857.75,3714.1566,2862.75,3716.1566,2860.75,3714.1566" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3719.5" y1="3714.1566" y2="3714.1566"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2865.75" y="3711.2521">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3730.0096" y2="3730.0096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3730.0096" y2="3736.5096"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3736.5096" y2="3736.5096"/><polygon fill="#181818" points="2862.75,3734.5096,2857.75,3736.5096,2862.75,3738.5096,2860.75,3736.5096" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2860.75" y="3727.1051">store new iv in bytes for that session id</text><polygon fill="#181818" points="3711.5,3750.3627,3716.5,3752.3627,3711.5,3754.3627,3713.5,3752.3627" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="3714.5" y1="3752.3627" y2="3752.3627"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="183" x="2860.75" y="3749.4582">encryptMessageAes256CbcMode(plaintext, symmetricKey, iv)</text><polygon fill="#181818" points="2862.75,3766.2157,2857.75,3768.2157,2862.75,3770.2157,2860.75,3768.2157" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2859.75" x2="3719.5" y1="3768.2157" y2="3768.2157"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2865.75" y="3765.3112">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3784.0687" y2="3784.0687"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3784.0687" y2="3790.5687"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3790.5687" y2="3790.5687"/><polygon fill="#181818" points="2862.75,3788.5687,2857.75,3790.5687,2862.75,3792.5687,2860.75,3790.5687" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="244" x="2860.75" y="3781.1642">built server confirmation message with server id, extractedSessionId and plaintext</text><path d="M2658,3776.4657 L2658,3789.9657 L2849.5,3789.9657 L2849.5,3781.4657 L2844.5,3776.4657 L2658,3776.4657 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2844.5,3776.4657 L2844.5,3781.4657 L2849.5,3781.4657 L2844.5,3776.4657 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="2661" y="3785.9142">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="2857.25" x2="2878.25" y1="3809.0982" y2="3809.0982"/><line style="stroke:#181818;stroke-width:0.5;" x1="2878.25" x2="2878.25" y1="3809.0982" y2="3815.5982"/><line style="stroke:#181818;stroke-width:0.5;" x1="2857.75" x2="2878.25" y1="3815.5982" y2="3815.5982"/><polygon fill="#181818" points="2862.75,3813.5982,2857.75,3815.5982,2862.75,3817.5982,2860.75,3815.5982" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2860.75" y="3806.1937">built "client_message_exchange" response message</text><path d="M2655.5,3797.0687 L2655.5,3819.5687 L2849.5,3819.5687 L2849.5,3802.0687 L2844.5,3797.0687 L2655.5,3797.0687 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2844.5,3797.0687 L2844.5,3802.0687 L2849.5,3802.0687 L2844.5,3797.0687 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="2658.5" y="3806.5172">Server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124.5" x="2658.5" y="3815.3702">with extractedSessionId, iv and ciphertext</text><polygon fill="#181818" points="1217,3832.1277,1212,3834.1277,1217,3836.1277,1215,3834.1277" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2854.25" y1="3834.1277" y2="3834.1277"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="172" x="1220" y="3831.2232">HTTP 201 OK (Server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3849.9807" y2="3849.9807"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3849.9807" y2="3856.4807"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3856.4807" y2="3856.4807"/><polygon fill="#181818" points="1217,3854.4807,1212,3856.4807,1217,3858.4807,1215,3856.4807" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="67.5" x="1215" y="3847.0762">Parse requestMS body</text><path d="M1188,3863.9807 L1219.5,3863.9807 L1219.5,3868.8337 L1214.5,3873.8337 L1188,3873.8337 L1188,3863.9807 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="1188" y="3863.9807"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1195.5" y="3871.4292">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="84.5" x="1227" y="3870.8602">[requestMS.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3885.6867" y2="3885.6867"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3885.6867" y2="3892.1867"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3892.1867" y2="3892.1867"/><polygon fill="#181818" points="1217,3890.1867,1212,3892.1867,1217,3894.1867,1215,3892.1867" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1215" y="3882.7822">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3911.5397" y2="3911.5397"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3911.5397" y2="3918.0397"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3918.0397" y2="3918.0397"/><polygon fill="#181818" points="1217,3916.0397,1212,3918.0397,1217,3920.0397,1215,3918.0397" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="1215" y="3908.6352">extract session id as extractedSessionIdMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3933.8927" y2="3933.8927"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3933.8927" y2="3940.3927"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3940.3927" y2="3940.3927"/><polygon fill="#181818" points="1217,3938.3927,1212,3940.3927,1217,3942.3927,1215,3940.3927" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92.5" x="1215" y="3930.9882">extract iv as extractedIvHexMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="3956.2457" y2="3956.2457"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="3956.2457" y2="3962.7457"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="3962.7457" y2="3962.7457"/><polygon fill="#181818" points="1217,3960.7457,1212,3962.7457,1217,3964.7457,1215,3962.7457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="1215" y="3953.3412">extract ciphertext as extractedCiphertextMS</text><polygon fill="#181818" points="2533.25,3976.5988,2538.25,3978.5988,2533.25,3980.5988,2535.25,3978.5988" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="3978.5988" y2="3978.5988"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="94.5" x="1215" y="3975.6943">hexToBytes(extractedIvHexMS)</text><polygon fill="#181818" points="1217,3992.4518,1212,3994.4518,1217,3996.4518,1215,3994.4518" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="3994.4518" y2="3994.4518"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="1220" y="3991.5473">extractedIvMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4010.3048" y2="4010.3048"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4010.3048" y2="4016.8048"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4016.8048" y2="4016.8048"/><polygon fill="#181818" points="1217,4014.8048,1212,4016.8048,1217,4018.8048,1215,4016.8048" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60.5" x="1215" y="4007.4003">store extractedIvMS</text><polygon fill="#181818" points="2533.25,4030.6578,2538.25,4032.6578,2533.25,4034.6578,2535.25,4032.6578" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="4032.6578" y2="4032.6578"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="264.5" x="1215" y="4029.7533">decryptMessageAes256CbcMode(extractedCiphertextMS, symmetricKey, extractedIvMS)</text><polygon fill="#181818" points="1217,4048.0108,1212,4050.0108,1217,4052.0108,1215,4050.0108" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="4050.0108" y2="4050.0108"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1220" y="4047.1063">plaintext</text><path d="M1004,4039.1578 L1004,4052.6578 L1204,4052.6578 L1204,4044.1578 L1199,4039.1578 L1004,4039.1578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4039.1578 L1199,4044.1578 L1204,4044.1578 L1199,4039.1578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189.5" x="1007" y="4048.6063">Mallory build client's request response instead of the real server</text><polygon fill="#181818" points="2533.25,4065.3638,2538.25,4067.3638,2533.25,4069.3638,2535.25,4067.3638" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="4067.3638" y2="4067.3638"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1215" y="4064.4593">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1217,4081.2168,1212,4083.2168,1217,4085.2168,1215,4083.2168" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="4083.2168" y2="4083.2168"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="1220" y="4080.3123">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4099.0698" y2="4099.0698"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4099.0698" y2="4105.5698"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4105.5698" y2="4105.5698"/><polygon fill="#181818" points="1217,4103.5698,1212,4105.5698,1217,4107.5698,1215,4105.5698" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="1215" y="4096.1653">store new iv in bytes for that session id for Alice -&gt; Mallory leg</text><polygon fill="#181818" points="2533.25,4119.4228,2538.25,4121.4228,2533.25,4123.4228,2535.25,4121.4228" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="2536.25" y1="4121.4228" y2="4121.4228"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="1215" y="4118.5183">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivAM)</text><polygon fill="#181818" points="1217,4135.2758,1212,4137.2758,1217,4139.2758,1215,4137.2758" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1214" x2="2541.25" y1="4137.2758" y2="4137.2758"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40.5" x="1220" y="4134.3713">ciphertextAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4153.1288" y2="4153.1288"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4153.1288" y2="4159.6288"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4159.6288" y2="4159.6288"/><polygon fill="#181818" points="1217,4157.6288,1212,4159.6288,1217,4161.6288,1215,4159.6288" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="267.5" x="1215" y="4150.2243">built fake server confirmation message with server id, extractedSessionIdMS and plaintext</text><path d="M1012.5,4145.5258 L1012.5,4159.0258 L1204,4159.0258 L1204,4150.5258 L1199,4145.5258 L1012.5,4145.5258 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4145.5258 L1199,4150.5258 L1204,4150.5258 L1199,4145.5258 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="1015.5" y="4154.9743">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="1211.5" x2="1232.5" y1="4178.1583" y2="4178.1583"/><line style="stroke:#181818;stroke-width:0.5;" x1="1232.5" x2="1232.5" y1="4178.1583" y2="4184.6583"/><line style="stroke:#181818;stroke-width:0.5;" x1="1212" x2="1232.5" y1="4184.6583" y2="4184.6583"/><polygon fill="#181818" points="1217,4182.6583,1212,4184.6583,1217,4186.6583,1215,4184.6583" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168.5" x="1215" y="4175.2538">built fake "client_message_exchange" response message</text><path d="M995,4166.1288 L995,4188.6288 L1204,4188.6288 L1204,4171.1288 L1199,4166.1288 L995,4166.1288 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1199,4166.1288 L1199,4171.1288 L1204,4171.1288 L1199,4166.1288 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="998" y="4175.5773">Fake server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154" x="998" y="4184.4304">with extractedSessionIdMS, ivAM and ciphertextAM</text><polygon fill="#181818" points="271.25,4201.1879,266.25,4203.1879,271.25,4205.1879,269.25,4203.1879" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1208.5" y1="4203.1879" y2="4203.1879"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187" x="274.25" y="4200.2834">HTTP 201 OK (Fake server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4219.0409" y2="4219.0409"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4219.0409" y2="4225.5409"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4225.5409" y2="4225.5409"/><polygon fill="#181818" points="271.25,4223.5409,266.25,4225.5409,271.25,4227.5409,269.25,4225.5409" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="269.25" y="4216.1364">Parse request body</text><path d="M235.5,4233.0409 L267,4233.0409 L267,4237.8939 L262,4242.8939 L235.5,4242.8939 L235.5,4233.0409 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="4233.0409"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="4240.4894">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="76.5" x="274.5" y="4239.9203">[request.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4254.7469" y2="4254.7469"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4254.7469" y2="4261.2469"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4261.2469" y2="4261.2469"/><polygon fill="#181818" points="271.25,4259.2469,266.25,4261.2469,271.25,4263.2469,269.25,4261.2469" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="4251.8424">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4280.5999" y2="4280.5999"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4280.5999" y2="4287.0999"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4287.0999" y2="4287.0999"/><polygon fill="#181818" points="271.25,4285.0999,266.25,4287.0999,271.25,4289.0999,269.25,4287.0999" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="269.25" y="4277.6954">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4302.9529" y2="4302.9529"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4302.9529" y2="4309.4529"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4309.4529" y2="4309.4529"/><polygon fill="#181818" points="271.25,4307.4529,266.25,4309.4529,271.25,4311.4529,269.25,4309.4529" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83" x="269.25" y="4300.0484">extract iv as extractedIvHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4325.3059" y2="4325.3059"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4325.3059" y2="4331.8059"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4331.8059" y2="4331.8059"/><polygon fill="#181818" points="271.25,4329.8059,266.25,4331.8059,271.25,4333.8059,269.25,4331.8059" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="269.25" y="4322.4014">extract ciphertext as extractedCiphertext</text><polygon fill="#181818" points="1137.5,4345.6589,1142.5,4347.6589,1137.5,4349.6589,1139.5,4347.6589" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="4347.6589" y2="4347.6589"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="85" x="269.25" y="4344.7544">hexToBytes(extractedIvHex)</text><polygon fill="#181818" points="271.25,4361.5119,266.25,4363.5119,271.25,4365.5119,269.25,4363.5119" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="4363.5119" y2="4363.5119"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="34" x="274.25" y="4360.6074">extractedIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4379.3649" y2="4379.3649"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4379.3649" y2="4385.8649"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4385.8649" y2="4385.8649"/><polygon fill="#181818" points="271.25,4383.8649,266.25,4385.8649,271.25,4387.8649,269.25,4385.8649" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="51" x="269.25" y="4376.4604">store extractedIv</text><polygon fill="#181818" points="1137.5,4399.7179,1142.5,4401.7179,1137.5,4403.7179,1139.5,4401.7179" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="1140.5" y1="4401.7179" y2="4401.7179"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="245.5" x="269.25" y="4398.8134">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, extractedIv)</text><polygon fill="#181818" points="271.25,4415.571,266.25,4417.571,271.25,4419.571,269.25,4417.571" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="1145.5" y1="4417.571" y2="4417.571"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="274.25" y="4414.6665">decryptedCiphertext</text><path d="M235.5,4425.071 L267,4425.071 L267,4429.924 L262,4434.924 L235.5,4434.924 L235.5,4425.071 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="4425.071"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="4432.5195">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="151" x="274.5" y="4431.9504">[decryptedCiphertext.find(clientMessageSent) == true]</text><path d="M268,4437.424 L268,4450.924 L392.5,4450.924 L392.5,4442.424 L387.5,4437.424 L268,4437.424 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M387.5,4437.424 L387.5,4442.424 L392.5,4442.424 L387.5,4437.424 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="114" x="271" y="4446.8725">Connection Test Result : Success (true)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="428" y1="4454.277" y2="4454.277"/><path d="M268,4457.277 L268,4470.777 L390.5,4470.777 L390.5,4462.277 L385.5,4457.277 L268,4457.277 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M385.5,4457.277 L385.5,4462.277 L390.5,4462.277 L385.5,4457.277 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="112" x="271" y="4466.7255">Connection Test Result : Failure (false)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="4485.483" y2="4485.483"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="4485.483" y2="4491.983"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="4491.983" y2="4491.983"/><polygon fill="#181818" points="271.25,4489.983,266.25,4491.983,271.25,4493.983,269.25,4491.983" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="4482.5785">Throws an exception</text><polygon fill="#181818" points="50.75,4509.336,45.75,4511.336,50.75,4513.336,48.75,4511.336" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="4511.336" y2="4511.336"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="53.75" y="4508.4315">connectionTestResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="66.25" y1="4529.689" y2="4529.689"/><line style="stroke:#181818;stroke-width:0.5;" x1="66.25" x2="66.25" y1="4529.689" y2="4536.189"/><line style="stroke:#181818;stroke-width:0.5;" x1="42.75" x2="66.25" y1="4536.189" y2="4536.189"/><polygon fill="#181818" points="47.75,4534.189,42.75,4536.189,47.75,4538.189,45.75,4536.189" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="42.5" x="48.75" y="4526.7845">Program ends</text><!--SRC=[nHnhRzj6yhj-nPuFXr00usiBz3u4I03RiMjVuyI8d0A7mrMWoPN4cY9LafBZeZ_-Pf_SvJwub1It7r9PuivxPsPdPjcaIO7HTwS_JYOFrLTqSb7ak6pHPRdBwwfSm-SJzFSF-NBL_WSNHVKqGV3V9gdRFCqt2Jnviaxo4aNrjcHBlv-UeAH1j_2j-Io77frN3-mnzeNhmJSpt3HvLRvFsaHvNFdMkV9zlbZa-1feNYUbilRzjNl9zLrI9-lcGvLakDRMiA-SAs-1e6I9Bx-sTPAsGDfLakP5tZuhG6ulhvphBykqVjwGXL_Q_hhBBnDSPWYKmpLqrhP9-eXhcuukgZefJ3It2QYkVkQAeP-T3xtX_- -BtlpQ3K8JFehQYlCoLI6zltOftmrcXkiThdjWs9SUCAPUvLgNOgKml9hbJrbLAo3OTSj_1UKw5ugzOcVxAdd4N7wwUR1dRSPnNconYOu_7vtTtJ04x0luq_MiiIlPrrxBu2lDNSb-iErAiSJKdbZZKXvVwTSTUyYgEhxUhZdsexeh2V1TqcBcyoRaN_Jw7JTvz0PTr9ZyolwEJi3tdSGemm_RvLMHB6EqhAljvcEonk-lfnqmPNDmIAy1A0N-1fNuIJoGuVuIau9C5VlF-FdoQxfAoYMEDdMLRQbixggwzMD_9xrXnvEcpsYkC3NV4AtX5jStvM-Oee0lDLO9y1v2RWSTMa2c86OA1_G5V7Y_kXCeccY9M_Nlgxp09Np-KAK9GHrDfnAmWL8nepvoZl2rplndt6xhia7SD2b6j4us4eIX4mE9bqr0iSGbhc7zNKt1WCuY3mSMn9DW3Dk78az34TW1mYu2YEStFttySdjVNUElqNmZm9w2QbJnM-2BJMWY8O1xmcVq8e2Cpb2qmbzrq8ReLU0MlTZaf6rUIpg1yh9fapB527P1naAf4tH_-rn-KOH_GHnCjQoJpIfFFrO0CYh9lxFy3spT83nWT801d4PlIZzGKA07Esa0n4eQB7_OvWLumCVEHvoWDVEZT4bP0PG2BzeU6IYjG2Or-986_NlswICwOOJCLoHhF95FF-NjYjDuayKgjR5yHZg964ahEgE_4fTBAEYJpsCYq7zzVt-7xZxDxj4_5HvGn9ub-gieVJtXYgH8qY0WQi0nYoISwbSDQbZ8Gtb68WF_6MSNdB-HqAZcDK1KC8eh3eT5POY82zG0_YH4En8SqmC2aMhWxdJrI0EfIRgXRKi1Eo_1MQPuquhqbghaL7ls6WiCJKT1Potm1pCOZKcmZ8tq31qytMBi33Fl1PxallfIvhzlCNDaaOLDYulivO0zDCA1TRBTO5nBW20FfE94YwfU9wtDOIbu_CeJleN1vLdPJHQvQRTgIgUw4M0yfFdeKfB3BdimVulcqlt5rcqGcxiCqWerxyXt7t2vR5UnnUgjQObRBlsCjiUUobF7gJZMk98aXLPRYcHaI2xYjEEJXJf9XqgQEu6Q6d1CX9P4oK2gP4ocG0OJ9xTnER7xs9M8lUdKQ0bx_9nj9mdau4OPUkf7NwtdpIlhMkcpGgIoXn6OKh6aWDzQA6crtcofJBhGSZkVeRSeMlwwda_HFz3cBv3Es4ms91JuGuAY3oMr9Q8marjtI1ZaqEMA7OcjKhDHajm0KOSxol14sEy8bPIuXvVdnbQ-Qzni8TDjsgh66Gd3yuOUx4NcV7OxmB58eiVp-XcIbMfzyqiaGjNBy9VlZiAJbXRKtA6lZGTZ1NMxmiJBGvnMZUqssVnNfXN_y-GLjZ3iIJMK3GNn8j_XsIe1GcOu1MfjILti9UprEyCo1XVeXx2pMtUAONLHGSvxtYXi4RUf9vQ_GgeZWntnfdFTdKx6-4EQ6vy_WxkET5duBTVYc0Pze0AV8foCyttxigLhxFXiAV3tOIl88ZBO812pacO5vg1Qn-VaYI95V_vf44A-yyeyp1ZPJijcpsl8wcfcWc_HxFhiXn__5NM4JKVffoK1U0RWocLamp1QJSDwCjsc1Qyeh1oWlmvv8Cx9cDXhEiMkNQ048hI0RqLTEiYbtMJC-rcAroFFLah_mY8eXLmzu932TyfFWf2Ya28552GInabLOl8b2JUGinJShZsIKuZG2nXQXKjFMsMPQmN7dEgfLEiOIFPgjCMqw7MXLZ9ulAHRxhvYIs9jZQq8HfD2JebUb86oWMWIZIfzQ6RXx19Gfadf1csWIy3mVDok7rHi8Q9rAFXTlvLtnFw2E-vQzAJjL4vAsEbvHFlX-CThARHlSRmU9I19oPxdROTER5sD_SWPTT1rKEF7kiy1SimXqXV59Bz11ydmmwJDNBXmXlNXS3QXVPMnDFZyoyZMow47CetVXVn3wysCFejP6TCm3RLm_86E_4V0yIWRsjVHGXqDlbsJfyTwR2nonBg9jUmpB1GvmE3f1tLHrDuPCdJVJKKOv7VuUiZ12pVOG82YHLsj1UdJS72YAxFer3EY1xKd-B2cr9x0WxjKUy8VRbjDHfOmkLVhzQSQa7uC8pG05TCCRnfRLzlIFYYrhVBo4K0GYlcker9t0D7JGSlYhcawFPquowSXiZM3cRSdvjWqhb3MuNZTqwPUoXYiWtPemWrck4lcSG5kRYYc7YgpT-Ra8TI_MDjfna_Vk9isA2fN_qndh5Sn5SDT0VqpPxRleAStnsAImcPQzF6oi6QP4wCdgU_ZLd9xHGZ1IRtJg0Q9i34VciIF5tLWewZdSPrDjEIL5uIpNUGHrzw2yXmlNafEzhxQcUYh9Ux6sWj9RDy3qeZ0uWim_Hao8Xlt-SWPQ8RvTVZglVfjFicFzQpxjjqSEh0SXdGY-9d89ekX7boO3Fe7fR4o66Z7lGZV-UxelFQI4D6fEqQBpacU6l13qXYw6OERTBfnm1U-fasuhmtmiNtVofehaDZHtXiVMr3oyZDeltNTjtE_pxrVvP2_DrG5Ek07t3vXNCgwBHboOwISJaPxRejdOfOHqk48TZuk9ODZlwZAHKwcsy12-6X-jA_EdCm8CsUsGiv42bPH1Y67GLj5v10k6NfIUybqd9lacUIFnpzMsB1m0cWL1hPnaJLl1ATnTmw97HEuQYFmU6SLwcmnkql1zNw66-WBNZoajrL6smkTOJJBs6gHz2moQ2uEhspno5o6-GRQE2tucybUljTTGzFSXbv20_U_WQyWwBC7Q6d87dIe8XMzAGfIQcNdiSCTK9dZda567TFpsrcCyXtiTlWqzV7mWC5ETfWN6XhmDD2K9UqkMlEWUGnaBQXQM6TAWmiFZf8chUBzyDttwDFFcj0i1RjXC_Nu-wuggDIHr9bb1RVfWjMvvG2T8OSUJlUhUrhdSgGRb3QNOMuK8zkYrb5ZLk3iAuGNE9KMx3Het5mXLozgIc5UYhmW49ui138umklj3URm2Ns5HmbCCP2nb4bWPcJhGFbXgRw1pLgGP8Gr4QZx8Nc9Y2MZGWZDLmngWYyA0EASI3fPR-26yczRQ44tQLLjMAP4PahWHrRFpsIg97h_6an64oM7_2xc1_8MPHKcYcXH2rZW4Pe6YtX9KJ8456VFYvIqrak0vZlu0BuGbyss9YC8BUb_L6LRLmMgQBquILSG9vR4GL8I06g92yiz1RUkHiLHfabxA9tJ6Guo3kXkt_S2gRM_fSNFkJ9Sw6zcZHwmKFsBF2QR0nOL65DUKfzZyxr0eDBscMgjfhDuCZ9mWkoOwikypPCY_uCzieD911Z5eC8zjV97GcV7cbAaYO2CgHXVuIOwqPi7ZsHpie3Bup4jNy0kWJkbMhl3ZdiBaa5aKn7KpFq0Bd4EpkWK2TrqYgKczBPvq8KQzHwP5h6xi6gFtQwh99RxQOw8qwLKPc_DucWuk85ehPcBztRQkSeZqMEixmmHtFaUSLrZ6-AICKTJ4pMkMW04HzHm08xOfmn9-C04TVfy01Ik0nfxvoFXTTgYUO9-AWW7a-_8SYZcMDSvcZPTkqQhlSHMGSUz2vxM3euuAFMkVThQCIPbsZO-LjN8k89gL8eiGfuHF2fgDXlPG-M-envKM3hNjZoLgAsivBuHxSXZvBLOQycewHMCphM2qPbPC1ek4edNHT3um88JzqcUBCD-vzbH4UAmNyjGnkXu58EumLUWZUdhWTbJJWwZmgeFjIHlkpckc787REAyB-wsAMyTA-Hb1ZQIvFd2LQnAJPJZ9DxFywd5V-P1KybhOaKyn8yuYaRplXCoQhCMYgqoweTa_PeyFwpQirqdqSxt6FIIMli5Udb0lYiISlA7aE0Os77Ug_T6THjylOmnx55WtobHZv_Ez9nlbfDmBROgP7PFIPt1imdQGRggPxOno_he3_IBNd9T5AZ87t7n36N6fedjcMX3FDCsJK5NYsq1psf0WEhrjinJccVIT1rIra77v4f9g4coOpqlDP262g5f8uGQ14cj3nm14CiQ3mAaffy70HBUOnyWqiH8jEcRMLSKW77xXeJadA9RWvt5QBiX5WI8EcFwpBfTIPfMDQaQ5i_cBb6nHmyL79lxwqdQGOiJSlzeRiNo5Xpg002nGSdRjmXEc3PRus_N-L0j6tJ2EhL8j6f9hYdg3SpGSNP2mwoao6Wg-7SoRBbjcS2-nAGKmK6AxS5tRaoh4-wzWWjmAJOE5mdySWYBYmI6sBCJSM2P1BreI5PxnFk5UlS5b7WodGIzRSZUgfthlTgnBqc1MoGtlzHGfX45gU1Nf71osYlwdWPOVfy3pwHw5ErD2W4n8o3sV5kBsEeD-RBtWXKbVAkOkceetqKpkMMi7FlAJW1NXhB1titerzdeHx5WuSWnQ3wkp6KqnyTvguq1RkBgsAYcHhr5ZwDHhxJfRIyKESZnlU8ceA1VOnY9XDhdGvKzXxqenZ64F3Cc7xrGsF6P_tMp2tn7ZNPqxqx3dPW7wjyhd3wYVA7nKD0P782MDoqaF4HlzDHBunwusoqfZD4_UB2gy-IXm9tYpsPNrRRCo9nYbuqMhVK1qrqxYRrVrTKJAJeJFuqtMgv6d7J0zMYwdvMpbvJOpUxWSh2eVmpLWhqyCa6JYtu03kBB0xscocgJYMfgao4kVSS7Yw60jzISrb4gv6R2vPL8O9MSjVdL9gNOivxxZw4zXg5eUmG3kPszX87GxnGGl9SDrUt98NsMJHVj-WQZTj4FRgc42ccKpH2VBes5oMp0MlpAO66MMc9Oh1qcLBcLl4S0jWLXeXXRy1taqt6Lo8Z3oaxq1MDDMmC3G0EtYgmnEkYAp52i_hBDiolzDMH1S5tHEsZnY2ZkXVToqLn4T9y0k_uonHq-H-QByy9e1oKI5Ed3XgYS0rIzmLNRq5GGmti4VH_N1qV-emd8ZFz1msK34uRsyKRkzcYG8nVIkj9D9x_OGL6GM4CoWvSng6DRrMXHx9aW74rEZid5eGqOnc5dQgsm9sjhmcbmqXUo5tDAYmkyW2o63ecjDo9buHt-BcTX0P3FAIWHE61-Re1dToOZoHXtezen2Hg0ntx3sXHqJEElFSLnpePF1iSmxSENPCg1cu2MvKYofvD9s42ccLFs4Xn8tBGKXuHS-TCfLDxQRJDFOTUXlxqbL0wSeOUFqCSfU2YvUtZ9WqHcw9w5hXtCcG3GVeK0IiJ19na5u17EUpgq8n_zoVojxgerT2zL1HXrafFDA-49fSzGfh63Qm5_QL7WPUf5z3lMj5G0VCDgm547B8FdAuUEwOS5T7wGjeHqkyqUAPGVinhXZE5s3gvqeHqKm1t1cut_mu2g7i0LbUypTdcbpQOD1UmnWvZE8eGIdNsnsTBASeLb6P9D6aOr7zpBRI5uO4bWjSBQIdD6tFqQP0eCPuVC8N8ZhdgeFl10RPGUnh8fU-mNWGr1OecMHQUBlCmYe_KvDOO2FihMFN5BtMkhAfZRfs-RG_V4ydd37OOLsUWBNEG6A5FPczyRtXMqtybbWeXsXgP7sJfT-p-LQ0bMXjJRuUVhxcfoMNnDG3SJpLlavUJ_]--></g></svg>