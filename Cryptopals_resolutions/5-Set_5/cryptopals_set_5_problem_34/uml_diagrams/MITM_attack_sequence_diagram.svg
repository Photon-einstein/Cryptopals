<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3985px" preserveAspectRatio="none" style="width:3281px;height:3985px;background:#FFFFFF;" version="1.1" viewBox="0 0 3281 3985" width="3281.5px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="3979.1038" style="stroke:#181818;stroke-width:0.25;" width="946" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="64" x="449" y="9.9485">Client Environment</text><rect fill="#F08080" height="3979.1038" style="stroke:#181818;stroke-width:0.25;" width="1542.5" x="955" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="73.5" x="1689.5" y="9.9485">Attacker Environment</text><rect fill="#ADD8E6" height="3979.1038" style="stroke:#181818;stroke-width:0.25;" width="677.5" x="2601" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="65.5" x="2907" y="9.9485">Server Environment</text><rect fill="#FFFFFF" height="3915.1828" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="2219.8531" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="98.4711" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2133.278"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="2311.1521"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="512.75" y="95.299"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="146.858"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="184.211"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="512.75" y="2091.6455"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="697.25" y="111.152"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="803" y="202.564"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="250.1231"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2151.6311"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2327.0051"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2358.7111"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2412.7701"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="3768.5397"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="3822.5988"/><rect fill="#FFFFFF" height="1669.7129" style="stroke:#181818;stroke-width:0.5;" width="5" x="970.5" y="318.3881"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="973" y="464.7122"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="970.5" y="2472.1822"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1427" y="505.4182"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1648" y="521.2712"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1650.5" y="572.8302"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1650.5" y="610.1832"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1648" y="770.3603"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1648" y="1844.9384"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1904.5" y="1032.5084"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1907" y="1084.0675"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="1907" y="1121.4205"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="1904.5" y="1612.0697"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1904.5" y="1757.8203"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2089" y="537.1242"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2089" y="1048.3614"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="429.0062"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="643.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="808.5663"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="840.2723"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="916.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="1139.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="691.0953"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="722.8013"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="1187.3325"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="1795.4528"/><rect fill="#FFFFFF" height="52.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="1882.5709"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2639.0062"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2693.0653"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2727.7713"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2781.8303"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3399.4796"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3453.5386"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3488.2446"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3542.3036"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2448.25" y="964.2434"/><rect fill="#FFFFFF" height="573.6348" style="stroke:#181818;stroke-width:0.5;" width="5" x="2448.25" y="1016.6554"/><rect fill="#FFFFFF" height="334.6927" style="stroke:#181818;stroke-width:0.5;" width="5" x="2623.25" y="1255.5975"/><rect fill="#FFFFFF" height="1114.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="2623.25" y="2844.2423"/><rect fill="#FFFFFF" height="81.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="2625.75" y="3173.2435"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="2918.25" y="1339.7156"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="2918.25" y="1485.4662"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3231" y="3011.0664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3231" y="3065.1254"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3231" y="3119.1844"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="2242.7491"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="952" y="2591.4472"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2598" y="2963.5074"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="952" y="3284.8615"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="3653.9217"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="3845.9518"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="42.5" x2="42.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="515" x2="515" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="699.5" x2="699.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="805.5" x2="805.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="910" x2="910" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="973" x2="973" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1429.5" x2="1429.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1650.5" x2="1650.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1907" x2="1907" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2091.5" x2="2091.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2202.5" x2="2202.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2312.5" x2="2312.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2450.5" x2="2450.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2625.5" x2="2625.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2920.5" x2="2920.5" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3019" x2="3019" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3127" x2="3127" y1="30.887" y2="3963.5698"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="3233.5" x2="3233.5" y1="30.887" y2="3963.5698"/><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="24.836">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="3974.0528">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="24.836">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="3974.0528">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="478" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="481.5" y="24.836">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="478" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="481.5" y="3974.0528">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="656.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="660" y="24.836">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="656.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="660" y="3974.0528">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="748" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="751.5" y="24.836">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="748" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="751.5" y="3974.0528">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="868" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="871.5" y="24.836">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="868" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="871.5" y="3974.0528">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="957" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="960.5" y="24.836">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="957" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="960.5" y="3974.0528">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1379.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1383" y="24.836">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="100" x="1379.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="93" x="1383" y="3974.0528">Mallory:MallorySessionData</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1593.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1597" y="24.836">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1593.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1597" y="3974.0528">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="1849" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="1852.5" y="24.836">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="1849" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="1852.5" y="3974.0528">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2045.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2049" y="24.836">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="2045.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="2049" y="3974.0528">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2142.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2146" y="24.836">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="2142.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="2146" y="3974.0528">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2268" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2271.5" y="24.836">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2268" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2271.5" y="3974.0528">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2406" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2409.5" y="24.836">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="2406" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="2409.5" y="3974.0528">Mallory:Client (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2603" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2606.5" y="24.836">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="2603" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="2606.5" y="3974.0528">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="2882.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="2886" y="24.836">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="2882.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="2886" y="3974.0528">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="2975" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="2978.5" y="24.836">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="2975" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="2978.5" y="3974.0528">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3068.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3072" y="24.836">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="3068.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="3072" y="3974.0528">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3190.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3194" y="24.836">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="3190.5" y="3963.0698"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="3194" y="3974.0528">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="3915.1828" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="2219.8531" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="79.446"/><rect fill="#FFFFFF" height="98.4711" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="2133.278"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="2311.1521"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="512.75" y="95.299"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="146.858"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="184.211"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="512.75" y="2091.6455"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="697.25" y="111.152"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="803" y="202.564"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="250.1231"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2151.6311"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2327.0051"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2358.7111"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="2412.7701"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="3768.5397"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="907.5" y="3822.5988"/><rect fill="#FFFFFF" height="1669.7129" style="stroke:#181818;stroke-width:0.5;" width="5" x="970.5" y="318.3881"/><rect fill="#FFFFFF" height="21.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="973" y="464.7122"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="970.5" y="2472.1822"/><rect fill="#FFFFFF" height="249.0891" style="stroke:#181818;stroke-width:0.5;" width="5" x="1427" y="505.4182"/><rect fill="#FFFFFF" height="153.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1648" y="521.2712"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1650.5" y="572.8302"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1650.5" y="610.1832"/><rect fill="#FFFFFF" height="178.0301" style="stroke:#181818;stroke-width:0.5;" width="5" x="1648" y="770.3603"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1648" y="1844.9384"/><rect fill="#FFFFFF" height="138.9711" style="stroke:#181818;stroke-width:0.5;" width="5" x="1904.5" y="1032.5084"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:0.5;" width="5" x="1907" y="1084.0675"/><rect fill="#FFFFFF" height="34.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="1907" y="1121.4205"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="1904.5" y="1612.0697"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1904.5" y="1757.8203"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2089" y="537.1242"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2089" y="1048.3614"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="429.0062"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="643.5362"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="808.5663"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="840.2723"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="916.6844"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2200.25" y="1139.7735"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="691.0953"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="722.8013"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="1187.3325"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="1795.4528"/><rect fill="#FFFFFF" height="52.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="1882.5709"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2639.0062"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2693.0653"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2727.7713"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="2781.8303"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3399.4796"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3453.5386"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3488.2446"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2310.25" y="3542.3036"/><rect fill="#FFFFFF" height="26.206" style="stroke:#181818;stroke-width:0.5;" width="5" x="2448.25" y="964.2434"/><rect fill="#FFFFFF" height="573.6348" style="stroke:#181818;stroke-width:0.5;" width="5" x="2448.25" y="1016.6554"/><rect fill="#FFFFFF" height="334.6927" style="stroke:#181818;stroke-width:0.5;" width="5" x="2623.25" y="1255.5975"/><rect fill="#FFFFFF" height="1114.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="2623.25" y="2844.2423"/><rect fill="#FFFFFF" height="81.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="2625.75" y="3173.2435"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="2918.25" y="1339.7156"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="2918.25" y="1485.4662"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3231" y="3011.0664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3231" y="3065.1254"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="3231" y="3119.1844"/><polygon fill="#181818" points="254.75,45.74,259.75,47.74,254.75,49.74,256.75,47.74" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="47.74" y2="47.74"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="48.75" y="44.8355">Create Client("Bob", debugFlag, groupNameDH)</text><polygon fill="#181818" points="50.75,61.593,45.75,63.593,50.75,65.593,48.75,63.593" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="63.593" y2="63.593"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="31" x="53.75" y="60.6885">new Client</text><polygon fill="#181818" points="254.75,77.446,259.75,79.446,254.75,81.446,256.75,79.446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="79.446" y2="79.446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="130" x="48.75" y="76.5415">diffieHellmanKeyExchange(productionPort)</text><polygon fill="#181818" points="506.75,93.299,511.75,95.299,506.75,97.299,508.75,95.299" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="509.75" y1="95.299" y2="95.299"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="215.5" x="269.25" y="92.3945">Create DiffieHellman(_debugFlag, _parameterInjection, _groupNameDH)</text><polygon fill="#181818" points="691.25,109.152,696.25,111.152,691.25,113.152,693.25,111.152" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="517.75" x2="694.25" y1="111.152" y2="111.152"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="521.25" y="108.2475">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="523.25,125.005,518.25,127.005,523.25,129.005,521.25,127.005" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="520.25" x2="699.25" y1="127.005" y2="127.005"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="526.25" y="124.1005">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="520.25" x2="541.25" y1="142.858" y2="142.858"/><line style="stroke:#181818;stroke-width:0.5;" x1="541.25" x2="541.25" y1="142.858" y2="149.358"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.75" x2="541.25" y1="149.358" y2="149.358"/><polygon fill="#181818" points="525.75,147.358,520.75,149.358,525.75,151.358,523.75,149.358" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="523.75" y="139.9535">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="517.75" x2="541.25" y1="177.711" y2="177.711"/><line style="stroke:#181818;stroke-width:0.5;" x1="541.25" x2="541.25" y1="177.711" y2="184.211"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.75" x2="541.25" y1="184.211" y2="184.211"/><polygon fill="#181818" points="525.75,182.211,520.75,184.211,525.75,186.211,523.75,184.211" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="523.75" y="174.8065">generatePublicKey()</text><polygon fill="#181818" points="797,200.564,802,202.564,797,204.564,799,202.564" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.25" x2="800" y1="202.564" y2="202.564"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="523.75" y="199.6595">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="523.25,216.417,518.25,218.417,523.25,220.417,521.25,218.417" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="520.25" x2="805" y1="218.417" y2="218.417"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="526.25" y="215.5125">Public Key A (hex)</text><polygon fill="#181818" points="271.25,232.2701,266.25,234.2701,271.25,236.2701,269.25,234.2701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="514.75" y1="234.2701" y2="234.2701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="274.25" y="231.3656">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="901.5,248.1231,906.5,250.1231,901.5,252.1231,903.5,250.1231" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="904.5" y1="250.1231" y2="250.1231"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="269.25" y="247.2186">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="271.25,263.9761,266.25,265.9761,271.25,267.9761,269.25,265.9761" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="909.5" y1="265.9761" y2="265.9761"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47.5" x="274.25" y="263.0716">clientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="288.9321" y2="288.9321"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="288.9321" y2="295.4321"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="295.4321" y2="295.4321"/><polygon fill="#181818" points="271.25,293.4321,266.25,295.4321,271.25,297.4321,269.25,295.4321" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="269.25" y="286.0276">built "keyExchange" message</text><path d="M140.5,272.4761 L140.5,303.9761 L258,303.9761 L258,277.4761 L253,272.4761 L140.5,272.4761 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,272.4761 L253,277.4761 L258,277.4761 L253,272.4761 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107" x="143.5" y="281.9246">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="76.5" x="143.5" y="290.7776">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="72.5" x="143.5" y="299.6306">groupName, publicKeyA</text><polygon fill="#181818" points="964.5,316.3881,969.5,318.3881,964.5,320.3881,966.5,318.3881" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="967.5" y1="318.3881" y2="318.3881"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="269.25" y="315.4836">HTTP POST /keyExchange (ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="334.2411" y2="334.2411"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="334.2411" y2="340.7411"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="340.7411" y2="340.7411"/><polygon fill="#181818" points="981,338.7411,976,340.7411,981,342.7411,979,340.7411" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="979" y="331.3366">extract client's session id as extractedClientId</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="356.5941" y2="356.5941"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="356.5941" y2="363.0941"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="363.0941" y2="363.0941"/><polygon fill="#181818" points="981,361.0941,976,363.0941,981,365.0941,979,363.0941" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="137.5" x="979" y="353.6896">extract client's nonce as extractedNonceClient</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="378.9471" y2="378.9471"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="378.9471" y2="385.4471"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="385.4471" y2="385.4471"/><polygon fill="#181818" points="981,383.4471,976,385.4471,981,387.4471,979,385.4471" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156.5" x="979" y="376.0426">extract client's group name as extractedGroupName</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="403.9766" y2="403.9766"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="403.9766" y2="410.4766"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="410.4766" y2="410.4766"/><polygon fill="#181818" points="981,408.4766,976,410.4766,981,412.4766,979,410.4766" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="145.5" x="979" y="401.0721">extract client's public key as extractedPublicKeyA</text><path d="M1130.5,391.9471 L1130.5,414.4471 L1331,414.4471 L1331,396.9471 L1326,391.9471 L1130.5,391.9471 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1326,391.9471 L1326,396.9471 L1331,396.9471 L1326,391.9471 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89.5" x="1133.5" y="401.3956">Mallory intercepts ClientHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="190" x="1133.5" y="410.2486">He extracts client Id, client's Nonce, group name and public Key.</text><polygon fill="#181818" points="2194.25,427.0062,2199.25,429.0062,2194.25,431.0062,2196.25,429.0062" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2197.25" y1="429.0062" y2="429.0062"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132.5" x="979" y="426.1017">hexToUniqueBIGNUM(extractedPublicKeyA)</text><polygon fill="#181818" points="981,442.8592,976,444.8592,981,446.8592,979,444.8592" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2202.25" y1="444.8592" y2="444.8592"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="984" y="441.9547">peerPublicKey in UniqueBIGNUM format</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="999" y1="458.2122" y2="458.2122"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="458.2122" y2="464.7122"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="464.7122" y2="464.7122"/><polygon fill="#181818" points="983.5,462.7122,978.5,464.7122,983.5,466.7122,981.5,464.7122" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81.5" x="981.5" y="455.3077">generateUniqueSessionId()</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="999" y1="485.5652" y2="485.5652"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="999" x2="999" y1="485.5652" y2="492.0652"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="975.5" x2="999" y1="492.0652" y2="492.0652"/><polygon fill="#181818" points="980.5,490.0652,975.5,492.0652,980.5,494.0652,978.5,492.0652" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="28" x="981.5" y="482.6607">sessionId</text><polygon fill="#181818" points="1421,503.4182,1426,505.4182,1421,507.4182,1423,505.4182" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="1424" y1="505.4182" y2="505.4182"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="442" x="979" y="502.5137">Create MallorySessionData(_nonceSize, extractedNonceClient, extractedClientId, _debugFlag, _ivLength, extractedGroupName, _parameterInjection)</text><polygon fill="#181818" points="1642,519.2712,1647,521.2712,1642,523.2712,1644,521.2712" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1432" x2="1645" y1="521.2712" y2="521.2712"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="206.5" x="1435.5" y="518.3667">Create DiffieHellman(debugFlag, parameterInjection, groupNameDH)</text><polygon fill="#181818" points="2083,535.1242,2088,537.1242,2083,539.1242,2085,537.1242" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="2086" y1="537.1242" y2="537.1242"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1656.5" y="534.2197">loadDhParameters()</text><polygon fill="#181818" points="1658.5,550.9772,1653.5,552.9772,1658.5,554.9772,1656.5,552.9772" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1655.5" x2="2091" y1="552.9772" y2="552.9772"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1661.5" y="550.0727">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1655.5" x2="1676.5" y1="568.8302" y2="568.8302"/><line style="stroke:#181818;stroke-width:0.5;" x1="1676.5" x2="1676.5" y1="568.8302" y2="575.3302"/><line style="stroke:#181818;stroke-width:0.5;" x1="1656" x2="1676.5" y1="575.3302" y2="575.3302"/><polygon fill="#181818" points="1661,573.3302,1656,575.3302,1661,577.3302,1659,575.3302" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1659" y="565.9257">generatePrivateKey()</text><path d="M1728,561.2272 L1728,574.7272 L1844,574.7272 L1844,566.2272 L1839,561.2272 L1728,561.2272 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1839,561.2272 L1839,566.2272 L1844,566.2272 L1839,561.2272 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105.5" x="1731" y="570.6757">Mallory generates private key 'm_a'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1655.5" x2="1676.5" y1="606.1832" y2="606.1832"/><line style="stroke:#181818;stroke-width:0.5;" x1="1676.5" x2="1676.5" y1="606.1832" y2="612.6832"/><line style="stroke:#181818;stroke-width:0.5;" x1="1656" x2="1676.5" y1="612.6832" y2="612.6832"/><polygon fill="#181818" points="1661,610.6832,1656,612.6832,1661,614.6832,1659,612.6832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1659" y="603.2787">generatePublicKey()</text><path d="M1725,598.5802 L1725,612.0802 L1878.5,612.0802 L1878.5,603.5802 L1873.5,598.5802 L1725,598.5802 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1873.5,598.5802 L1873.5,603.5802 L1878.5,603.5802 L1873.5,598.5802 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="1728" y="608.0287">Mallory computes public key M_A = (g^m_a) % p</text><polygon fill="#181818" points="2194.25,641.5362,2199.25,643.5362,2194.25,645.5362,2196.25,643.5362" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="2197.25" y1="643.5362" y2="643.5362"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1656.5" y="640.6317">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1658.5,657.3892,1653.5,659.3892,1658.5,661.3892,1656.5,659.3892" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1655.5" x2="2202.25" y1="659.3892" y2="659.3892"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="1661.5" y="656.4847">Public Key M_A (hex)</text><polygon fill="#181818" points="1437.5,673.2423,1432.5,675.2423,1437.5,677.2423,1435.5,675.2423" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1434.5" x2="1650" y1="675.2423" y2="675.2423"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1440.5" y="672.3378">DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="2304.25,689.0953,2309.25,691.0953,2304.25,693.0953,2306.25,691.0953" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="691.0953" y2="691.0953"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="979" y="688.1908">generateCryptographicNonce(nonceSize))</text><polygon fill="#181818" points="981,704.9483,976,706.9483,981,708.9483,979,706.9483" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="706.9483" y2="706.9483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109.5" x="984" y="704.0438">result stored in _serverNonceHexAM</text><polygon fill="#181818" points="2304.25,720.8013,2309.25,722.8013,2304.25,724.8013,2306.25,722.8013" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="722.8013" y2="722.8013"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="979" y="719.8968">generateRandomIV(ivLength)</text><polygon fill="#181818" points="981,736.6543,976,738.6543,981,740.6543,979,738.6543" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="738.6543" y2="738.6543"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="984" y="735.7498">result stored in _ivAM</text><polygon fill="#181818" points="981,752.5073,976,754.5073,981,756.5073,979,754.5073" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="1429" y1="754.5073" y2="754.5073"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="228" x="984" y="751.6028">returns mallorySessionData, stored in the map _diffieHellmanMap[sessionId]</text><polygon fill="#181818" points="1642,768.3603,1647,770.3603,1642,772.3603,1644,770.3603" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="1645" y1="770.3603" y2="770.3603"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="440" x="979" y="767.4558">deriveSharedSecret(extractedPublicKeyA, _diffieHellmanMap[sessionId]-&gt;_serverNonceHexAM, _diffieHellmanMap[sessionId]-&gt;_clientNonceHexAM)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="1674" y1="786.2133" y2="786.2133"/><line style="stroke:#181818;stroke-width:0.5;" x1="1674" x2="1674" y1="786.2133" y2="792.7133"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653.5" x2="1674" y1="792.7133" y2="792.7133"/><polygon fill="#181818" points="1658.5,790.7133,1653.5,792.7133,1658.5,794.7133,1656.5,792.7133" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1656.5" y="783.3088">_sharedSecret = (peerPublicKey ^ _privateKey) % _p</text><polygon fill="#181818" points="2194.25,806.5663,2199.25,808.5663,2194.25,810.5663,2196.25,808.5663" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="2197.25" y1="808.5663" y2="808.5663"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89" x="1656.5" y="805.6618">hexToBytes(serverNonceHex)</text><polygon fill="#181818" points="1658.5,822.4193,1653.5,824.4193,1658.5,826.4193,1656.5,824.4193" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1655.5" x2="2202.25" y1="824.4193" y2="824.4193"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="54.5" x="1661.5" y="821.5148">serverNonceBytes</text><polygon fill="#181818" points="2194.25,838.2723,2199.25,840.2723,2194.25,842.2723,2196.25,840.2723" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="2197.25" y1="840.2723" y2="840.2723"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="86.5" x="1656.5" y="837.3678">hexToBytes(clientNonceHex)</text><polygon fill="#181818" points="1658.5,854.1253,1653.5,856.1253,1658.5,858.1253,1656.5,856.1253" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1655.5" x2="2202.25" y1="856.1253" y2="856.1253"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52" x="1661.5" y="853.2208">clientNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="1674" y1="871.9784" y2="871.9784"/><line style="stroke:#181818;stroke-width:0.5;" x1="1674" x2="1674" y1="871.9784" y2="878.4784"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653.5" x2="1674" y1="878.4784" y2="878.4784"/><polygon fill="#181818" points="1658.5,876.4784,1653.5,878.4784,1658.5,880.4784,1656.5,878.4784" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="244.5" x="1656.5" y="869.0739">dataToHash = shared_secret_raw_bytes || clientNonceBytes || serverNonceBytes</text><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="1674" y1="894.3314" y2="894.3314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1674" x2="1674" y1="894.3314" y2="900.8314"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653.5" x2="1674" y1="900.8314" y2="900.8314"/><polygon fill="#181818" points="1658.5,898.8314,1653.5,900.8314,1658.5,902.8314,1656.5,900.8314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138.5" x="1656.5" y="891.4269">_derivedSymmetricKey = SHA256(dataToHash)</text><polygon fill="#181818" points="2194.25,914.6844,2199.25,916.6844,2194.25,918.6844,2196.25,916.6844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1653" x2="2197.25" y1="916.6844" y2="916.6844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="109" x="1656.5" y="913.7799">toHexString(_derivedSymmetricKey)</text><polygon fill="#181818" points="1658.5,930.5374,1653.5,932.5374,1658.5,934.5374,1656.5,932.5374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1655.5" x2="2202.25" y1="932.5374" y2="932.5374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127" x="1661.5" y="929.6329">result stored in _derivedSymmetricKeyHex</text><polygon fill="#181818" points="981,946.3904,976,948.3904,981,950.3904,979,948.3904" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="1650" y1="948.3904" y2="948.3904"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115" x="984" y="945.4859">result stored in _derivedSymmetricKey</text><polygon fill="#181818" points="2442.25,962.2434,2447.25,964.2434,2442.25,966.2434,2444.25,964.2434" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2445.25" y1="964.2434" y2="964.2434"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="352" x="979" y="961.3389">generate fake client: Client(_diffieHellmanMap[sessionId]-&gt;_clientIdAM, _debugFlag, groupName, _parameterInjection)</text><polygon fill="#181818" points="981,988.4494,976,990.4494,981,992.4494,979,990.4494" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2450.25" y1="990.4494" y2="990.4494"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30" x="984" y="987.5449">new client</text><path d="M782,970.7434 L782,1002.2434 L968,1002.2434 L968,975.7434 L963,970.7434 L782,970.7434 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,970.7434 L963,975.7434 L968,975.7434 L963,970.7434 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="785" y="980.1919">Mallory constructs her own ClientHello to Server</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="116.5" x="785" y="989.0449">with Client's Id, malloryNonceToServer,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="175.5" x="785" y="997.8979">groupName, publicKeyM_S (Mallory's public key for Server)</text><polygon fill="#181818" points="2442.25,1014.6554,2447.25,1016.6554,2442.25,1018.6554,2444.25,1016.6554" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2445.25" y1="1016.6554" y2="1016.6554"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168" x="979" y="1013.7509">diffieHellmanKeyExchange(const int portServerNumber)</text><polygon fill="#181818" points="1915,1030.5084,1910,1032.5084,1915,1034.5084,1913,1032.5084" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1912" x2="2447.75" y1="1032.5084" y2="1032.5084"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="215.5" x="1918" y="1029.6039">Create DiffieHellman(_debugFlag, _parameterInjection, _groupNameDH)</text><polygon fill="#181818" points="2083,1046.3614,2088,1048.3614,2083,1050.3614,2085,1048.3614" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1909.5" x2="2086" y1="1048.3614" y2="1048.3614"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="1913" y="1045.4569">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="1915,1062.2145,1910,1064.2145,1915,1066.2145,1913,1064.2145" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1912" x2="2091" y1="1064.2145" y2="1064.2145"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1918" y="1061.31">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1912" x2="1933" y1="1080.0675" y2="1080.0675"/><line style="stroke:#181818;stroke-width:0.5;" x1="1933" x2="1933" y1="1080.0675" y2="1086.5675"/><line style="stroke:#181818;stroke-width:0.5;" x1="1912.5" x2="1933" y1="1086.5675" y2="1086.5675"/><polygon fill="#181818" points="1917.5,1084.5675,1912.5,1086.5675,1917.5,1088.5675,1915.5,1086.5675" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1915.5" y="1077.163">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="1909.5" x2="1933" y1="1114.9205" y2="1114.9205"/><line style="stroke:#181818;stroke-width:0.5;" x1="1933" x2="1933" y1="1114.9205" y2="1121.4205"/><line style="stroke:#181818;stroke-width:0.5;" x1="1912.5" x2="1933" y1="1121.4205" y2="1121.4205"/><polygon fill="#181818" points="1917.5,1119.4205,1912.5,1121.4205,1917.5,1123.4205,1915.5,1121.4205" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1915.5" y="1112.016">generatePublicKey()</text><polygon fill="#181818" points="2194.25,1137.7735,2199.25,1139.7735,2194.25,1141.7735,2196.25,1139.7735" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1912" x2="2197.25" y1="1139.7735" y2="1139.7735"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1915.5" y="1136.869">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1915,1153.6265,1910,1155.6265,1915,1157.6265,1913,1155.6265" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1912" x2="2202.25" y1="1155.6265" y2="1155.6265"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="1918" y="1152.722">Public Key M_S (hex)</text><polygon fill="#181818" points="2442.25,1169.4795,2447.25,1171.4795,2442.25,1173.4795,2444.25,1171.4795" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1907" x2="2445.25" y1="1171.4795" y2="1171.4795"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="1910.5" y="1168.575">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="2320.75,1185.3325,2315.75,1187.3325,2320.75,1189.3325,2318.75,1187.3325" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2317.75" x2="2447.75" y1="1187.3325" y2="1187.3325"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="2323.75" y="1184.428">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="2442.25,1201.1855,2447.25,1203.1855,2442.25,1205.1855,2444.25,1203.1855" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2312.75" x2="2445.25" y1="1203.1855" y2="1203.1855"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61" x="2316.25" y="1200.281">fakeClientNonceHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="2453.25" x2="2474.25" y1="1226.1415" y2="1226.1415"/><line style="stroke:#181818;stroke-width:0.5;" x1="2474.25" x2="2474.25" y1="1226.1415" y2="1232.6415"/><line style="stroke:#181818;stroke-width:0.5;" x1="2453.75" x2="2474.25" y1="1232.6415" y2="1232.6415"/><polygon fill="#181818" points="2458.75,1230.6415,2453.75,1232.6415,2458.75,1234.6415,2456.75,1232.6415" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="87.5" x="2456.75" y="1223.237">built "keyExchange" message</text><path d="M2313.5,1209.6855 L2313.5,1241.1855 L2445.5,1241.1855 L2445.5,1214.6855 L2440.5,1209.6855 L2313.5,1209.6855 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2440.5,1209.6855 L2440.5,1214.6855 L2445.5,1214.6855 L2440.5,1209.6855 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121.5" x="2316.5" y="1219.134">Fake client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="102.5" x="2316.5" y="1227.987">with real clientId, fakeClientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="81" x="2316.5" y="1236.84">groupName, publicKeyM_S</text><polygon fill="#181818" points="2617.25,1253.5975,2622.25,1255.5975,2617.25,1257.5975,2619.25,1255.5975" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2453.25" x2="2620.25" y1="1255.5975" y2="1255.5975"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="160.5" x="2456.75" y="1252.693">HTTP POST /keyExchange (Mallory's ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="1278.5536" y2="1278.5536"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="1278.5536" y2="1285.0536"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="1285.0536" y2="1285.0536"/><polygon fill="#181818" points="2633.75,1283.0536,2628.75,1285.0536,2633.75,1287.0536,2631.75,1285.0536" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="2631.75" y="1275.6491">Parse ClientHello JSON (from Mallory)</text><path d="M2749,1262.0975 L2749,1293.5975 L2901,1293.5975 L2901,1267.0975 L2896,1262.0975 L2749,1262.0975 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2896,1262.0975 L2896,1267.0975 L2901,1267.0975 L2896,1262.0975 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="135.5" x="2752" y="1271.5461">Server extracts MalloryId (thinks it's client ID),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141.5" x="2752" y="1280.3991">malloryNonceToServer (thinks it's client nonce),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="129" x="2752" y="1289.2521">publicKeyM_S (thinks it's client publicKeyA).</text><polygon fill="#181818" points="3227.5,1306.0096,3232.5,1308.0096,3227.5,1310.0096,3229.5,1308.0096" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="3230.5" y1="1308.0096" y2="1308.0096"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="2631.75" y="1305.1051">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="2633.75,1321.8626,2628.75,1323.8626,2633.75,1325.8626,2631.75,1323.8626" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="3233" y1="1323.8626" y2="1323.8626"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="50" x="2636.75" y="1320.9581">serverNonceHex</text><polygon fill="#181818" points="2912.25,1337.7156,2917.25,1339.7156,2912.25,1341.7156,2914.25,1339.7156" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2915.25" y1="1339.7156" y2="1339.7156"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97" x="2631.75" y="1336.8111">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="3013.25,1353.5686,3018.25,1355.5686,3013.25,1357.5686,3015.25,1355.5686" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2923.25" x2="3016.25" y1="1355.5686" y2="1355.5686"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2926.75" y="1352.6641">loadDhParameters()</text><polygon fill="#181818" points="2928.75,1369.4216,2923.75,1371.4216,2928.75,1373.4216,2926.75,1371.4216" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2925.75" x2="3018.75" y1="1371.4216" y2="1371.4216"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="2931.75" y="1368.5171">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="2923.25" x2="2944.25" y1="1387.2746" y2="1387.2746"/><line style="stroke:#181818;stroke-width:0.5;" x1="2944.25" x2="2944.25" y1="1387.2746" y2="1393.7746"/><line style="stroke:#181818;stroke-width:0.5;" x1="2923.75" x2="2944.25" y1="1393.7746" y2="1393.7746"/><polygon fill="#181818" points="2928.75,1391.7746,2923.75,1393.7746,2928.75,1395.7746,2926.75,1393.7746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="2926.75" y="1384.3701">generatePrivateKey()</text><path d="M2995.5,1379.6716 L2995.5,1393.1716 L3099.5,1393.1716 L3099.5,1384.6716 L3094.5,1379.6716 L2995.5,1379.6716 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3094.5,1379.6716 L3094.5,1384.6716 L3099.5,1384.6716 L3094.5,1379.6716 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93.5" x="2998.5" y="1389.1201">Server generates private key 'b'</text><line style="stroke:#181818;stroke-width:0.5;" x1="2923.25" x2="2944.25" y1="1409.6276" y2="1409.6276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2944.25" x2="2944.25" y1="1409.6276" y2="1416.1276"/><line style="stroke:#181818;stroke-width:0.5;" x1="2923.75" x2="2944.25" y1="1416.1276" y2="1416.1276"/><polygon fill="#181818" points="2928.75,1414.1276,2923.75,1416.1276,2928.75,1418.1276,2926.75,1416.1276" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2926.75" y="1406.7231">generatePublicKey()</text><path d="M2992.5,1402.0246 L2992.5,1415.5246 L3093.5,1415.5246 L3093.5,1407.0246 L3088.5,1402.0246 L2992.5,1402.0246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3088.5,1402.0246 L3088.5,1407.0246 L3093.5,1407.0246 L3088.5,1402.0246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="90.5" x="2995.5" y="1411.4731">Server computes B = (g^b) % p</text><polygon fill="#181818" points="3121,1429.9806,3126,1431.9806,3121,1433.9806,3123,1431.9806" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2923.25" x2="3124" y1="1431.9806" y2="1431.9806"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="2926.75" y="1429.0761">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2926.25,1445.8336,2921.25,1447.8336,2926.25,1449.8336,2924.25,1447.8336" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2923.25" x2="3126.5" y1="1447.8336" y2="1447.8336"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="2929.25" y="1444.9291">Public Key B (hex)</text><polygon fill="#181818" points="2633.75,1461.6867,2628.75,1463.6867,2633.75,1465.6867,2631.75,1463.6867" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="2920.25" y1="1463.6867" y2="1463.6867"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105.5" x="2636.75" y="1460.7822">Server:DiffieHellman instance ready</text><polygon fill="#181818" points="2912.25,1483.4662,2917.25,1485.4662,2912.25,1487.4662,2914.25,1485.4662" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2915.25" y1="1485.4662" y2="1485.4662"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="2631.75" y="1482.5617">deriveSharedSecret(publicKeyM_A, serverNonceHex, malloryNonceToClient)</text><path d="M2925.5,1470.1867 L2925.5,1492.6867 L3157,1492.6867 L3157,1475.1867 L3152,1470.1867 L2925.5,1470.1867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M3152,1470.1867 L3152,1475.1867 L3157,1475.1867 L3152,1470.1867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="221" x="2928.5" y="1479.6352">Server computes shared secret s'_M_S = (publicKeyM_A ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="157.5" x="2928.5" y="1488.4882">This is the shared secret between Mallory and Server.</text><polygon fill="#181818" points="2633.75,1505.2457,2628.75,1507.2457,2633.75,1509.2457,2631.75,1507.2457" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="2920.25" y1="1507.2457" y2="1507.2457"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93" x="2636.75" y="1504.3412">_derivedSymmetricKeyHex_MS</text><polygon fill="#181818" points="3227.5,1521.0987,3232.5,1523.0987,3227.5,1525.0987,3229.5,1523.0987" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="3230.5" y1="1523.0987" y2="1523.0987"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="290" x="2631.75" y="1520.1942">encryptMessageAes256CbcMode(confirmationMsg, _derivedSymmetricKeyHex_MS, generatedIv)</text><polygon fill="#181818" points="2633.75,1551.7312,2628.75,1553.7312,2633.75,1555.7312,2631.75,1553.7312" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="3233" y1="1553.7312" y2="1553.7312"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43" x="2636.75" y="1550.8267">ciphertext_MS</text><path d="M2458.5,1529.5987 L2458.5,1569.5987 L2620.5,1569.5987 L2620.5,1534.5987 L2615.5,1529.5987 L2458.5,1529.5987 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2615.5,1529.5987 L2615.5,1534.5987 L2620.5,1534.5987 L2615.5,1529.5987 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138" x="2461.5" y="1539.0472">Server constructs JSON response (ServerHello)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121" x="2461.5" y="1547.9002">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="2461.5" y="1556.7532">encrypted confirmation (ciphertext_MS, ivHex_MS)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="2461.5" y="1565.6062">Server believes it's sending to "Bob" (Mallory)</text><polygon fill="#181818" points="2456.25,1588.2902,2451.25,1590.2902,2456.25,1592.2902,2454.25,1590.2902" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2453.25" x2="2625.25" y1="1590.2902" y2="1590.2902"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95.5" x="2459.25" y="1587.3857">HTTP 201 OK (ServerHello JSON)</text><path d="M2630.5,1575.0107 L2630.5,1597.5107 L2861.5,1597.5107 L2861.5,1580.0107 L2856.5,1575.0107 L2630.5,1575.0107 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2856.5,1575.0107 L2856.5,1580.0107 L2861.5,1580.0107 L2856.5,1575.0107 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="2633.5" y="1584.4592">Mallory's fake client intercepts ServerHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="220.5" x="2633.5" y="1593.3122">He extracts sessionId, serverNonce, publicKeyB, ciphertext_MS, ivHex_MS.</text><polygon fill="#181818" points="1898.5,1610.0697,1903.5,1612.0697,1898.5,1614.0697,1900.5,1612.0697" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="1901.5" y1="1612.0697" y2="1612.0697"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97" x="979" y="1609.1652">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="2085.5,1625.9228,2090.5,1627.9228,2085.5,1629.9228,2087.5,1627.9228" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1909.5" x2="2088.5" y1="1627.9228" y2="1627.9228"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1913" y="1625.0183">loadDhParameters()</text><polygon fill="#181818" points="1915,1641.7758,1910,1643.7758,1915,1645.7758,1913,1643.7758" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1912" x2="2091" y1="1643.7758" y2="1643.7758"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1918" y="1640.8713">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1909.5" x2="1930.5" y1="1659.6288" y2="1659.6288"/><line style="stroke:#181818;stroke-width:0.5;" x1="1930.5" x2="1930.5" y1="1659.6288" y2="1666.1288"/><line style="stroke:#181818;stroke-width:0.5;" x1="1910" x2="1930.5" y1="1666.1288" y2="1666.1288"/><polygon fill="#181818" points="1915,1664.1288,1910,1666.1288,1915,1668.1288,1913,1666.1288" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1913" y="1656.7243">generatePrivateKey()</text><path d="M1982,1652.0258 L1982,1665.5258 L2098.5,1665.5258 L2098.5,1657.0258 L2093.5,1652.0258 L1982,1652.0258 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2093.5,1652.0258 L2093.5,1657.0258 L2098.5,1657.0258 L2093.5,1652.0258 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="106" x="1985" y="1661.4743">Mallory generates private key 'm_b'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1909.5" x2="1930.5" y1="1681.9818" y2="1681.9818"/><line style="stroke:#181818;stroke-width:0.5;" x1="1930.5" x2="1930.5" y1="1681.9818" y2="1688.4818"/><line style="stroke:#181818;stroke-width:0.5;" x1="1910" x2="1930.5" y1="1688.4818" y2="1688.4818"/><polygon fill="#181818" points="1915,1686.4818,1910,1688.4818,1915,1690.4818,1913,1688.4818" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1913" y="1679.0773">generatePublicKey()</text><path d="M1979,1674.3788 L1979,1687.8788 L2133,1687.8788 L2133,1679.3788 L2128,1674.3788 L1979,1674.3788 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2128,1674.3788 L2128,1679.3788 L2133,1679.3788 L2128,1674.3788 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143.5" x="1982" y="1683.8273">Mallory computes public key M_B = (g^m_b) % p</text><polygon fill="#181818" points="2196.75,1702.3348,2201.75,1704.3348,2196.75,1706.3348,2198.75,1704.3348" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1909.5" x2="2199.75" y1="1704.3348" y2="1704.3348"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1913" y="1701.4303">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1912.5,1718.1878,1907.5,1720.1878,1912.5,1722.1878,1910.5,1720.1878" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1909.5" x2="2202.25" y1="1720.1878" y2="1720.1878"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="1915.5" y="1717.2833">Public Key M_B (hex)</text><polygon fill="#181818" points="981,1734.0408,976,1736.0408,981,1738.0408,979,1736.0408" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="1906.5" y1="1736.0408" y2="1736.0408"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141.5" x="984" y="1733.1363">Mallory:DiffieHellman instance (to Server) ready</text><polygon fill="#181818" points="1898.5,1755.8203,1903.5,1757.8203,1898.5,1759.8203,1900.5,1757.8203" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="1901.5" y1="1757.8203" y2="1757.8203"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="217.5" x="979" y="1754.9158">deriveSharedSecret(publicKeyB, malloryNonceToClient, serverNonceHex)</text><path d="M1912,1742.5408 L1912,1765.0408 L2148,1765.0408 L2148,1747.5408 L2143,1742.5408 L1912,1742.5408 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2143,1742.5408 L2143,1747.5408 L2148,1747.5408 L2143,1742.5408 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="223" x="1915" y="1751.9893">Mallory computes shared secret s_M_S = (publicKeyB ^ privateKeyM_B) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="225.5" x="1915" y="1760.8423">This is the same secret as _derivedSymmetricKeyHex_MS on the Server side.</text><polygon fill="#181818" points="981,1777.5998,976,1779.5998,981,1781.5998,979,1779.5998" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="1906.5" y1="1779.5998" y2="1779.5998"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93" x="984" y="1776.6953">_derivedSymmetricKeyHex_MS</text><polygon fill="#181818" points="2304.25,1793.4528,2309.25,1795.4528,2304.25,1797.4528,2306.25,1795.4528" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="1795.4528" y2="1795.4528"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="262.5" x="979" y="1792.5483">decryptMessageAes256CbcMode(ciphertext_MS, _derivedSymmetricKeyHex_MS, iv_MS)</text><polygon fill="#181818" points="981,1815.2323,976,1817.2323,981,1819.2323,979,1817.2323" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="1817.2323" y2="1817.2323"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="69.5" x="984" y="1814.3278">decryptedPlaintext_MS</text><path d="M2317.5,1801.9528 L2317.5,1824.4528 L2538,1824.4528 L2538,1806.9528 L2533,1801.9528 L2317.5,1801.9528 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2533,1801.9528 L2533,1806.9528 L2538,1806.9528 L2533,1801.9528 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="210" x="2320.5" y="1811.4013">Mallory now has the decrypted confirmation message from the Server.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103" x="2320.5" y="1820.2543">She can read it, modify it if desired.</text><polygon fill="#181818" points="1642,1842.9384,1647,1844.9384,1642,1846.9384,1644,1844.9384" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="1645" y1="1844.9384" y2="1844.9384"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="215" x="979" y="1842.0339">deriveSharedSecret(publicKeyA, clientNonceHex, malloryNonceToClient)</text><path d="M1655.5,1829.6589 L1655.5,1852.1589 L1889.5,1852.1589 L1889.5,1834.6589 L1884.5,1829.6589 L1655.5,1829.6589 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1884.5,1829.6589 L1884.5,1834.6589 L1889.5,1834.6589 L1884.5,1829.6589 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="223.5" x="1658.5" y="1839.1074">Mallory computes shared secret s_A_M = (publicKeyA ^ privateKeyM_A) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1658.5" y="1847.9604">This is the shared secret between Alice and Mallory.</text><polygon fill="#181818" points="981,1864.7179,976,1866.7179,981,1868.7179,979,1866.7179" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="1650" y1="1866.7179" y2="1866.7179"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93.5" x="984" y="1863.8134">_derivedSymmetricKeyHex_AM</text><polygon fill="#181818" points="2304.25,1880.5709,2309.25,1882.5709,2304.25,1884.5709,2306.25,1882.5709" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="1882.5709" y2="1882.5709"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="391.5" x="979" y="1879.6664">encryptMessageAes256CbcMode(decryptedPlaintext_MS_possibly_modified, _derivedSymmetricKeyHex_AM, newGeneratedIv_AM)</text><polygon fill="#181818" points="981,1933.3359,976,1935.3359,981,1937.3359,979,1935.3359" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="1935.3359" y2="1935.3359"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="984" y="1932.4314">ciphertext_AM</text><path d="M726.5,1889.0709 L726.5,1973.5709 L968,1973.5709 L968,1894.0709 L963,1889.0709 L726.5,1889.0709 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,1889.0709 L963,1894.0709 L968,1894.0709 L963,1889.0709 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="729.5" y="1898.5194">Mallory constructs her own ServerHello to Client</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="186.5" x="729.5" y="1907.3724">with original sessionId, serverNonce (Mallory's), publicKeyM_B,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="119.5" x="729.5" y="1916.2254">encrypted confirmation (ciphertext_AM)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="729.5" y="1925.0784">Mallory sends her own public key (M_B) to the client,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="729.5" y="1933.9314">making Alice believe M_B is Bob's public key.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="729.5" y="1942.7844">Mallory uses the server's nonce she intercepted,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="729.5" y="1951.6374">or generates a new one, depending on the scenario.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197.5" x="729.5" y="1960.4904">For simplicity here, let's say she forwards the original serverNonce.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="231" x="729.5" y="1969.3435">(Or rather, the one she sent to the server as 'clientNonce' for her own session)</text><polygon fill="#181818" points="271.25,1986.101,266.25,1988.101,271.25,1990.101,269.25,1988.101" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="972.5" y1="1988.101" y2="1988.101"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="274.25" y="1985.1965">HTTP 201 OK (Mallory's ServerHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2006.6305" y2="2006.6305"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2006.6305" y2="2013.1305"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2013.1305" y2="2013.1305"/><polygon fill="#181818" points="271.25,2011.1305,266.25,2013.1305,271.25,2015.1305,269.25,2013.1305" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142.5" x="269.25" y="2003.726">Parse ServerHello JSON response (from Mallory)</text><path d="M417.5,1994.601 L417.5,2017.101 L627,2017.101 L627,1999.601 L622,1994.601 L417.5,1994.601 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M622,1994.601 L622,1999.601 L627,1999.601 L622,1994.601 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="420.5" y="2004.0495">Client extracts sessionId, serverNonce (Mallory's),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199" x="420.5" y="2012.9025">groupName, publicKeyB (Mallory's M_B), ciphertext_AM, ivHex_AM</text><polygon fill="#181818" points="799.5,2029.66,804.5,2031.66,799.5,2033.66,801.5,2031.66" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="802.5" y1="2031.66" y2="2031.66"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="69" x="269.25" y="2028.7555">hexToBytes(ivHex_AM)</text><polygon fill="#181818" points="271.25,2045.513,266.25,2047.513,271.25,2049.513,269.25,2047.513" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="805" y1="2047.513" y2="2047.513"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="57.5" x="274.25" y="2044.6085">iv (vector&lt;uint8_t&gt;)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2063.366" y2="2063.366"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2063.366" y2="2069.866"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2069.866" y2="2069.866"/><polygon fill="#181818" points="271.25,2067.866,266.25,2069.866,271.25,2071.866,269.25,2069.866" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118.5" x="269.25" y="2060.4615">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="506.75,2089.6455,511.75,2091.6455,506.75,2093.6455,508.75,2091.6455" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="509.75" y1="2091.6455" y2="2091.6455"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="198.5" x="269.25" y="2088.741">deriveSharedSecret(publicKeyB, serverNonceHex, clientNonceHex)</text><path d="M520,2076.366 L520,2098.866 L732.5,2098.866 L732.5,2081.366 L727.5,2076.366 L520,2076.366 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M727.5,2076.366 L727.5,2081.366 L732.5,2081.366 L727.5,2076.366 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="523" y="2085.8145">Client computes shared secret s = (publicKeyM_B ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="174.5" x="523" y="2094.6675">This is the shared secret between Client (Alice) and Mallory.</text><polygon fill="#181818" points="271.25,2111.425,266.25,2113.425,271.25,2115.425,269.25,2113.425" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="514.75" y1="2113.425" y2="2113.425"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="136" x="274.25" y="2110.5205">_derivedSymmetricKeyHex (Alice-Mallory key)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="289.25" y1="2126.778" y2="2126.778"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2126.778" y2="2133.278"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2133.278" y2="2133.278"/><polygon fill="#181818" points="273.75,2131.278,268.75,2133.278,273.75,2135.278,271.75,2133.278" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95" x="271.75" y="2123.8735">confirmationServerResponse(...)</text><polygon fill="#181818" points="901.5,2149.6311,906.5,2151.6311,901.5,2153.6311,903.5,2151.6311" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="904.5" y1="2151.6311" y2="2151.6311"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="238" x="271.75" y="2148.7265">decryptMessageAes256CbcMode(ciphertext_AM, _derivedSymmetricKeyHex, iv)</text><polygon fill="#181818" points="273.75,2165.4841,268.75,2167.4841,273.75,2169.4841,271.75,2167.4841" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="909.5" y1="2167.4841" y2="2167.4841"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="101" x="276.75" y="2164.5796">decryptedPlaintext (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2194.8666" y2="2194.8666"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2194.8666" y2="2201.3666"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2201.3666" y2="2201.3666"/><polygon fill="#181818" points="273.75,2199.3666,268.75,2201.3666,273.75,2203.3666,271.75,2201.3666" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96" x="271.75" y="2191.9621">Parse decryptedPlaintext (JSON)</text><path d="M373.5,2173.9841 L373.5,2213.9841 L568.5,2213.9841 L568.5,2178.9841 L563.5,2173.9841 L373.5,2173.9841 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M563.5,2173.9841 L563.5,2178.9841 L568.5,2178.9841 L563.5,2173.9841 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96.5" x="376.5" y="2183.4326">Client compares extracted fields.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="150.5" x="376.5" y="2192.2856">Since Mallory forwarded a valid (possibly modified)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="376.5" y="2201.1386">confirmation, this validation will likely pass,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="184.5" x="376.5" y="2209.9916">making Alice believe she successfully communicated with Bob.</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="289.25" y1="2231.2491" y2="2231.2491"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="289.25" x2="289.25" y1="2231.2491" y2="2237.7491"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="265.75" x2="289.25" y1="2237.7491" y2="2237.7491"/><polygon fill="#181818" points="270.75,2235.7491,265.75,2237.7491,270.75,2239.7491,268.75,2237.7491" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="271.75" y="2228.3446">(bool validationResult, string decryptedMessage)</text><path d="M5,2242.7491 L36.5,2242.7491 L36.5,2247.6021 L31.5,2252.6021 L5,2252.6021 L5,2242.7491 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="434.75" x="5" y="2242.7491"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="12.5" y="2250.1976">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="69.5" x="44" y="2249.6286">[validationResult == true]</text><polygon fill="#181818" points="50.75,2263.9551,45.75,2265.9551,50.75,2267.9551,48.75,2265.9551" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="2265.9551" y2="2265.9551"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="203.5" x="53.75" y="2263.0506">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><path d="M268,2255.1021 L268,2268.6021 L434.5,2268.6021 L434.5,2260.1021 L429.5,2255.1021 L268,2255.1021 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M429.5,2255.1021 L429.5,2260.1021 L434.5,2260.1021 L429.5,2255.1021 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="271" y="2264.5506">Client is unaware it succeeded with Mallory, not Bob.</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="5" x2="439.75" y1="2271.9551" y2="2271.9551"/><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="70.5" x="7.5" y="2277.8346">[validationResult == false]</text><polygon fill="#181818" points="50.75,2289.7991,45.75,2291.7991,50.75,2293.7991,48.75,2291.7991" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="260.25" y1="2291.7991" y2="2291.7991"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="53.75" y="2288.8946">Logs "Diffie Hellman key exchange failed"</text><polygon fill="#181818" points="254.75,2309.1521,259.75,2311.1521,254.75,2313.1521,256.75,2311.1521" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="2311.1521" y2="2311.1521"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147.5" x="48.75" y="2308.2476">messageExchange(portServerNumber, sessionId)</text><polygon fill="#181818" points="901.5,2325.0051,906.5,2327.0051,901.5,2329.0051,903.5,2327.0051" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="904.5" y1="2327.0051" y2="2327.0051"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="269.25" y="2324.1006">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="271.25,2340.8581,266.25,2342.8581,271.25,2344.8581,269.25,2342.8581" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="909.5" y1="2342.8581" y2="2342.8581"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="41" x="274.25" y="2339.9536">newIVrotated</text><polygon fill="#181818" points="901.5,2356.7111,906.5,2358.7111,901.5,2360.7111,903.5,2358.7111" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="904.5" y1="2358.7111" y2="2358.7111"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="79.5" x="269.25" y="2355.8066">getFormattedTimestamp()</text><polygon fill="#181818" points="271.25,2372.5641,266.25,2374.5641,271.25,2376.5641,269.25,2374.5641" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="909.5" y1="2374.5641" y2="2374.5641"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="46.5" x="274.25" y="2371.6596">newTimeStamp</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2390.4171" y2="2390.4171"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2390.4171" y2="2396.9171"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2396.9171" y2="2396.9171"/><polygon fill="#181818" points="271.25,2394.9171,266.25,2396.9171,271.25,2398.9171,269.25,2396.9171" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="240" x="269.25" y="2387.5126">built message sent with clientId, sessionId, newTimeStamp as clientMessageSent</text><polygon fill="#181818" points="901.5,2410.7701,906.5,2412.7701,901.5,2414.7701,903.5,2412.7701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="904.5" y1="2412.7701" y2="2412.7701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="282.5" x="269.25" y="2409.8656">encryptMessageAes256CbcMode(newPlaintext, _derivedSymmetricKeyHex_AM, newIVrotated)</text><polygon fill="#181818" points="271.25,2426.6231,266.25,2428.6231,271.25,2430.6231,269.25,2428.6231" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="909.5" y1="2428.6231" y2="2428.6231"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="274.25" y="2425.7186">ciphertext_AM</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="2447.1526" y2="2447.1526"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="2447.1526" y2="2453.6526"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="2453.6526" y2="2453.6526"/><polygon fill="#181818" points="271.25,2451.6526,266.25,2453.6526,271.25,2455.6526,269.25,2453.6526" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="269.25" y="2444.2481">built "client_message_exchange" message</text><path d="M96.5,2435.1231 L96.5,2457.6231 L258,2457.6231 L258,2440.1231 L253,2435.1231 L96.5,2435.1231 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,2435.1231 L253,2440.1231 L258,2440.1231 L253,2435.1231 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151" x="99.5" y="2444.5716">Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="99.5" y="2453.4246">with sessionId, newIVrotated and ciphertext</text><polygon fill="#181818" points="964.5,2470.1822,969.5,2472.1822,964.5,2474.1822,966.5,2472.1822" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="967.5" y1="2472.1822" y2="2472.1822"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="269.25" y="2469.2777">HTTP POST /messageExchange (client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2488.0352" y2="2488.0352"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2488.0352" y2="2494.5352"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2494.5352" y2="2494.5352"/><polygon fill="#181818" points="981,2492.5352,976,2494.5352,981,2496.5352,979,2494.5352" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="979" y="2485.1307">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2510.3882" y2="2510.3882"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2510.3882" y2="2516.8882"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2516.8882" y2="2516.8882"/><polygon fill="#181818" points="981,2514.8882,976,2516.8882,981,2518.8882,979,2516.8882" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="979" y="2507.4837">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2532.7412" y2="2532.7412"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2532.7412" y2="2539.2412"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2539.2412" y2="2539.2412"/><polygon fill="#181818" points="981,2537.2412,976,2539.2412,981,2541.2412,979,2539.2412" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="979" y="2529.8367">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2555.0942" y2="2555.0942"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2555.0942" y2="2561.5942"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2561.5942" y2="2561.5942"/><polygon fill="#181818" points="981,2559.5942,976,2561.5942,981,2563.5942,979,2561.5942" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="979" y="2552.1897">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2577.4472" y2="2577.4472"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2577.4472" y2="2583.9472"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2583.9472" y2="2583.9472"/><polygon fill="#181818" points="981,2581.9472,976,2583.9472,981,2585.9472,979,2583.9472" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="979" y="2574.5427">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M952,2591.4472 L983.5,2591.4472 L983.5,2596.3002 L978.5,2601.3002 L952,2601.3002 L952,2591.4472 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="952" y="2591.4472"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="959.5" y="2598.8957">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="86.5" x="991" y="2598.3267">[sessionIdASFoundFlag == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2613.1532" y2="2613.1532"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2613.1532" y2="2619.6532"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2619.6532" y2="2619.6532"/><polygon fill="#181818" points="981,2617.6532,976,2619.6532,981,2621.6532,979,2619.6532" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="979" y="2610.2487">Throws an exception</text><polygon fill="#181818" points="2304.25,2637.0062,2309.25,2639.0062,2304.25,2641.0062,2306.25,2639.0062" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="2639.0062" y2="2639.0062"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="979" y="2636.1017">hexToBytes(extractedIv)</text><polygon fill="#181818" points="981,2652.8592,976,2654.8592,981,2656.8592,979,2654.8592" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="2654.8592" y2="2654.8592"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="984" y="2651.9547">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2670.7122" y2="2670.7122"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2670.7122" y2="2677.2122"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2677.2122" y2="2677.2122"/><polygon fill="#181818" points="981,2675.2122,976,2677.2122,981,2679.2122,979,2677.2122" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="979" y="2667.8077">store new iv in bytes for that session id</text><polygon fill="#181818" points="2304.25,2691.0653,2309.25,2693.0653,2304.25,2695.0653,2306.25,2693.0653" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="2693.0653" y2="2693.0653"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="979" y="2690.1607">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, ivAM)</text><polygon fill="#181818" points="981,2708.4183,976,2710.4183,981,2712.4183,979,2710.4183" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="2710.4183" y2="2710.4183"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="984" y="2707.5138">plaintext</text><path d="M810.5,2699.5653 L810.5,2713.0653 L968,2713.0653 L968,2704.5653 L963,2699.5653 L810.5,2699.5653 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,2699.5653 L963,2704.5653 L968,2704.5653 L963,2699.5653 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="813.5" y="2709.0138">Mallory build fake client request to the real server</text><polygon fill="#181818" points="2304.25,2725.7713,2309.25,2727.7713,2304.25,2729.7713,2306.25,2727.7713" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="2727.7713" y2="2727.7713"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="979" y="2724.8668">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="981,2741.6243,976,2743.6243,981,2745.6243,979,2743.6243" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="2743.6243" y2="2743.6243"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="14.5" x="984" y="2740.7198">ivMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2759.4773" y2="2759.4773"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2759.4773" y2="2765.9773"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2765.9773" y2="2765.9773"/><polygon fill="#181818" points="981,2763.9773,976,2765.9773,981,2767.9773,979,2765.9773" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187.5" x="979" y="2756.5728">store new iv in bytes for that session id for Mallory -&gt; Server leg</text><polygon fill="#181818" points="2304.25,2779.8303,2309.25,2781.8303,2304.25,2783.8303,2306.25,2781.8303" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="2781.8303" y2="2781.8303"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="192.5" x="979" y="2778.9258">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivMS)</text><polygon fill="#181818" points="981,2797.1833,976,2799.1833,981,2801.1833,979,2799.1833" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="2799.1833" y2="2799.1833"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40" x="984" y="2796.2788">ciphertextMS</text><path d="M823,2788.3303 L823,2801.8303 L968,2801.8303 L968,2793.3303 L963,2788.3303 L823,2788.3303 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,2788.3303 L963,2793.3303 L968,2793.3303 L963,2788.3303 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="826" y="2797.7788">Mallory build body request for the real server</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="2819.2128" y2="2819.2128"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="2819.2128" y2="2825.7128"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="2825.7128" y2="2825.7128"/><polygon fill="#181818" points="981,2823.7128,976,2825.7128,981,2827.7128,979,2825.7128" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="979" y="2816.3083">built fake "client_message_exchange" message</text><path d="M768.5,2807.1833 L768.5,2829.6833 L968,2829.6833 L968,2812.1833 L963,2807.1833 L768.5,2807.1833 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,2807.1833 L963,2812.1833 L968,2812.1833 L963,2807.1833 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189" x="771.5" y="2816.6318">Mallory fake Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="771.5" y="2825.4848">with sessionId, ivMS and ciphertext</text><polygon fill="#181818" points="2617.25,2842.2423,2622.25,2844.2423,2617.25,2846.2423,2619.25,2844.2423" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2620.25" y1="2844.2423" y2="2844.2423"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="207" x="979" y="2841.3378">HTTP POST /messageExchange (fake client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="2860.0953" y2="2860.0953"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="2860.0953" y2="2866.5953"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="2866.5953" y2="2866.5953"/><polygon fill="#181818" points="2633.75,2864.5953,2628.75,2866.5953,2633.75,2868.5953,2631.75,2866.5953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="2631.75" y="2857.1908">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="2882.4483" y2="2882.4483"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="2882.4483" y2="2888.9483"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="2888.9483" y2="2888.9483"/><polygon fill="#181818" points="2633.75,2886.9483,2628.75,2888.9483,2633.75,2890.9483,2631.75,2888.9483" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2631.75" y="2879.5438">extract session id as extractedSessionIdUuidFormat</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="2904.8013" y2="2904.8013"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="2904.8013" y2="2911.3013"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="2911.3013" y2="2911.3013"/><polygon fill="#181818" points="2633.75,2909.3013,2628.75,2911.3013,2633.75,2913.3013,2631.75,2911.3013" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="2631.75" y="2901.8968">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="2927.1544" y2="2927.1544"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="2927.1544" y2="2933.6544"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="2933.6544" y2="2933.6544"/><polygon fill="#181818" points="2633.75,2931.6544,2628.75,2933.6544,2633.75,2935.6544,2631.75,2933.6544" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="2631.75" y="2924.2499">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="2949.5074" y2="2949.5074"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="2949.5074" y2="2956.0074"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="2956.0074" y2="2956.0074"/><polygon fill="#181818" points="2633.75,2954.0074,2628.75,2956.0074,2633.75,2958.0074,2631.75,2956.0074" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="2631.75" y="2946.6029">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M2598,2963.5074 L2629.5,2963.5074 L2629.5,2968.3604 L2624.5,2973.3604 L2598,2973.3604 L2598,2963.5074 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="2598" y="2963.5074"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2605.5" y="2970.9559">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="130" x="2637" y="2970.3868">[extractedSessionIdUuidFormat does not exist]</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="2985.2134" y2="2985.2134"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="2985.2134" y2="2991.7134"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="2991.7134" y2="2991.7134"/><polygon fill="#181818" points="2633.75,2989.7134,2628.75,2991.7134,2633.75,2993.7134,2631.75,2991.7134" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="2631.75" y="2982.3089">Throws an exception</text><polygon fill="#181818" points="3225,3009.0664,3230,3011.0664,3225,3013.0664,3227,3011.0664" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="3228" y1="3011.0664" y2="3011.0664"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="2631.75" y="3008.1619">hexToBytes(extractedIv)</text><polygon fill="#181818" points="2633.75,3024.9194,2628.75,3026.9194,2633.75,3028.9194,2631.75,3026.9194" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="3233" y1="3026.9194" y2="3026.9194"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2636.75" y="3024.0149">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="3042.7724" y2="3042.7724"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="3042.7724" y2="3049.2724"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="3049.2724" y2="3049.2724"/><polygon fill="#181818" points="2633.75,3047.2724,2628.75,3049.2724,2633.75,3051.2724,2631.75,3049.2724" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2631.75" y="3039.8679">store new iv in bytes for that session id</text><polygon fill="#181818" points="3225,3063.1254,3230,3065.1254,3225,3067.1254,3227,3065.1254" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="3228" y1="3065.1254" y2="3065.1254"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="2631.75" y="3062.2209">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, iv)</text><polygon fill="#181818" points="2633.75,3078.9784,2628.75,3080.9784,2633.75,3082.9784,2631.75,3080.9784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="3233" y1="3080.9784" y2="3080.9784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="2636.75" y="3078.0739">plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="3096.8314" y2="3096.8314"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="3096.8314" y2="3103.3314"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="3103.3314" y2="3103.3314"/><polygon fill="#181818" points="2633.75,3101.3314,2628.75,3103.3314,2633.75,3105.3314,2631.75,3103.3314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="212.5" x="2631.75" y="3093.9269">build server's confirmation with server id, extracted session id, plaintext</text><polygon fill="#181818" points="3225,3117.1844,3230,3119.1844,3225,3121.1844,3227,3119.1844" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="3228" y1="3119.1844" y2="3119.1844"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="2631.75" y="3116.2799">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="2633.75,3133.0374,2628.75,3135.0374,2633.75,3137.0374,2631.75,3135.0374" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2630.75" x2="3233" y1="3135.0374" y2="3135.0374"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="2636.75" y="3132.1329">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="2628.25" x2="2649.25" y1="3150.8905" y2="3150.8905"/><line style="stroke:#181818;stroke-width:0.5;" x1="2649.25" x2="2649.25" y1="3150.8905" y2="3157.3905"/><line style="stroke:#181818;stroke-width:0.5;" x1="2628.75" x2="2649.25" y1="3157.3905" y2="3157.3905"/><polygon fill="#181818" points="2633.75,3155.3905,2628.75,3157.3905,2633.75,3159.3905,2631.75,3157.3905" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="2631.75" y="3147.986">store new iv in bytes for that session id</text><polygon fill="#181818" points="3227.5,3171.2435,3232.5,3173.2435,3227.5,3175.2435,3229.5,3173.2435" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2630.75" x2="3230.5" y1="3173.2435" y2="3173.2435"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="183" x="2634.25" y="3170.339">encryptMessageAes256CbcMode(plaintext, symmetricKey, iv)</text><polygon fill="#181818" points="2636.25,3187.0965,2631.25,3189.0965,2636.25,3191.0965,2634.25,3189.0965" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2633.25" x2="3233" y1="3189.0965" y2="3189.0965"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="2639.25" y="3186.192">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="2630.75" x2="2651.75" y1="3204.9495" y2="3204.9495"/><line style="stroke:#181818;stroke-width:0.5;" x1="2651.75" x2="2651.75" y1="3204.9495" y2="3211.4495"/><line style="stroke:#181818;stroke-width:0.5;" x1="2631.25" x2="2651.75" y1="3211.4495" y2="3211.4495"/><polygon fill="#181818" points="2636.25,3209.4495,2631.25,3211.4495,2636.25,3213.4495,2634.25,3211.4495" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="244" x="2634.25" y="3202.045">built server confirmation message with server id, extractedSessionId and plaintext</text><path d="M2429,3197.3465 L2429,3210.8465 L2620.5,3210.8465 L2620.5,3202.3465 L2615.5,3197.3465 L2429,3197.3465 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2615.5,3197.3465 L2615.5,3202.3465 L2620.5,3202.3465 L2615.5,3197.3465 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="2432" y="3206.795">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="2630.75" x2="2651.75" y1="3229.979" y2="3229.979"/><line style="stroke:#181818;stroke-width:0.5;" x1="2651.75" x2="2651.75" y1="3229.979" y2="3236.479"/><line style="stroke:#181818;stroke-width:0.5;" x1="2631.25" x2="2651.75" y1="3236.479" y2="3236.479"/><polygon fill="#181818" points="2636.25,3234.479,2631.25,3236.479,2636.25,3238.479,2634.25,3236.479" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="2634.25" y="3227.0745">built "client_message_exchange" response message</text><path d="M2426.5,3217.9495 L2426.5,3240.4495 L2620.5,3240.4495 L2620.5,3222.9495 L2615.5,3217.9495 L2426.5,3217.9495 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2615.5,3217.9495 L2615.5,3222.9495 L2620.5,3222.9495 L2615.5,3217.9495 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="2429.5" y="3227.398">Server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124.5" x="2429.5" y="3236.251">with extractedSessionId, iv and ciphertext</text><polygon fill="#181818" points="981,3253.0085,976,3255.0085,981,3257.0085,979,3255.0085" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2622.75" y1="3255.0085" y2="3255.0085"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="172" x="984" y="3252.104">HTTP 201 OK (Server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3270.8615" y2="3270.8615"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3270.8615" y2="3277.3615"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3277.3615" y2="3277.3615"/><polygon fill="#181818" points="981,3275.3615,976,3277.3615,981,3279.3615,979,3277.3615" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="67.5" x="979" y="3267.957">Parse requestMS body</text><path d="M952,3284.8615 L983.5,3284.8615 L983.5,3289.7145 L978.5,3294.7145 L952,3294.7145 L952,3284.8615 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="952" y="3284.8615"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="959.5" y="3292.31">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="84.5" x="991" y="3291.741">[requestMS.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3306.5675" y2="3306.5675"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3306.5675" y2="3313.0675"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3313.0675" y2="3313.0675"/><polygon fill="#181818" points="981,3311.0675,976,3313.0675,981,3315.0675,979,3313.0675" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="979" y="3303.663">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3332.4205" y2="3332.4205"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3332.4205" y2="3338.9205"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3338.9205" y2="3338.9205"/><polygon fill="#181818" points="981,3336.9205,976,3338.9205,981,3340.9205,979,3338.9205" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="979" y="3329.516">extract session id as extractedSessionIdMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3354.7735" y2="3354.7735"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3354.7735" y2="3361.2735"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3361.2735" y2="3361.2735"/><polygon fill="#181818" points="981,3359.2735,976,3361.2735,981,3363.2735,979,3361.2735" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92.5" x="979" y="3351.869">extract iv as extractedIvHexMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3377.1266" y2="3377.1266"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3377.1266" y2="3383.6266"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3383.6266" y2="3383.6266"/><polygon fill="#181818" points="981,3381.6266,976,3383.6266,981,3385.6266,979,3383.6266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="979" y="3374.2221">extract ciphertext as extractedCiphertextMS</text><polygon fill="#181818" points="2304.25,3397.4796,2309.25,3399.4796,2304.25,3401.4796,2306.25,3399.4796" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="3399.4796" y2="3399.4796"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="94.5" x="979" y="3396.5751">hexToBytes(extractedIvHexMS)</text><polygon fill="#181818" points="981,3413.3326,976,3415.3326,981,3417.3326,979,3415.3326" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="3415.3326" y2="3415.3326"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="984" y="3412.4281">extractedIvMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3431.1856" y2="3431.1856"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3431.1856" y2="3437.6856"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3437.6856" y2="3437.6856"/><polygon fill="#181818" points="981,3435.6856,976,3437.6856,981,3439.6856,979,3437.6856" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60.5" x="979" y="3428.2811">store extractedIvMS</text><polygon fill="#181818" points="2304.25,3451.5386,2309.25,3453.5386,2304.25,3455.5386,2306.25,3453.5386" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="3453.5386" y2="3453.5386"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="264.5" x="979" y="3450.6341">decryptMessageAes256CbcMode(extractedCiphertextMS, symmetricKey, extractedIvMS)</text><polygon fill="#181818" points="981,3468.8916,976,3470.8916,981,3472.8916,979,3470.8916" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="3470.8916" y2="3470.8916"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="984" y="3467.9871">plaintext</text><path d="M768,3460.0386 L768,3473.5386 L968,3473.5386 L968,3465.0386 L963,3460.0386 L768,3460.0386 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,3460.0386 L963,3465.0386 L968,3465.0386 L963,3460.0386 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189.5" x="771" y="3469.4871">Mallory build client's request response instead of the real server</text><polygon fill="#181818" points="2304.25,3486.2446,2309.25,3488.2446,2304.25,3490.2446,2306.25,3488.2446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="3488.2446" y2="3488.2446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="979" y="3485.3401">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="981,3502.0976,976,3504.0976,981,3506.0976,979,3504.0976" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="3504.0976" y2="3504.0976"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="984" y="3501.1931">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3519.9506" y2="3519.9506"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3519.9506" y2="3526.4506"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3526.4506" y2="3526.4506"/><polygon fill="#181818" points="981,3524.4506,976,3526.4506,981,3528.4506,979,3526.4506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="979" y="3517.0461">store new iv in bytes for that session id for Alice -&gt; Mallory leg</text><polygon fill="#181818" points="2304.25,3540.3036,2309.25,3542.3036,2304.25,3544.3036,2306.25,3542.3036" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="2307.25" y1="3542.3036" y2="3542.3036"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="979" y="3539.3991">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivAM)</text><polygon fill="#181818" points="981,3556.1566,976,3558.1566,981,3560.1566,979,3558.1566" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="978" x2="2312.25" y1="3558.1566" y2="3558.1566"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40.5" x="984" y="3555.2521">ciphertextAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3574.0096" y2="3574.0096"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3574.0096" y2="3580.5096"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3580.5096" y2="3580.5096"/><polygon fill="#181818" points="981,3578.5096,976,3580.5096,981,3582.5096,979,3580.5096" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="267.5" x="979" y="3571.1051">built fake server confirmation message with server id, extractedSessionIdMS and plaintext</text><path d="M776.5,3566.4066 L776.5,3579.9066 L968,3579.9066 L968,3571.4066 L963,3566.4066 L776.5,3566.4066 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,3566.4066 L963,3571.4066 L968,3571.4066 L963,3566.4066 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="779.5" y="3575.8551">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="975.5" x2="996.5" y1="3599.0392" y2="3599.0392"/><line style="stroke:#181818;stroke-width:0.5;" x1="996.5" x2="996.5" y1="3599.0392" y2="3605.5392"/><line style="stroke:#181818;stroke-width:0.5;" x1="976" x2="996.5" y1="3605.5392" y2="3605.5392"/><polygon fill="#181818" points="981,3603.5392,976,3605.5392,981,3607.5392,979,3605.5392" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168.5" x="979" y="3596.1347">built fake "client_message_exchange" response message</text><path d="M759,3587.0096 L759,3609.5096 L968,3609.5096 L968,3592.0096 L963,3587.0096 L759,3587.0096 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M963,3587.0096 L963,3592.0096 L968,3592.0096 L963,3587.0096 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="762" y="3596.4582">Fake server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154" x="762" y="3605.3112">with extractedSessionIdMS, ivAM and ciphertextAM</text><polygon fill="#181818" points="271.25,3622.0687,266.25,3624.0687,271.25,3626.0687,269.25,3624.0687" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="972.5" y1="3624.0687" y2="3624.0687"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187" x="274.25" y="3621.1642">HTTP 201 OK (Fake server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3639.9217" y2="3639.9217"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3639.9217" y2="3646.4217"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3646.4217" y2="3646.4217"/><polygon fill="#181818" points="271.25,3644.4217,266.25,3646.4217,271.25,3648.4217,269.25,3646.4217" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="269.25" y="3637.0172">Parse request body</text><path d="M235.5,3653.9217 L267,3653.9217 L267,3658.7747 L262,3663.7747 L235.5,3663.7747 L235.5,3653.9217 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="3653.9217"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="3661.3702">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="76.5" x="274.5" y="3660.8011">[request.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3675.6277" y2="3675.6277"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3675.6277" y2="3682.1277"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3682.1277" y2="3682.1277"/><polygon fill="#181818" points="271.25,3680.1277,266.25,3682.1277,271.25,3684.1277,269.25,3682.1277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="3672.7232">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3701.4807" y2="3701.4807"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3701.4807" y2="3707.9807"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3707.9807" y2="3707.9807"/><polygon fill="#181818" points="271.25,3705.9807,266.25,3707.9807,271.25,3709.9807,269.25,3707.9807" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="269.25" y="3698.5762">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3723.8337" y2="3723.8337"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3723.8337" y2="3730.3337"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3730.3337" y2="3730.3337"/><polygon fill="#181818" points="271.25,3728.3337,266.25,3730.3337,271.25,3732.3337,269.25,3730.3337" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83" x="269.25" y="3720.9292">extract iv as extractedIvHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3746.1867" y2="3746.1867"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3746.1867" y2="3752.6867"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3752.6867" y2="3752.6867"/><polygon fill="#181818" points="271.25,3750.6867,266.25,3752.6867,271.25,3754.6867,269.25,3752.6867" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="269.25" y="3743.2822">extract ciphertext as extractedCiphertext</text><polygon fill="#181818" points="901.5,3766.5397,906.5,3768.5397,901.5,3770.5397,903.5,3768.5397" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="904.5" y1="3768.5397" y2="3768.5397"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="85" x="269.25" y="3765.6352">hexToBytes(extractedIvHex)</text><polygon fill="#181818" points="271.25,3782.3927,266.25,3784.3927,271.25,3786.3927,269.25,3784.3927" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="909.5" y1="3784.3927" y2="3784.3927"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="34" x="274.25" y="3781.4882">extractedIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3800.2457" y2="3800.2457"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3800.2457" y2="3806.7457"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3806.7457" y2="3806.7457"/><polygon fill="#181818" points="271.25,3804.7457,266.25,3806.7457,271.25,3808.7457,269.25,3806.7457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="51" x="269.25" y="3797.3412">store extractedIv</text><polygon fill="#181818" points="901.5,3820.5988,906.5,3822.5988,901.5,3824.5988,903.5,3822.5988" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="904.5" y1="3822.5988" y2="3822.5988"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="245.5" x="269.25" y="3819.6943">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, extractedIv)</text><polygon fill="#181818" points="271.25,3836.4518,266.25,3838.4518,271.25,3840.4518,269.25,3838.4518" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="909.5" y1="3838.4518" y2="3838.4518"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="274.25" y="3835.5473">decryptedCiphertext</text><path d="M235.5,3845.9518 L267,3845.9518 L267,3850.8048 L262,3855.8048 L235.5,3855.8048 L235.5,3845.9518 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="3845.9518"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="3853.4003">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="151" x="274.5" y="3852.8312">[decryptedCiphertext.find(clientMessageSent) == true]</text><path d="M268,3858.3048 L268,3871.8048 L391,3871.8048 L391,3863.3048 L386,3858.3048 L268,3858.3048 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M386,3858.3048 L386,3863.3048 L391,3863.3048 L386,3858.3048 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="112.5" x="271" y="3867.7533">Connection Test Result: Success (true)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="428" y1="3875.1578" y2="3875.1578"/><path d="M268,3878.1578 L268,3891.6578 L389,3891.6578 L389,3883.1578 L384,3878.1578 L268,3878.1578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M384,3878.1578 L384,3883.1578 L389,3883.1578 L384,3878.1578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="110.5" x="271" y="3887.6063">Connection Test Result: Failure (false)</text><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="286.75" y1="3906.3638" y2="3906.3638"/><line style="stroke:#181818;stroke-width:0.5;" x1="286.75" x2="286.75" y1="3906.3638" y2="3912.8638"/><line style="stroke:#181818;stroke-width:0.5;" x1="266.25" x2="286.75" y1="3912.8638" y2="3912.8638"/><polygon fill="#181818" points="271.25,3910.8638,266.25,3912.8638,271.25,3914.8638,269.25,3912.8638" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="269.25" y="3903.4593">Throws an exception</text><polygon fill="#181818" points="50.75,3930.2168,45.75,3932.2168,50.75,3934.2168,48.75,3932.2168" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="262.75" y1="3932.2168" y2="3932.2168"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="53.75" y="3929.3123">connectionTestResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="66.25" y1="3950.5698" y2="3950.5698"/><line style="stroke:#181818;stroke-width:0.5;" x1="66.25" x2="66.25" y1="3950.5698" y2="3957.0698"/><line style="stroke:#181818;stroke-width:0.5;" x1="42.75" x2="66.25" y1="3957.0698" y2="3957.0698"/><polygon fill="#181818" points="47.75,3955.0698,42.75,3957.0698,47.75,3959.0698,45.75,3957.0698" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="42.5" x="48.75" y="3947.6653">Program ends</text><!--SRC=[nLnjRzl84VwkNx5rKOG25FVkW2kAe0aWlvtTYn8ZSWueYfv0YMk9DKNgI4gEY_lndNtbBlU5Iqh9-KDYKTpPsPdPcMTdPbsjuWoZxyv_78sMnHTqTfcbEA_HTNv8ooBVmkzdwC_lq_Mc_XVEik9vXE1d5vTrkaftCRnvjetJ74NbFcT3ln-VeRX2CtXglikfHnV5aht67hXUV7ELFZwc-1PctiQvCk3grZtazZukustrleWJN6fZs2Fdo1ckgdYDhx_KPRogqoA_YLTfbjOl2f7PzOrp_7M-AbzsPE3dkZtk-lC8vma24NCvJ-iwNZtXqYRfowACCtEQMGmAA5-uUEdlpfVUyF_di2PWw2gkOtMSyjXDGXC-Ykg2hsMiKhgwTQdGJMQEomCkMsJOGmyPKwzoh4knKXXUpVAthAeL5EowvT-2Sfq3XSNRbtqJFs4kFzqysBisuxZ8zjYSZhyVJU_ls0Ji0NnqlMlPM-mBszuIGqmTY34k5V2HVWsmbwmAuEFjycTVgdkB43_4DMR-PqJ-HQ_VSSD5Rz1bYSctx7Dq1dxeR88IlDolRx9uFK7hijZlFiHRV7KxReWf9iuflGQYbFWRbEDdyKA2sqDC3X9Lx3_Zb-ilgqsSht6qAujaJsLpNvIrV_PtqgSrQzBq6IsKHIrsH6kunkLT_bzCfu27sb89yTQ4t0wQQM4oPMAcS9W-Wr-kDlTYYYfQurhzV9DcE8VVtnUhc4mTZSUIi36bOaRjoVc4h_N5VyBrlimhn4sJpeYsyKwIC7HYJE9T9aonnZakOVnzISc0pYBF2YmJZqR1K-oNMReAdS5E4BOHKBou- -d3vzb3SOk_H8kT87iEkb7bRw4lTg4v2I7SaZxZ5m5bD4NH1d_HIHkoLubR56EJaxPxBQW0fNbLn_aA8zW62Ok8JjBj_NFzMH7-9V4mnRgCTvjqzQ40ab5E_fsd_yFM7SBzVaCOo6dyhkWlb1JemSuQ4B6ozWOjzsa67l2fyH5dQClyA1sH5q0amuzrYmkqAa0a9VYI2lrp_l43EcDyB3O4mPt9jv_JUiDPl4icAhCJ-Ovq4XCaZMXAloKkbt3Gvfv7DbZzxSF3FRh_E7z0VrNMW2BsBb5VGVbhoLP06yc3eDWGVuCm2oISwLSLgXYYGMb20WF_6YUNV7dzY56rQtIeM1H774oA2X0H_wVH-qd8jHyrfWC4ujIetUkgaSPH4i2WxKWnIvg3erpXNIq0AbN7kVRkBHOpL9m3rDW9CCDCHLiXsCHEkeI6ccuhzjKojmKkvA7udAU_xJ7pO95baHRVsC9mhMc4vsfiSuTnAGc2D90w9teiocrSspoLCezdBOfJONGvthvB8ZVlLZszLisX4bGydFdOKb1_0nlCxwA5T7iJwmwOcFiBy8GAEDB3Uvolwyt4Ol5MFE8MI_keqbgUkgPcfU9Kua972gysR6H08nTpskd7mftaGsNDZPp61XrpGWj2CYPLe98fa4x4v3Okv-o-vSg9lJYgjuGzJiwsaSJau4FPzDI9ljekubVMiT9bXKXbW16OKh50lwyjb5MntUsfJ9guCbjCqLiKhNy5qOpHNz3k3n1FNmWR4Why8K5HY89fYInCLEiE2PqhTFbY1w9LSYuAkWqGjJsMl6iI5e6er-_z5FpRcei3OHcvIbpj0SjMTL7YX8JRHKMFxW8QJsSTAnCeEMnDdm285DkxNo8HXxxUEjB3KDwroALXXv9xwAtnuaIPkjvWuhOXyAh6Cujt_vOuuJyUeA36LVCeRCfNsI4G0T83dczYu6IELy2k3QLDl9ozVcUOGES0_JWrdRb1WzNd1BdZHQKiYpX27Id-2k15XY_Y7XUwVnprSN0Kx5wyW0EET5dupTNYQJgTcaAVJZZgvyo6BalNsEcNfT0VigmWYqXWXq0GYgiDc0Ep3Z1TOXwBCdvUBCcywFVV3Lx8Cw_Om-oHRRPa_h85g5OoAtoBvhVJ7txyMzJmDkwbefe4rJcGozUHRORUckfMbUawBVEABCaHAlIxQykSepxnrFIBJGfV0NFe4PvoYn1fgoZ8kzqbp15QKj8z3qvARS4YC8LjFVYGTFPA7sOAHg6jPnoqT9GEDMLEQWD7a-8vLnCFI9P7jC4qGtKfyWtabCb38jrH3mKRCj76s39MiyKSHPmJFOi29trHb-cLhMW4uCdeqpMJL0lQGKQVJVDXlrsgauL8bdhWBYM-QvVIJbWPS8TPYzAqNSbP2Jl-zYWSdFvyB8NsDSx7lGGaEHbuO7Ren5gF6CPFhwEgWnt_h4DEW7rEWRwG9TUhdGJdZfDW-6dGPYzSEDtwS0ISq8f8Nnvy3gPdqUJOKvUstaVvGQkgz3vyMHUcElMkuei_wf6VcmO2X5PajBW7oikKyanhvHDZa2FmZQnf6_RJAHZPHU0fvpHnrLxOCVJVj2OOQsZcQqqEhhZ2nWGeUYoBhM3Tt9iTgJ2-jsIHWzEvIo3niadpfmgb17U8siVLU68bOyCaLWfqOpY8w5Z5ChWflutFHyvqN8X41-xVXXhVdwf-zFDh41lktWK9K3pXHUjLiS_6Yk9wWqfOrbsbeM05XUzWaE1Y9pIy1sPqkTKvijpBdZdk4AOz6A0Vpp89VS7opii1MMSxmqD1H3EwfNK545nq9uQT9jfmsjf5jiwiTZGFtrkMD9tYPI0_fs_Qzk6A9vu7Ri41-cUv5SHoAwXwjI2ka6JW5AOX0TVatoxSba9-7ZOfkD2A9afrsajSFsESotCTgLipRiwFiRkMDXq9ZiLi7cGrmQuSizuutc8tnHLaXYwNgrcHq2FeOqgAsN1-cbNhYOUfYTpRoTsXX-k7JZquqTSGHSdAx37O2f0q6z3n4IHkTl08q0LxWOPy-sQbM4acKZIZLe3GnSIXM2ewi0nLK2ZIrZH1wO69oESkmAXWmnmmZzeLs0narqXYWtOPIfmq7XQy7NYOWh8VlliUVVnPavK5VnasPY0mpvvjG9wIsLAxI9IvpJsaTf84g0evn7y-yeijB4zbAstuCoOMF19qp1sM1N5aSe_FMPmcvz1j9EvQUmk7MDtgIJ8H0KpQQzyNelPjGI4zsUsBFlgb8zhumtEm3yWf07LxkxvMYkQ9KW54WZQK3uHSs2576vZqt7LzTD-270RYkD3m1aZTZZWqf44QuJX1wD5pnrjKi1ek5rML9lXyWBrfIWo0724P85jrdUhI0pHqb-s36Ub12wKTUI5hJgXX1YhEMKpY48CVtaHGO6zaNZoZJSoqAMVH0GBF126QVcYKgEjl3izNi8V8TW5G0CPUGAa0kWqXS3u2vIe5s-lN9Ealmk-KshjUUUt2za7rysCsrdGnqpRMjBMnfW4RomhXfq2FDPvo7lhi8Mi1p6MwIf_7i4fX9rYtclHYLm1WMcOl2se-AKuc7XOdf7xtKuFZ5xukYS2TfcnjhmpKL6llOg2ANMNNaraCBC3-qXmIetOOgMGZnreQj8N_0t2_AZYLTmBi6xOLy13Hy02y4sDbsq-VT1i_aHC1irX-Mg2H70mSZWXQOVBSElSULits0bsox5Ilu974uc0Wsk12JGl5jBvRv9ZSUjhnCmeFHDKAocrbsiBlDmM9JTiTC0RNhiZ2OMo6wHadVg5JGn7rEIuJnfgY8QaMdMBqiKJ03L2Qi14vMq55zYAN7njC0kWhnPEzelLQ8Njk0a65M_LMXdPcQWuszjEJgyEwVLr3vgZRP9Iph9cijhXKJgxZlAGPklUsneMwHcAY4tr3Y-CLtzgkQntgtIAbmKUC7OzSzuJW_VI0eWDKbulo7timqxylwdTZfnJdf5a3gSrnj6-ZrJhXlWtN0JZREIzRXvBxnfKZ1CfxD_RerqfYwQ3I4lcwevwuLKfzoTWU_epGPxzJvOWbdFPhiOEUH5DGyDqg4ZaKvyhsnIU-6QBpytEhiDlxGB-g5OX0UGkDRLt4t9rtwpelT9aHsbM2SjxpyZeF6tqzazDjWM0lojKW1DicIweMCas92n6gvUuRtetH8SxW1bKaC0SIc4EFXQfUYGy7MwK3MHHzJhCCPUaJXl6xkAe2eY1r__lL2lJwkCyo2YIt-pnT4HJ38Zz4o4xRrfKLBOiYKnZxHBl1I0ijwNjhPCsjoM7UJ6in58FRbD3RjmXG3BQebLyDVb-iAtJ6JjH87Aa9Li2YUaeNZPCpkeMRmqQxqkpNEeX_dyUWGqpE5foaa1lNyeJGy0WHPs1-jXK-nl3DCKjyZA6F9paJqMKKT4jwA-wBYylHhGQgIHCNnwEWgz9QrLCsY2_q3l6-_W30rDqlPL4JC-rtlPEpKz_GgsOm_265DTVnTXSDPeMGc1CI_LX1ejj1d6ef46lT3bLWY3eJGMZi9RwBvdBBM5ViE_u0NUdsEiyuKkm3R-OQPvh-5tDv3mUNsWAVvfAkGMxagdIeKg3-erbK_nkwhGs78WSxlXkxlgkiBBwL62v3Ga_aiaXUWcw-EgxrpesRa3uYW3-RmNU7i2ktKfRwVU96n5uogmrUFP4qZxg0Z2PEWLXQrTM4geos9bEW1xvt3ucCcdxWaQjCusM66vrFvpV5Faz8AQA1C5bjVS7qtIvU7pPbyGn7mvpuR4p_o8OQ8q8kXv3BDygfG8hhxd1qza6xOEDDwzdMnkHBphnW111ZMBS-EKNMcrWrhr77wdp8qs8Tu30LlpMXgpXQ53lX7SFa4PYC8TuiqSfwOfVoipXjHAlqHBi1m08lP2tC6rc3xI8qtNkKNT1d2WMUTi_mkijYVA5kryIvjfsS83NU-AvG4VKo5UAyfOqmaNKOYLSLB9fI-miBgTryKcA3uwmjrXAzs69ivp8T7PH6k5Nsdo_cQigorFExcoczeTWtB3GaVzwdoOt-1nH2oBg2TCZO7i7QH-xR1MqHk7tIGqc1AtfgetC7zihwmxamrqvvX0HqYmbQUhgTVKFfmT-UqgBbMkw02EzPyz5X_cJYCOEzIqgZe0vgvhjbuK2hUt1lHoDRcYX_j4CHtyJ1KOXKGs30jx6c4vjKNq4Cn0ITZVG3clLwRRwm5LBXiN1UoRu-isZkj3Rf1DaV4fBc5dZXGlJX4KEl14hXjPS6fh2eLppIZqhK7NMtvFcNx0Olaej-5qWSlP41yzWlb9Xodj2eQqSrpkhvgBD3qTwNICfFt08qO2FP7bix-IozYftv1S1g6gmXeLP-TGvPjdfVBLQmwT2VtX8kZpuYdoINeO3ru6m6YSYG5GiSsecJr0PUHmE37HLG7eu-k2W4Xn_ka73WEhNJdkz97vFkfRNPljLHlzUvJVxXDk44fRyWNNwaIObxnQ03_nzvylyc6I7wZ9MfbEc_ti7_f9qwmOqw7IVou-8uFpDR8hdTNayKmK-OTt26Rli2RdIP7HMt7J6RTL1EPwsuhIXyI1kCmdX0dExJ6EFCDoX1sHUIJNgkO2m3iJcaLpd1FTmMUZk61AOchCKoPwWTLlDIQ3WhNexwe15GNLmVVO8sCWs3MpGkTKphhEyHExGCEdzCyoGoQfjZe-h_GTRcYKyI-hyiyfpzGGtqGCoU5TIXlObrEK0_FT0OozBxG6etK5lVbpHzc5NAVTqZDarJsb_9IScSR4flzPwFko_9VU8j8LsDD3UHvgF_0m00]--></g></svg>