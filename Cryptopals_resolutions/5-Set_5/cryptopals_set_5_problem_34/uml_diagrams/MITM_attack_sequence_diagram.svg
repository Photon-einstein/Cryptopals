<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3221px" preserveAspectRatio="none" style="width:2449px;height:3221px;background:#FFFFFF;" version="1.1" viewBox="0 0 2449 3221" width="2449px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFE0" height="3215.1304" style="stroke:#181818;stroke-width:0.25;" width="948.5" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="64" x="450.25" y="9.9485">Client Environment</text><rect fill="#F08080" height="3215.1304" style="stroke:#181818;stroke-width:0.25;" width="810" x="957.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="73.5" x="1325.75" y="9.9485">Attacker Environment</text><rect fill="#ADD8E6" height="3215.1304" style="stroke:#181818;stroke-width:0.25;" width="677.5" x="1768.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="65.5" x="2074.5" y="9.9485">Server Environment</text><rect fill="#FFFFFF" height="3151.2095" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="3147.3565" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="1331.9087" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="203.417"/><rect fill="#FFFFFF" height="98.4711" style="stroke:#181818;stroke-width:0.5;" width="5" x="265.75" y="1369.3047"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="1547.1787"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="63.593"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="1327.6722"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1387.6577"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1563.0317"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1594.7378"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1648.7968"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="3004.5664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="3058.6254"/><rect fill="#FFFFFF" height="946.519" style="stroke:#181818;stroke-width:0.5;" width="5" x="973" y="277.6086"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="973" y="1708.2088"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="1268" y="299.3881"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1268" y="1080.965"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="1388" y="848.0964"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1388" y="993.847"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1031.4795"/><rect fill="#FFFFFF" height="52.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1118.5975"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1875.0329"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1929.0919"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1963.7979"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2017.857"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2635.5062"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2689.5653"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2724.2713"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2778.3303"/><rect fill="#FFFFFF" height="334.6927" style="stroke:#181818;stroke-width:0.5;" width="5" x="1790.75" y="491.6242"/><rect fill="#FFFFFF" height="1114.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="1790.75" y="2080.269"/><rect fill="#FFFFFF" height="81.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="1793.25" y="2409.2701"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="2085.75" y="575.7423"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="2085.75" y="721.4928"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2398.5" y="2247.0931"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2398.5" y="2301.1521"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2398.5" y="2355.2111"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="439.75" x="5" y="1478.7758"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="954.5" y="1827.4739"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="1765.5" y="2199.534"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="954.5" y="2520.8882"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="2889.9483"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="3081.9784"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="42.5" x2="42.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="517.5" x2="517.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="702" x2="702" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="808" x2="808" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="912.5" x2="912.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="975.5" x2="975.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1270.5" x2="1270.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1390.5" x2="1390.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1499.5" x2="1499.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1610.5" x2="1610.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1720.5" x2="1720.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="1793" x2="1793" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2088" x2="2088" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2186.5" x2="2186.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2294.5" x2="2294.5" y1="30.887" y2="3199.5965"/><line style="stroke:#181818;stroke-width:0.25;stroke-dasharray:5.0,5.0;" x1="2401" x2="2401" y1="30.887" y2="3199.5965"/><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="24.836">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="65.5" x="10" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="58.5" x="13.5" y="3210.0794">main (runClient1)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="24.836">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="240.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="244" y="3210.0794">Client (Bob)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="480.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="484" y="24.836">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="74.5" x="480.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="67.5" x="484" y="3210.0794">Client:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="659" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="662.5" y="24.836">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86.5" x="659" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79.5" x="662.5" y="3210.0794">Client:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="750.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="754" y="24.836">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="115" x="750.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="108" x="754" y="3210.0794">Client:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="870.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="874" y="24.836">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="84" x="870.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="77" x="874" y="3210.0794">Client:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="959.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="963" y="24.836">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="32" x="959.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="25" x="963" y="3210.0794">Mallory</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1213.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1217" y="24.836">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="114" x="1213.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="107" x="1217" y="3210.0794">Mallory:DiffieHellman (to Client)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="1332.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="1336" y="24.836">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="116" x="1332.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="109" x="1336" y="3210.0794">Mallory:DiffieHellman (to Server)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="1453.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="1457" y="24.836">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="92" x="1453.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="85" x="1457" y="3210.0794">Mallory:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="1550.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="1554" y="24.836">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="120.5" x="1550.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="113.5" x="1554" y="3210.0794">Mallory:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="1676" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="1679.5" y="24.836">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="89.5" x="1676" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="82.5" x="1679.5" y="3210.0794">Mallory:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="1770.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="1774" y="24.836">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="45.5" x="1770.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="38.5" x="1774" y="3210.0794">Server (API)</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="2050" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="2053.5" y="24.836">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="76.5" x="2050" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="69.5" x="2053.5" y="3210.0794">Server:DiffieHellman</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="2142.5" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="2146" y="24.836">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="88.5" x="2142.5" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="81.5" x="2146" y="3210.0794">Server:DHParamsLoader</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="2236" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="2239.5" y="24.836">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="117" x="2236" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="110" x="2239.5" y="3210.0794">Server:MessageExtractionFacility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="2358" y="13.853"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="2361.5" y="24.836">Server:EncryptionUtility</text><rect fill="#E2E2F0" height="16.534" rx="1.25" ry="1.25" style="stroke:#181818;stroke-width:0.25;" width="86" x="2358" y="3199.0965"/><text fill="#000000" font-family="sans-serif" font-size="7" lengthAdjust="spacing" textLength="79" x="2361.5" y="3210.0794">Server:EncryptionUtility</text><rect fill="#FFFFFF" height="3151.2095" style="stroke:#181818;stroke-width:0.5;" width="5" x="40.25" y="35.887"/><rect fill="#FFFFFF" height="3147.3565" style="stroke:#181818;stroke-width:0.5;" width="5" x="260.75" y="47.74"/><rect fill="#FFFFFF" height="1331.9087" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="203.417"/><rect fill="#FFFFFF" height="98.4711" style="stroke:#181818;stroke-width:0.5;" width="5" x="265.75" y="1369.3047"/><rect fill="#FFFFFF" height="1621.0647" style="stroke:#181818;stroke-width:0.5;" width="5" x="263.25" y="1547.1787"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="63.593"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="515.25" y="1327.6722"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1387.6577"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1563.0317"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1594.7378"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="1648.7968"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="3004.5664"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="910" y="3058.6254"/><rect fill="#FFFFFF" height="946.519" style="stroke:#181818;stroke-width:0.5;" width="5" x="973" y="277.6086"/><rect fill="#FFFFFF" height="1151.8865" style="stroke:#181818;stroke-width:0.5;" width="5" x="973" y="1708.2088"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="1268" y="299.3881"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1268" y="1080.965"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="1388" y="848.0964"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1388" y="993.847"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1031.4795"/><rect fill="#FFFFFF" height="52.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1118.5975"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1875.0329"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1929.0919"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="1963.7979"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2017.857"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2635.5062"/><rect fill="#FFFFFF" height="17.353" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2689.5653"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2724.2713"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="1718.25" y="2778.3303"/><rect fill="#FFFFFF" height="334.6927" style="stroke:#181818;stroke-width:0.5;" width="5" x="1790.75" y="491.6242"/><rect fill="#FFFFFF" height="1114.8275" style="stroke:#181818;stroke-width:0.5;" width="5" x="1790.75" y="2080.269"/><rect fill="#FFFFFF" height="81.765" style="stroke:#181818;stroke-width:0.5;" width="5" x="1793.25" y="2409.2701"/><rect fill="#FFFFFF" height="108.118" style="stroke:#181818;stroke-width:0.5;" width="5" x="2085.75" y="575.7423"/><rect fill="#FFFFFF" height="21.7795" style="stroke:#181818;stroke-width:0.5;" width="5" x="2085.75" y="721.4928"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2398.5" y="2247.0931"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2398.5" y="2301.1521"/><rect fill="#FFFFFF" height="15.853" style="stroke:#181818;stroke-width:0.5;" width="5" x="2398.5" y="2355.2111"/><polygon fill="#181818" points="254.75,45.74,259.75,47.74,254.75,49.74,256.75,47.74" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="257.75" y1="47.74" y2="47.74"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="94" x="48.75" y="44.8355">Create Client("Bob", debugFlag)</text><polygon fill="#181818" points="509.25,61.593,514.25,63.593,509.25,65.593,511.25,63.593" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="265.75" x2="512.25" y1="63.593" y2="63.593"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97" x="269.25" y="60.6885">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="696.25,77.446,701.25,79.446,696.25,81.446,698.25,79.446" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.25" x2="699.25" y1="79.446" y2="79.446"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="170" x="523.75" y="76.5415">loadDhParameters(getDhParametersFilenameLocation())</text><polygon fill="#181818" points="525.75,93.299,520.75,95.299,525.75,97.299,523.75,95.299" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="522.75" x2="701.75" y1="95.299" y2="95.299"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="528.75" y="92.3945">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="520.25" x2="541.25" y1="111.152" y2="111.152"/><line style="stroke:#181818;stroke-width:0.5;" x1="541.25" x2="541.25" y1="111.152" y2="117.652"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.75" x2="541.25" y1="117.652" y2="117.652"/><polygon fill="#181818" points="525.75,115.652,520.75,117.652,525.75,119.652,523.75,117.652" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="523.75" y="108.2475">generatePrivateKey()</text><line style="stroke:#181818;stroke-width:0.5;" x1="520.25" x2="541.25" y1="133.505" y2="133.505"/><line style="stroke:#181818;stroke-width:0.5;" x1="541.25" x2="541.25" y1="133.505" y2="140.005"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.75" x2="541.25" y1="140.005" y2="140.005"/><polygon fill="#181818" points="525.75,138.005,520.75,140.005,525.75,142.005,523.75,140.005" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="523.75" y="130.6005">generatePublicKey()</text><polygon fill="#181818" points="802,153.858,807,155.858,802,157.858,804,155.858" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="520.25" x2="805" y1="155.858" y2="155.858"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="523.75" y="152.9535">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="523.25,169.711,518.25,171.711,523.25,173.711,521.25,171.711" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="520.25" x2="807.5" y1="171.711" y2="171.711"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="526.25" y="168.8065">Public Key A (hex)</text><polygon fill="#181818" points="271.25,185.564,266.25,187.564,271.25,189.564,269.25,187.564" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="517.25" y1="187.564" y2="187.564"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103.5" x="274.25" y="184.6595">Client:DiffieHellman instance ready</text><polygon fill="#181818" points="257.25,201.417,262.25,203.417,257.25,205.417,259.25,203.417" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="260.25" y1="203.417" y2="203.417"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="130" x="48.75" y="200.5125">diffieHellmanKeyExchange(productionPort)</text><polygon fill="#181818" points="906.5,217.2701,911.5,219.2701,906.5,221.2701,908.5,219.2701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="909.5" y1="219.2701" y2="219.2701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="271.75" y="216.3656">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="273.75,243.4761,268.75,245.4761,273.75,247.4761,271.75,245.4761" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="912" y1="245.4761" y2="245.4761"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="47.5" x="276.75" y="242.5716">clientNonceHex</text><path d="M140.5,225.7701 L140.5,257.2701 L258,257.2701 L258,230.7701 L253,225.7701 L140.5,225.7701 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,225.7701 L253,230.7701 L258,230.7701 L253,225.7701 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="107" x="143.5" y="235.2186">Client constructs JSON "client_hello"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="76.5" x="143.5" y="244.0716">with clientId, clientNonce,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="72.5" x="143.5" y="252.9246">groupName, publicKeyA</text><polygon fill="#181818" points="967,275.6086,972,277.6086,967,279.6086,969,277.6086" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="970" y1="277.6086" y2="277.6086"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="271.75" y="274.7041">HTTP POST /keyExchange (ClientHello JSON)</text><path d="M980.5,262.3291 L980.5,284.8291 L1113.5,284.8291 L1113.5,267.3291 L1108.5,262.3291 L980.5,262.3291 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1108.5,262.3291 L1108.5,267.3291 L1113.5,267.3291 L1108.5,262.3291 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="89.5" x="983.5" y="271.7776">Mallory intercepts ClientHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="983.5" y="280.6306">She extracts publicKeyA and clientNonce.</text><polygon fill="#181818" points="1262,297.3881,1267,299.3881,1262,301.3881,1264,299.3881" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1265" y1="299.3881" y2="299.3881"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97" x="981.5" y="296.4836">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="1493.5,313.2411,1498.5,315.2411,1493.5,317.2411,1495.5,315.2411" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1273" x2="1496.5" y1="315.2411" y2="315.2411"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1276.5" y="312.3366">loadDhParameters()</text><polygon fill="#181818" points="1278.5,329.0941,1273.5,331.0941,1278.5,333.0941,1276.5,331.0941" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1275.5" x2="1499" y1="331.0941" y2="331.0941"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1281.5" y="328.1896">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1273" x2="1294" y1="346.9471" y2="346.9471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1294" x2="1294" y1="346.9471" y2="353.4471"/><line style="stroke:#181818;stroke-width:0.5;" x1="1273.5" x2="1294" y1="353.4471" y2="353.4471"/><polygon fill="#181818" points="1278.5,351.4471,1273.5,353.4471,1278.5,355.4471,1276.5,353.4471" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1276.5" y="344.0426">generatePrivateKey()</text><path d="M1345.5,339.3441 L1345.5,352.8441 L1461.5,352.8441 L1461.5,344.3441 L1456.5,339.3441 L1345.5,339.3441 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1456.5,339.3441 L1456.5,344.3441 L1461.5,344.3441 L1456.5,339.3441 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105.5" x="1348.5" y="348.7926">Mallory generates private key 'm_a'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1273" x2="1294" y1="369.3001" y2="369.3001"/><line style="stroke:#181818;stroke-width:0.5;" x1="1294" x2="1294" y1="369.3001" y2="375.8001"/><line style="stroke:#181818;stroke-width:0.5;" x1="1273.5" x2="1294" y1="375.8001" y2="375.8001"/><polygon fill="#181818" points="1278.5,373.8001,1273.5,375.8001,1278.5,377.8001,1276.5,375.8001" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1276.5" y="366.3956">generatePublicKey()</text><path d="M1342.5,361.6971 L1342.5,375.1971 L1496,375.1971 L1496,366.6971 L1491,361.6971 L1342.5,361.6971 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1491,361.6971 L1491,366.6971 L1496,366.6971 L1491,361.6971 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="1345.5" y="371.1456">Mallory computes public key M_A = (g^m_a) % p</text><polygon fill="#181818" points="1604.75,389.6531,1609.75,391.6531,1604.75,393.6531,1606.75,391.6531" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1273" x2="1607.75" y1="391.6531" y2="391.6531"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1276.5" y="388.7486">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1276,405.5062,1271,407.5062,1276,409.5062,1274,407.5062" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1273" x2="1610.25" y1="407.5062" y2="407.5062"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="1279" y="404.6017">Public Key M_A (hex)</text><polygon fill="#181818" points="983.5,421.3592,978.5,423.3592,983.5,425.3592,981.5,423.3592" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1270" y1="423.3592" y2="423.3592"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="986.5" y="420.4547">Mallory:DiffieHellman instance (to Client) ready</text><polygon fill="#181818" points="1714.75,437.2122,1719.75,439.2122,1714.75,441.2122,1716.75,439.2122" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1717.75" y1="439.2122" y2="439.2122"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="981.5" y="436.3077">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="983.5,463.4182,978.5,465.4182,983.5,467.4182,981.5,465.4182" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="465.4182" y2="465.4182"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83" x="986.5" y="462.5137">malloryNonceToClient (hex)</text><path d="M784,445.7122 L784,477.2122 L970.5,477.2122 L970.5,450.7122 L965.5,445.7122 L784,445.7122 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,445.7122 L965.5,450.7122 L970.5,450.7122 L965.5,445.7122 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="787" y="455.1607">Mallory constructs her own ClientHello to Server</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="114" x="787" y="464.0137">with MalloryId, malloryNonceToClient,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="176" x="787" y="472.8667">groupName, publicKeyM_A (Mallory's public key for Server)</text><polygon fill="#181818" points="1784.75,489.6242,1789.75,491.6242,1784.75,493.6242,1786.75,491.6242" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1787.75" y1="491.6242" y2="491.6242"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="160.5" x="981.5" y="488.7197">HTTP POST /keyExchange (Mallory's ClientHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="514.5802" y2="514.5802"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="514.5802" y2="521.0802"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="521.0802" y2="521.0802"/><polygon fill="#181818" points="1801.25,519.0802,1796.25,521.0802,1801.25,523.0802,1799.25,521.0802" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="111.5" x="1799.25" y="511.6757">Parse ClientHello JSON (from Mallory)</text><path d="M1916.5,498.1242 L1916.5,529.6242 L2066.5,529.6242 L2066.5,503.1242 L2061.5,498.1242 L1916.5,498.1242 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2061.5,498.1242 L2061.5,503.1242 L2066.5,503.1242 L2061.5,498.1242 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="135.5" x="1919.5" y="507.5727">Server extracts MalloryId (thinks it's client ID),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="1919.5" y="516.4257">malloryNonceToClient (thinks it's client nonce),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="129.5" x="1919.5" y="525.2787">publicKeyM_A (thinks it's client publicKeyA).</text><polygon fill="#181818" points="2395,542.0362,2400,544.0362,2395,546.0362,2397,544.0362" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2398" y1="544.0362" y2="544.0362"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="123.5" x="1799.25" y="541.1317">generateCryptographicNonce(nonceSize)</text><polygon fill="#181818" points="1801.25,557.8892,1796.25,559.8892,1801.25,561.8892,1799.25,559.8892" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2400.5" y1="559.8892" y2="559.8892"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="50" x="1804.25" y="556.9847">serverNonceHex</text><polygon fill="#181818" points="2079.75,573.7423,2084.75,575.7423,2079.75,577.7423,2081.75,575.7423" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2082.75" y1="575.7423" y2="575.7423"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97" x="1799.25" y="572.8378">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="2180.75,589.5953,2185.75,591.5953,2180.75,593.5953,2182.75,591.5953" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2090.75" x2="2183.75" y1="591.5953" y2="591.5953"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2094.25" y="588.6908">loadDhParameters()</text><polygon fill="#181818" points="2096.25,605.4483,2091.25,607.4483,2096.25,609.4483,2094.25,607.4483" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2093.25" x2="2186.25" y1="607.4483" y2="607.4483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="2099.25" y="604.5438">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="2090.75" x2="2111.75" y1="623.3013" y2="623.3013"/><line style="stroke:#181818;stroke-width:0.5;" x1="2111.75" x2="2111.75" y1="623.3013" y2="629.8013"/><line style="stroke:#181818;stroke-width:0.5;" x1="2091.25" x2="2111.75" y1="629.8013" y2="629.8013"/><polygon fill="#181818" points="2096.25,627.8013,2091.25,629.8013,2096.25,631.8013,2094.25,629.8013" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="2094.25" y="620.3968">generatePrivateKey()</text><path d="M2163,615.6983 L2163,629.1983 L2267,629.1983 L2267,620.6983 L2262,615.6983 L2163,615.6983 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2262,615.6983 L2262,620.6983 L2267,620.6983 L2262,615.6983 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93.5" x="2166" y="625.1468">Server generates private key 'b'</text><line style="stroke:#181818;stroke-width:0.5;" x1="2090.75" x2="2111.75" y1="645.6543" y2="645.6543"/><line style="stroke:#181818;stroke-width:0.5;" x1="2111.75" x2="2111.75" y1="645.6543" y2="652.1543"/><line style="stroke:#181818;stroke-width:0.5;" x1="2091.25" x2="2111.75" y1="652.1543" y2="652.1543"/><polygon fill="#181818" points="2096.25,650.1543,2091.25,652.1543,2096.25,654.1543,2094.25,652.1543" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="2094.25" y="642.7498">generatePublicKey()</text><path d="M2160,638.0513 L2160,651.5513 L2261,651.5513 L2261,643.0513 L2256,638.0513 L2160,638.0513 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2256,638.0513 L2256,643.0513 L2261,643.0513 L2256,638.0513 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="90.5" x="2163" y="647.4998">Server computes B = (g^b) % p</text><polygon fill="#181818" points="2288.5,666.0073,2293.5,668.0073,2288.5,670.0073,2290.5,668.0073" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2090.75" x2="2291.5" y1="668.0073" y2="668.0073"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="2094.25" y="665.1028">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="2093.75,681.8603,2088.75,683.8603,2093.75,685.8603,2091.75,683.8603" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="2090.75" x2="2294" y1="683.8603" y2="683.8603"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="52.5" x="2096.75" y="680.9558">Public Key B (hex)</text><polygon fill="#181818" points="1801.25,697.7133,1796.25,699.7133,1801.25,701.7133,1799.25,699.7133" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2087.75" y1="699.7133" y2="699.7133"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105.5" x="1804.25" y="696.8088">Server:DiffieHellman instance ready</text><polygon fill="#181818" points="2079.75,719.4928,2084.75,721.4928,2079.75,723.4928,2081.75,721.4928" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2082.75" y1="721.4928" y2="721.4928"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="1799.25" y="718.5883">deriveSharedSecret(publicKeyM_A, serverNonceHex, malloryNonceToClient)</text><path d="M2093,706.2133 L2093,728.7133 L2324.5,728.7133 L2324.5,711.2133 L2319.5,706.2133 L2093,706.2133 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2319.5,706.2133 L2319.5,711.2133 L2324.5,711.2133 L2319.5,706.2133 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="221" x="2096" y="715.6618">Server computes shared secret s'_M_S = (publicKeyM_A ^ privateKeyB) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="157.5" x="2096" y="724.5148">This is the shared secret between Mallory and Server.</text><polygon fill="#181818" points="1801.25,741.2723,1796.25,743.2723,1801.25,745.2723,1799.25,743.2723" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2087.75" y1="743.2723" y2="743.2723"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93" x="1804.25" y="740.3678">_derivedSymmetricKeyHex_MS</text><polygon fill="#181818" points="2395,757.1253,2400,759.1253,2395,761.1253,2397,759.1253" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2398" y1="759.1253" y2="759.1253"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="290" x="1799.25" y="756.2208">encryptMessageAes256CbcMode(confirmationMsg, _derivedSymmetricKeyHex_MS, generatedIv)</text><polygon fill="#181818" points="1801.25,787.7579,1796.25,789.7579,1801.25,791.7579,1799.25,789.7579" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2400.5" y1="789.7579" y2="789.7579"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43" x="1804.25" y="786.8534">ciphertext_MS</text><path d="M1626,765.6253 L1626,805.6253 L1788,805.6253 L1788,770.6253 L1783,765.6253 L1626,765.6253 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1783,765.6253 L1783,770.6253 L1788,770.6253 L1783,765.6253 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="138" x="1629" y="775.0739">Server constructs JSON response (ServerHello)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="121" x="1629" y="783.9269">with sessionId, serverNonce, publicKeyB,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151.5" x="1629" y="792.7799">encrypted confirmation (ciphertext_MS, ivHex_MS)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="1629" y="801.6329">Server believes it's sending to "Bob" (Mallory)</text><polygon fill="#181818" points="983.5,824.3169,978.5,826.3169,983.5,828.3169,981.5,826.3169" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1792.75" y1="826.3169" y2="826.3169"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95.5" x="986.5" y="823.4124">HTTP 201 OK (ServerHello JSON)</text><path d="M1798,811.0374 L1798,833.5374 L2031.5,833.5374 L2031.5,816.0374 L2026.5,811.0374 L1798,811.0374 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M2026.5,811.0374 L2026.5,816.0374 L2031.5,816.0374 L2026.5,811.0374 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="91.5" x="1801" y="820.4859">Mallory intercepts ServerHello.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="223" x="1801" y="829.3389">She extracts sessionId, serverNonce, publicKeyB, ciphertext_MS, ivHex_MS.</text><polygon fill="#181818" points="1382,846.0964,1387,848.0964,1382,850.0964,1384,848.0964" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1385" y1="848.0964" y2="848.0964"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97" x="981.5" y="845.1919">Create DiffieHellman(debugFlag)</text><polygon fill="#181818" points="1493.5,861.9494,1498.5,863.9494,1493.5,865.9494,1495.5,863.9494" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1393" x2="1496.5" y1="863.9494" y2="863.9494"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1396.5" y="861.0449">loadDhParameters()</text><polygon fill="#181818" points="1398.5,877.8024,1393.5,879.8024,1398.5,881.8024,1396.5,879.8024" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1395.5" x2="1499" y1="879.8024" y2="879.8024"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="84" x="1401.5" y="876.8979">Returns DHParameters map</text><line style="stroke:#181818;stroke-width:0.5;" x1="1393" x2="1414" y1="895.6554" y2="895.6554"/><line style="stroke:#181818;stroke-width:0.5;" x1="1414" x2="1414" y1="895.6554" y2="902.1554"/><line style="stroke:#181818;stroke-width:0.5;" x1="1393.5" x2="1414" y1="902.1554" y2="902.1554"/><polygon fill="#181818" points="1398.5,900.1554,1393.5,902.1554,1398.5,904.1554,1396.5,902.1554" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63" x="1396.5" y="892.7509">generatePrivateKey()</text><path d="M1465.5,888.0524 L1465.5,901.5524 L1582,901.5524 L1582,893.0524 L1577,888.0524 L1465.5,888.0524 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1577,888.0524 L1577,893.0524 L1582,893.0524 L1577,888.0524 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="106" x="1468.5" y="897.5009">Mallory generates private key 'm_b'</text><line style="stroke:#181818;stroke-width:0.5;" x1="1393" x2="1414" y1="918.0084" y2="918.0084"/><line style="stroke:#181818;stroke-width:0.5;" x1="1414" x2="1414" y1="918.0084" y2="924.5084"/><line style="stroke:#181818;stroke-width:0.5;" x1="1393.5" x2="1414" y1="924.5084" y2="924.5084"/><polygon fill="#181818" points="1398.5,922.5084,1393.5,924.5084,1398.5,926.5084,1396.5,924.5084" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60" x="1396.5" y="915.1039">generatePublicKey()</text><path d="M1462.5,910.4054 L1462.5,923.9054 L1616.5,923.9054 L1616.5,915.4054 L1611.5,910.4054 L1462.5,910.4054 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1611.5,910.4054 L1611.5,915.4054 L1616.5,915.4054 L1611.5,910.4054 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143.5" x="1465.5" y="919.8539">Mallory computes public key M_B = (g^m_b) % p</text><polygon fill="#181818" points="1604.75,938.3614,1609.75,940.3614,1604.75,942.3614,1606.75,940.3614" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1393" x2="1607.75" y1="940.3614" y2="940.3614"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="97.5" x="1396.5" y="937.4569">BIGNUMToHex(_publicKey.get())</text><polygon fill="#181818" points="1396,954.2145,1391,956.2145,1396,958.2145,1394,956.2145" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1393" x2="1610.25" y1="956.2145" y2="956.2145"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="61.5" x="1399" y="953.31">Public Key M_B (hex)</text><polygon fill="#181818" points="983.5,970.0675,978.5,972.0675,983.5,974.0675,981.5,972.0675" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1390" y1="972.0675" y2="972.0675"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="141.5" x="986.5" y="969.163">Mallory:DiffieHellman instance (to Server) ready</text><polygon fill="#181818" points="1382,991.847,1387,993.847,1382,995.847,1384,993.847" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1385" y1="993.847" y2="993.847"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="217.5" x="981.5" y="990.9425">deriveSharedSecret(publicKeyB, malloryNonceToClient, serverNonceHex)</text><path d="M1395.5,978.5675 L1395.5,1001.0675 L1631.5,1001.0675 L1631.5,983.5675 L1626.5,978.5675 L1395.5,978.5675 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1626.5,978.5675 L1626.5,983.5675 L1631.5,983.5675 L1626.5,978.5675 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="223" x="1398.5" y="988.016">Mallory computes shared secret s_M_S = (publicKeyB ^ privateKeyM_B) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="225.5" x="1398.5" y="996.869">This is the same secret as _derivedSymmetricKeyHex_MS on the Server side.</text><polygon fill="#181818" points="983.5,1013.6265,978.5,1015.6265,983.5,1017.6265,981.5,1015.6265" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1390" y1="1015.6265" y2="1015.6265"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93" x="986.5" y="1012.722">_derivedSymmetricKeyHex_MS</text><polygon fill="#181818" points="1712.25,1029.4795,1717.25,1031.4795,1712.25,1033.4795,1714.25,1031.4795" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="1031.4795" y2="1031.4795"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="262.5" x="981.5" y="1028.575">decryptMessageAes256CbcMode(ciphertext_MS, _derivedSymmetricKeyHex_MS, iv_MS)</text><polygon fill="#181818" points="983.5,1051.259,978.5,1053.259,983.5,1055.259,981.5,1053.259" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="1053.259" y2="1053.259"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="69.5" x="986.5" y="1050.3545">decryptedPlaintext_MS</text><path d="M1725.5,1037.9795 L1725.5,1060.4795 L1946,1060.4795 L1946,1042.9795 L1941,1037.9795 L1725.5,1037.9795 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1941,1037.9795 L1941,1042.9795 L1946,1042.9795 L1941,1037.9795 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="210" x="1728.5" y="1047.428">Mallory now has the decrypted confirmation message from the Server.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="103" x="1728.5" y="1056.281">She can read it, modify it if desired.</text><polygon fill="#181818" points="1262,1078.965,1267,1080.965,1262,1082.965,1264,1080.965" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1265" y1="1080.965" y2="1080.965"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="215" x="981.5" y="1078.0605">deriveSharedSecret(publicKeyA, clientNonceHex, malloryNonceToClient)</text><path d="M1275.5,1065.6855 L1275.5,1088.1855 L1509.5,1088.1855 L1509.5,1070.6855 L1504.5,1065.6855 L1275.5,1065.6855 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1504.5,1065.6855 L1504.5,1070.6855 L1509.5,1070.6855 L1504.5,1065.6855 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="223.5" x="1278.5" y="1075.134">Mallory computes shared secret s_A_M = (publicKeyA ^ privateKeyM_A) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="152" x="1278.5" y="1083.987">This is the shared secret between Alice and Mallory.</text><polygon fill="#181818" points="983.5,1100.7445,978.5,1102.7445,983.5,1104.7445,981.5,1102.7445" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1270" y1="1102.7445" y2="1102.7445"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="93.5" x="986.5" y="1099.84">_derivedSymmetricKeyHex_AM</text><polygon fill="#181818" points="1712.25,1116.5975,1717.25,1118.5975,1712.25,1120.5975,1714.25,1118.5975" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="1118.5975" y2="1118.5975"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="391.5" x="981.5" y="1115.693">encryptMessageAes256CbcMode(decryptedPlaintext_MS_possibly_modified, _derivedSymmetricKeyHex_AM, newGeneratedIv_AM)</text><polygon fill="#181818" points="983.5,1169.3626,978.5,1171.3626,983.5,1173.3626,981.5,1171.3626" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="1171.3626" y2="1171.3626"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="986.5" y="1168.4581">ciphertext_AM</text><path d="M729,1125.0975 L729,1209.5975 L970.5,1209.5975 L970.5,1130.0975 L965.5,1125.0975 L729,1125.0975 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,1125.0975 L965.5,1130.0975 L970.5,1130.0975 L965.5,1125.0975 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="144" x="732" y="1134.5461">Mallory constructs her own ServerHello to Client</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="186.5" x="732" y="1143.3991">with original sessionId, serverNonce (Mallory's), publicKeyM_B,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="119.5" x="732" y="1152.2521">encrypted confirmation (ciphertext_AM)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="732" y="1161.1051">Mallory sends her own public key (M_B) to the client,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="732" y="1169.9581">making Alice believe M_B is Bob's public key.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="143" x="732" y="1178.8111">Mallory uses the server's nonce she intercepted,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="732" y="1187.6641">or generates a new one, depending on the scenario.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197.5" x="732" y="1196.5171">For simplicity here, let's say she forwards the original serverNonce.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="231" x="732" y="1205.3701">(Or rather, the one she sent to the server as 'clientNonce' for her own session)</text><polygon fill="#181818" points="273.75,1222.1276,268.75,1224.1276,273.75,1226.1276,271.75,1224.1276" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="975" y1="1224.1276" y2="1224.1276"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124" x="276.75" y="1221.2231">HTTP 201 OK (Mallory's ServerHello JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="1242.6571" y2="1242.6571"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="1242.6571" y2="1249.1571"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="1249.1571" y2="1249.1571"/><polygon fill="#181818" points="273.75,1247.1571,268.75,1249.1571,273.75,1251.1571,271.75,1249.1571" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="142.5" x="271.75" y="1239.7526">Parse ServerHello JSON response (from Mallory)</text><path d="M420,1230.6276 L420,1253.1276 L629.5,1253.1276 L629.5,1235.6276 L624.5,1230.6276 L420,1230.6276 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M624.5,1230.6276 L624.5,1235.6276 L629.5,1235.6276 L624.5,1230.6276 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="423" y="1240.0761">Client extracts sessionId, serverNonce (Mallory's),</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="199" x="423" y="1248.9291">groupName, publicKeyB (Mallory's M_B), ciphertext_AM, ivHex_AM</text><polygon fill="#181818" points="802,1265.6867,807,1267.6867,802,1269.6867,804,1267.6867" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="805" y1="1267.6867" y2="1267.6867"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="69" x="271.75" y="1264.7822">hexToBytes(ivHex_AM)</text><polygon fill="#181818" points="273.75,1281.5397,268.75,1283.5397,273.75,1285.5397,271.75,1283.5397" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="807.5" y1="1283.5397" y2="1283.5397"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="57.5" x="276.75" y="1280.6352">iv (vector&lt;uint8_t&gt;)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="1299.3927" y2="1299.3927"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="1299.3927" y2="1305.8927"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="1305.8927" y2="1305.8927"/><polygon fill="#181818" points="273.75,1303.8927,268.75,1305.8927,273.75,1307.8927,271.75,1305.8927" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118.5" x="271.75" y="1296.4882">Store SessionData in _diffieHellmanMap</text><polygon fill="#181818" points="509.25,1325.6722,514.25,1327.6722,509.25,1329.6722,511.25,1327.6722" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="512.25" y1="1327.6722" y2="1327.6722"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="198.5" x="271.75" y="1324.7677">deriveSharedSecret(publicKeyB, serverNonceHex, clientNonceHex)</text><path d="M522.5,1312.3927 L522.5,1334.8927 L735,1334.8927 L735,1317.3927 L730,1312.3927 L522.5,1312.3927 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M730,1312.3927 L730,1317.3927 L735,1317.3927 L730,1312.3927 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="202" x="525.5" y="1321.8412">Client computes shared secret s = (publicKeyM_B ^ privateKeyA) % p</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="174.5" x="525.5" y="1330.6942">This is the shared secret between Client (Alice) and Mallory.</text><polygon fill="#181818" points="273.75,1347.4517,268.75,1349.4517,273.75,1351.4517,271.75,1349.4517" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="517.25" y1="1349.4517" y2="1349.4517"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="136" x="276.75" y="1346.5472">_derivedSymmetricKeyHex (Alice-Mallory key)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="291.75" y1="1362.8047" y2="1362.8047"/><line style="stroke:#181818;stroke-width:0.5;" x1="291.75" x2="291.75" y1="1362.8047" y2="1369.3047"/><line style="stroke:#181818;stroke-width:0.5;" x1="271.25" x2="291.75" y1="1369.3047" y2="1369.3047"/><polygon fill="#181818" points="276.25,1367.3047,271.25,1369.3047,276.25,1371.3047,274.25,1369.3047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="95" x="274.25" y="1359.9002">confirmationServerResponse(...)</text><polygon fill="#181818" points="904,1385.6577,909,1387.6577,904,1389.6577,906,1387.6577" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="270.75" x2="907" y1="1387.6577" y2="1387.6577"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="238" x="274.25" y="1384.7532">decryptMessageAes256CbcMode(ciphertext_AM, _derivedSymmetricKeyHex, iv)</text><polygon fill="#181818" points="276.25,1401.5107,271.25,1403.5107,276.25,1405.5107,274.25,1403.5107" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="273.25" x2="912" y1="1403.5107" y2="1403.5107"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="101" x="279.25" y="1400.6062">decryptedPlaintext (from Mallory)</text><line style="stroke:#181818;stroke-width:0.5;" x1="270.75" x2="291.75" y1="1430.8932" y2="1430.8932"/><line style="stroke:#181818;stroke-width:0.5;" x1="291.75" x2="291.75" y1="1430.8932" y2="1437.3932"/><line style="stroke:#181818;stroke-width:0.5;" x1="271.25" x2="291.75" y1="1437.3932" y2="1437.3932"/><polygon fill="#181818" points="276.25,1435.3932,271.25,1437.3932,276.25,1439.3932,274.25,1437.3932" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96" x="274.25" y="1427.9887">Parse decryptedPlaintext (JSON)</text><path d="M376,1410.0107 L376,1450.0107 L571,1450.0107 L571,1415.0107 L566,1410.0107 L376,1410.0107 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M566,1410.0107 L566,1415.0107 L571,1415.0107 L566,1410.0107 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="96.5" x="379" y="1419.4592">Client compares extracted fields.</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="150.5" x="379" y="1428.3122">Since Mallory forwarded a valid (possibly modified)</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="379" y="1437.1652">confirmation, this validation will likely pass,</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="184.5" x="379" y="1446.0183">making Alice believe she successfully communicated with Bob.</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="291.75" y1="1467.2758" y2="1467.2758"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="291.75" x2="291.75" y1="1467.2758" y2="1473.7758"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="268.25" x2="291.75" y1="1473.7758" y2="1473.7758"/><polygon fill="#181818" points="273.25,1471.7758,268.25,1473.7758,273.25,1475.7758,271.25,1473.7758" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="146" x="274.25" y="1464.3713">(bool validationResult, string decryptedMessage)</text><path d="M5,1478.7758 L36.5,1478.7758 L36.5,1483.6288 L31.5,1488.6288 L5,1488.6288 L5,1478.7758 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="53.05" style="stroke:#000000;stroke-width:0.75;" width="439.75" x="5" y="1478.7758"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="12.5" y="1486.2243">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="69.5" x="44" y="1485.6552">[validationResult == true]</text><polygon fill="#181818" points="50.75,1499.9818,45.75,1501.9818,50.75,1503.9818,48.75,1501.9818" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="262.75" y1="1501.9818" y2="1501.9818"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="203.5" x="53.75" y="1499.0773">Logs "Diffie Hellman key exchange succeed" and decrypted message</text><path d="M270.5,1491.1288 L270.5,1504.6288 L437,1504.6288 L437,1496.1288 L432,1491.1288 L270.5,1491.1288 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M432,1491.1288 L432,1496.1288 L437,1496.1288 L432,1491.1288 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="156" x="273.5" y="1500.5773">Client is unaware it succeeded with Mallory, not Bob.</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="5" x2="444.75" y1="1507.9818" y2="1507.9818"/><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="70.5" x="7.5" y="1513.8612">[validationResult == false]</text><polygon fill="#181818" points="50.75,1525.8257,45.75,1527.8257,50.75,1529.8257,48.75,1527.8257" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="47.75" x2="262.75" y1="1527.8257" y2="1527.8257"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="53.75" y="1524.9212">Logs "Diffie Hellman key exchange failed"</text><polygon fill="#181818" points="257.25,1545.1787,262.25,1547.1787,257.25,1549.1787,259.25,1547.1787" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="260.25" y1="1547.1787" y2="1547.1787"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147.5" x="48.75" y="1544.2742">messageExchange(portServerNumber, sessionId)</text><polygon fill="#181818" points="904,1561.0317,909,1563.0317,904,1565.0317,906,1563.0317" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="907" y1="1563.0317" y2="1563.0317"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="271.75" y="1560.1272">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="273.75,1576.8848,268.75,1578.8848,273.75,1580.8848,271.75,1578.8848" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="912" y1="1578.8848" y2="1578.8848"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="41" x="276.75" y="1575.9803">newIVrotated</text><polygon fill="#181818" points="904,1592.7378,909,1594.7378,904,1596.7378,906,1594.7378" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="907" y1="1594.7378" y2="1594.7378"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="79.5" x="271.75" y="1591.8333">getFormattedTimestamp()</text><polygon fill="#181818" points="273.75,1608.5908,268.75,1610.5908,273.75,1612.5908,271.75,1610.5908" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="912" y1="1610.5908" y2="1610.5908"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="46.5" x="276.75" y="1607.6863">newTimeStamp</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="1626.4438" y2="1626.4438"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="1626.4438" y2="1632.9438"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="1632.9438" y2="1632.9438"/><polygon fill="#181818" points="273.75,1630.9438,268.75,1632.9438,273.75,1634.9438,271.75,1632.9438" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="240" x="271.75" y="1623.5393">built message sent with clientId, sessionId, newTimeStamp as clientMessageSent</text><polygon fill="#181818" points="904,1646.7968,909,1648.7968,904,1650.7968,906,1648.7968" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="907" y1="1648.7968" y2="1648.7968"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="282.5" x="271.75" y="1645.8923">encryptMessageAes256CbcMode(newPlaintext, _derivedSymmetricKeyHex_AM, newIVrotated)</text><polygon fill="#181818" points="273.75,1662.6498,268.75,1664.6498,273.75,1666.6498,271.75,1664.6498" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="912" y1="1664.6498" y2="1664.6498"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="276.75" y="1661.7453">ciphertext_AM</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="1683.1793" y2="1683.1793"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="1683.1793" y2="1689.6793"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="1689.6793" y2="1689.6793"/><polygon fill="#181818" points="273.75,1687.6793,268.75,1689.6793,273.75,1691.6793,271.75,1689.6793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="125.5" x="271.75" y="1680.2748">built "client_message_exchange" message</text><path d="M96.5,1671.1498 L96.5,1693.6498 L258,1693.6498 L258,1676.1498 L253,1671.1498 L96.5,1671.1498 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M253,1671.1498 L253,1676.1498 L258,1676.1498 L253,1671.1498 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="151" x="99.5" y="1680.5983">Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="131.5" x="99.5" y="1689.4513">with sessionId, newIVrotated and ciphertext</text><polygon fill="#181818" points="967,1706.2088,972,1708.2088,967,1710.2088,969,1708.2088" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="970" y1="1708.2088" y2="1708.2088"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="271.75" y="1705.3043">HTTP POST /messageExchange (client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1724.0618" y2="1724.0618"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1724.0618" y2="1730.5618"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1730.5618" y2="1730.5618"/><polygon fill="#181818" points="983.5,1728.5618,978.5,1730.5618,983.5,1732.5618,981.5,1730.5618" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="981.5" y="1721.1573">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1746.4148" y2="1746.4148"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1746.4148" y2="1752.9148"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1752.9148" y2="1752.9148"/><polygon fill="#181818" points="983.5,1750.9148,978.5,1752.9148,983.5,1754.9148,981.5,1752.9148" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="981.5" y="1743.5103">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1768.7678" y2="1768.7678"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1768.7678" y2="1775.2678"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1775.2678" y2="1775.2678"/><polygon fill="#181818" points="983.5,1773.2678,978.5,1775.2678,983.5,1777.2678,981.5,1775.2678" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="981.5" y="1765.8633">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1791.1209" y2="1791.1209"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1791.1209" y2="1797.6209"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1797.6209" y2="1797.6209"/><polygon fill="#181818" points="983.5,1795.6209,978.5,1797.6209,983.5,1799.6209,981.5,1797.6209" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="981.5" y="1788.2164">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1813.4739" y2="1813.4739"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1813.4739" y2="1819.9739"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1819.9739" y2="1819.9739"/><polygon fill="#181818" points="983.5,1817.9739,978.5,1819.9739,983.5,1821.9739,981.5,1819.9739" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="981.5" y="1810.5694">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M954.5,1827.4739 L986,1827.4739 L986,1832.3269 L981,1837.3269 L954.5,1837.3269 L954.5,1827.4739 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="128" x="954.5" y="1827.4739"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="962" y="1834.9224">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="86.5" x="993.5" y="1834.3533">[sessionIdASFoundFlag == false]</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1849.1799" y2="1849.1799"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1849.1799" y2="1855.6799"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1855.6799" y2="1855.6799"/><polygon fill="#181818" points="983.5,1853.6799,978.5,1855.6799,983.5,1857.6799,981.5,1855.6799" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="981.5" y="1846.2754">Throws an exception</text><polygon fill="#181818" points="1712.25,1873.0329,1717.25,1875.0329,1712.25,1877.0329,1714.25,1875.0329" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="1875.0329" y2="1875.0329"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="981.5" y="1872.1284">hexToBytes(extractedIv)</text><polygon fill="#181818" points="983.5,1888.8859,978.5,1890.8859,983.5,1892.8859,981.5,1890.8859" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="1890.8859" y2="1890.8859"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="986.5" y="1887.9814">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1906.7389" y2="1906.7389"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1906.7389" y2="1913.2389"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="1913.2389" y2="1913.2389"/><polygon fill="#181818" points="983.5,1911.2389,978.5,1913.2389,983.5,1915.2389,981.5,1913.2389" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="981.5" y="1903.8344">store new iv in bytes for that session id</text><polygon fill="#181818" points="1712.25,1927.0919,1717.25,1929.0919,1712.25,1931.0919,1714.25,1929.0919" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="1929.0919" y2="1929.0919"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="226.5" x="981.5" y="1926.1874">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, ivAM)</text><polygon fill="#181818" points="983.5,1944.4449,978.5,1946.4449,983.5,1948.4449,981.5,1946.4449" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="1946.4449" y2="1946.4449"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="986.5" y="1943.5404">plaintext</text><path d="M813,1935.5919 L813,1949.0919 L970.5,1949.0919 L970.5,1940.5919 L965.5,1935.5919 L813,1935.5919 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,1935.5919 L965.5,1940.5919 L970.5,1940.5919 L965.5,1935.5919 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="147" x="816" y="1945.0404">Mallory build fake client request to the real server</text><polygon fill="#181818" points="1712.25,1961.7979,1717.25,1963.7979,1712.25,1965.7979,1714.25,1963.7979" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="1963.7979" y2="1963.7979"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="981.5" y="1960.8934">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="983.5,1977.6509,978.5,1979.6509,983.5,1981.6509,981.5,1979.6509" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="1979.6509" y2="1979.6509"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="14.5" x="986.5" y="1976.7464">ivMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="1995.5039" y2="1995.5039"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="1995.5039" y2="2002.0039"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2002.0039" y2="2002.0039"/><polygon fill="#181818" points="983.5,2000.0039,978.5,2002.0039,983.5,2004.0039,981.5,2002.0039" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187.5" x="981.5" y="1992.5994">store new iv in bytes for that session id for Mallory -&gt; Server leg</text><polygon fill="#181818" points="1712.25,2015.857,1717.25,2017.857,1712.25,2019.857,1714.25,2017.857" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="2017.857" y2="2017.857"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="192.5" x="981.5" y="2014.9525">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivMS)</text><polygon fill="#181818" points="983.5,2033.21,978.5,2035.21,983.5,2037.21,981.5,2035.21" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="2035.21" y2="2035.21"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40" x="986.5" y="2032.3055">ciphertextMS</text><path d="M825.5,2024.357 L825.5,2037.857 L970.5,2037.857 L970.5,2029.357 L965.5,2024.357 L825.5,2024.357 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,2024.357 L965.5,2029.357 L970.5,2029.357 L965.5,2024.357 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="134.5" x="828.5" y="2033.8055">Mallory build body request for the real server</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2055.2395" y2="2055.2395"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2055.2395" y2="2061.7395"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2061.7395" y2="2061.7395"/><polygon fill="#181818" points="983.5,2059.7395,978.5,2061.7395,983.5,2063.7395,981.5,2061.7395" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="139.5" x="981.5" y="2052.335">built fake "client_message_exchange" message</text><path d="M771,2043.21 L771,2065.71 L970.5,2065.71 L970.5,2048.21 L965.5,2043.21 L771,2043.21 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,2043.21 L965.5,2048.21 L970.5,2048.21 L965.5,2043.21 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189" x="774" y="2052.6585">Mallory fake Client constructs JSON "client_message_exchange"</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="105" x="774" y="2061.5115">with sessionId, ivMS and ciphertext</text><polygon fill="#181818" points="1784.75,2078.269,1789.75,2080.269,1784.75,2082.269,1786.75,2080.269" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1787.75" y1="2080.269" y2="2080.269"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="207" x="981.5" y="2077.3645">HTTP POST /messageExchange (fake client_message_exchange JSON)</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2096.122" y2="2096.122"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2096.122" y2="2102.622"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2102.622" y2="2102.622"/><polygon fill="#181818" points="1801.25,2100.622,1796.25,2102.622,1801.25,2104.622,1799.25,2102.622" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="1799.25" y="2093.2175">Parse request body</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2118.475" y2="2118.475"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2118.475" y2="2124.975"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2124.975" y2="2124.975"/><polygon fill="#181818" points="1801.25,2122.975,1796.25,2124.975,1801.25,2126.975,1799.25,2124.975" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="1799.25" y="2115.5705">extract session id as extractedSessionIdUuidFormat</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2140.828" y2="2140.828"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2140.828" y2="2147.328"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2147.328" y2="2147.328"/><polygon fill="#181818" points="1801.25,2145.328,1796.25,2147.328,1801.25,2149.328,1799.25,2147.328" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="63.5" x="1799.25" y="2137.9235">extract iv as extractIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2163.181" y2="2163.181"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2163.181" y2="2169.681"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2169.681" y2="2169.681"/><polygon fill="#181818" points="1801.25,2167.681,1796.25,2169.681,1801.25,2171.681,1799.25,2169.681" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="1799.25" y="2160.2765">extract ciphertext as extractedCiphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2185.534" y2="2185.534"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2185.534" y2="2192.034"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2192.034" y2="2192.034"/><polygon fill="#181818" points="1801.25,2190.034,1796.25,2192.034,1801.25,2194.034,1799.25,2192.034" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="283" x="1799.25" y="2182.6295">check if session id already exists, and store the value at the bool variable sessionIdASFoundFlag</text><path d="M1765.5,2199.534 L1797,2199.534 L1797,2204.387 L1792,2209.387 L1765.5,2209.387 L1765.5,2199.534 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="171.5" x="1765.5" y="2199.534"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1773" y="2206.9825">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1804.5" y="2206.4135">[extractedSessionIdUuidFormat does not exist]</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2221.24" y2="2221.24"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2221.24" y2="2227.74"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2227.74" y2="2227.74"/><polygon fill="#181818" points="1801.25,2225.74,1796.25,2227.74,1801.25,2229.74,1799.25,2227.74" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="1799.25" y="2218.3355">Throws an exception</text><polygon fill="#181818" points="2392.5,2245.0931,2397.5,2247.0931,2392.5,2249.0931,2394.5,2247.0931" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2395.5" y1="2247.0931" y2="2247.0931"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="73" x="1799.25" y="2244.1886">hexToBytes(extractedIv)</text><polygon fill="#181818" points="1801.25,2260.9461,1796.25,2262.9461,1801.25,2264.9461,1799.25,2262.9461" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2400.5" y1="2262.9461" y2="2262.9461"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="1804.25" y="2260.0416">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2278.7991" y2="2278.7991"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2278.7991" y2="2285.2991"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2285.2991" y2="2285.2991"/><polygon fill="#181818" points="1801.25,2283.2991,1796.25,2285.2991,1801.25,2287.2991,1799.25,2285.2991" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1799.25" y="2275.8946">store new iv in bytes for that session id</text><polygon fill="#181818" points="2392.5,2299.1521,2397.5,2301.1521,2392.5,2303.1521,2394.5,2301.1521" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2395.5" y1="2301.1521" y2="2301.1521"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="216.5" x="1799.25" y="2298.2476">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, iv)</text><polygon fill="#181818" points="1801.25,2315.0051,1796.25,2317.0051,1801.25,2319.0051,1799.25,2317.0051" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2400.5" y1="2317.0051" y2="2317.0051"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="1804.25" y="2314.1006">plaintext</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2332.8581" y2="2332.8581"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2332.8581" y2="2339.3581"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2339.3581" y2="2339.3581"/><polygon fill="#181818" points="1801.25,2337.3581,1796.25,2339.3581,1801.25,2341.3581,1799.25,2339.3581" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="212.5" x="1799.25" y="2329.9536">build server's confirmation with server id, extracted session id, plaintext</text><polygon fill="#181818" points="2392.5,2353.2111,2397.5,2355.2111,2392.5,2357.2111,2394.5,2355.2111" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="2395.5" y1="2355.2111" y2="2355.2111"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="1799.25" y="2352.3066">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="1801.25,2369.0641,1796.25,2371.0641,1801.25,2373.0641,1799.25,2371.0641" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1798.25" x2="2400.5" y1="2371.0641" y2="2371.0641"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="5" x="1804.25" y="2368.1596">iv</text><line style="stroke:#181818;stroke-width:0.5;" x1="1795.75" x2="1816.75" y1="2386.9171" y2="2386.9171"/><line style="stroke:#181818;stroke-width:0.5;" x1="1816.75" x2="1816.75" y1="2386.9171" y2="2393.4171"/><line style="stroke:#181818;stroke-width:0.5;" x1="1796.25" x2="1816.75" y1="2393.4171" y2="2393.4171"/><polygon fill="#181818" points="1801.25,2391.4171,1796.25,2393.4171,1801.25,2395.4171,1799.25,2393.4171" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="115.5" x="1799.25" y="2384.0126">store new iv in bytes for that session id</text><polygon fill="#181818" points="2395,2407.2701,2400,2409.2701,2395,2411.2701,2397,2409.2701" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1798.25" x2="2398" y1="2409.2701" y2="2409.2701"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="183" x="1801.75" y="2406.3656">encryptMessageAes256CbcMode(plaintext, symmetricKey, iv)</text><polygon fill="#181818" points="1803.75,2423.1231,1798.75,2425.1231,1803.75,2427.1231,1801.75,2425.1231" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="1800.75" x2="2400.5" y1="2425.1231" y2="2425.1231"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="30.5" x="1806.75" y="2422.2186">ciphertext</text><line style="stroke:#181818;stroke-width:0.5;" x1="1798.25" x2="1819.25" y1="2440.9761" y2="2440.9761"/><line style="stroke:#181818;stroke-width:0.5;" x1="1819.25" x2="1819.25" y1="2440.9761" y2="2447.4761"/><line style="stroke:#181818;stroke-width:0.5;" x1="1798.75" x2="1819.25" y1="2447.4761" y2="2447.4761"/><polygon fill="#181818" points="1803.75,2445.4761,1798.75,2447.4761,1803.75,2449.4761,1801.75,2447.4761" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="244" x="1801.75" y="2438.0716">built server confirmation message with server id, extractedSessionId and plaintext</text><path d="M1596.5,2433.3731 L1596.5,2446.8731 L1788,2446.8731 L1788,2438.3731 L1783,2433.3731 L1596.5,2433.3731 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1783,2433.3731 L1783,2438.3731 L1788,2438.3731 L1783,2433.3731 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="1599.5" y="2442.8216">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="1798.25" x2="1819.25" y1="2466.0057" y2="2466.0057"/><line style="stroke:#181818;stroke-width:0.5;" x1="1819.25" x2="1819.25" y1="2466.0057" y2="2472.5057"/><line style="stroke:#181818;stroke-width:0.5;" x1="1798.75" x2="1819.25" y1="2472.5057" y2="2472.5057"/><polygon fill="#181818" points="1803.75,2470.5057,1798.75,2472.5057,1803.75,2474.5057,1801.75,2472.5057" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154.5" x="1801.75" y="2463.1012">built "client_message_exchange" response message</text><path d="M1594,2453.9761 L1594,2476.4761 L1788,2476.4761 L1788,2458.9761 L1783,2453.9761 L1594,2453.9761 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M1783,2453.9761 L1783,2458.9761 L1788,2458.9761 L1783,2453.9761 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="1597" y="2463.4246">Server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="124.5" x="1597" y="2472.2777">with extractedSessionId, iv and ciphertext</text><polygon fill="#181818" points="983.5,2489.0352,978.5,2491.0352,983.5,2493.0352,981.5,2491.0352" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1790.25" y1="2491.0352" y2="2491.0352"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="172" x="986.5" y="2488.1307">HTTP 201 OK (Server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2506.8882" y2="2506.8882"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2506.8882" y2="2513.3882"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2513.3882" y2="2513.3882"/><polygon fill="#181818" points="983.5,2511.3882,978.5,2513.3882,983.5,2515.3882,981.5,2513.3882" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="67.5" x="981.5" y="2503.9837">Parse requestMS body</text><path d="M954.5,2520.8882 L986,2520.8882 L986,2525.7412 L981,2530.7412 L954.5,2530.7412 L954.5,2520.8882 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="126" x="954.5" y="2520.8882"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="962" y="2528.3367">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="84.5" x="993.5" y="2527.7676">[requestMS.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2542.5942" y2="2542.5942"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2542.5942" y2="2549.0942"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2549.0942" y2="2549.0942"/><polygon fill="#181818" points="983.5,2547.0942,978.5,2549.0942,983.5,2551.0942,981.5,2549.0942" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="981.5" y="2539.6897">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2568.4472" y2="2568.4472"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2568.4472" y2="2574.9472"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2574.9472" y2="2574.9472"/><polygon fill="#181818" points="983.5,2572.9472,978.5,2574.9472,983.5,2576.9472,981.5,2574.9472" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="127.5" x="981.5" y="2565.5427">extract session id as extractedSessionIdMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2590.8002" y2="2590.8002"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2590.8002" y2="2597.3002"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2597.3002" y2="2597.3002"/><polygon fill="#181818" points="983.5,2595.3002,978.5,2597.3002,983.5,2599.3002,981.5,2597.3002" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92.5" x="981.5" y="2587.8957">extract iv as extractedIvHexMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2613.1532" y2="2613.1532"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2613.1532" y2="2619.6532"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2619.6532" y2="2619.6532"/><polygon fill="#181818" points="983.5,2617.6532,978.5,2619.6532,983.5,2621.6532,981.5,2619.6532" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="132" x="981.5" y="2610.2487">extract ciphertext as extractedCiphertextMS</text><polygon fill="#181818" points="1712.25,2633.5062,1717.25,2635.5062,1712.25,2637.5062,1714.25,2635.5062" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="2635.5062" y2="2635.5062"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="94.5" x="981.5" y="2632.6017">hexToBytes(extractedIvHexMS)</text><polygon fill="#181818" points="983.5,2649.3592,978.5,2651.3592,983.5,2653.3592,981.5,2651.3592" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="2651.3592" y2="2651.3592"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="43.5" x="986.5" y="2648.4547">extractedIvMS</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2667.2122" y2="2667.2122"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2667.2122" y2="2673.7122"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2673.7122" y2="2673.7122"/><polygon fill="#181818" points="983.5,2671.7122,978.5,2673.7122,983.5,2675.7122,981.5,2673.7122" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="60.5" x="981.5" y="2664.3077">store extractedIvMS</text><polygon fill="#181818" points="1712.25,2687.5653,1717.25,2689.5653,1712.25,2691.5653,1714.25,2689.5653" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="2689.5653" y2="2689.5653"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="264.5" x="981.5" y="2686.6607">decryptMessageAes256CbcMode(extractedCiphertextMS, symmetricKey, extractedIvMS)</text><polygon fill="#181818" points="983.5,2704.9183,978.5,2706.9183,983.5,2708.9183,981.5,2706.9183" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="2706.9183" y2="2706.9183"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="26.5" x="986.5" y="2704.0138">plaintext</text><path d="M770.5,2696.0653 L770.5,2709.5653 L970.5,2709.5653 L970.5,2701.0653 L965.5,2696.0653 L770.5,2696.0653 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,2696.0653 L965.5,2701.0653 L970.5,2701.0653 L965.5,2696.0653 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="189.5" x="773.5" y="2705.5138">Mallory build client's request response instead of the real server</text><polygon fill="#181818" points="1712.25,2722.2713,1717.25,2724.2713,1712.25,2726.2713,1714.25,2724.2713" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="2724.2713" y2="2724.2713"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="92" x="981.5" y="2721.3668">generateRandomIV(_ivLength)</text><polygon fill="#181818" points="983.5,2738.1243,978.5,2740.1243,983.5,2742.1243,981.5,2740.1243" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="2740.1243" y2="2740.1243"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="15" x="986.5" y="2737.2198">ivAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2755.9773" y2="2755.9773"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2755.9773" y2="2762.4773"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2762.4773" y2="2762.4773"/><polygon fill="#181818" points="983.5,2760.4773,978.5,2762.4773,983.5,2764.4773,981.5,2762.4773" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="182" x="981.5" y="2753.0728">store new iv in bytes for that session id for Alice -&gt; Mallory leg</text><polygon fill="#181818" points="1712.25,2776.3303,1717.25,2778.3303,1712.25,2780.3303,1714.25,2778.3303" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="1715.25" y1="2778.3303" y2="2778.3303"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="193" x="981.5" y="2775.4258">encryptMessageAes256CbcMode(plaintext, symmetricKey, ivAM)</text><polygon fill="#181818" points="983.5,2792.1833,978.5,2794.1833,983.5,2796.1833,981.5,2794.1833" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1720.25" y1="2794.1833" y2="2794.1833"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="40.5" x="986.5" y="2791.2788">ciphertextAM</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2810.0363" y2="2810.0363"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2810.0363" y2="2816.5363"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2816.5363" y2="2816.5363"/><polygon fill="#181818" points="983.5,2814.5363,978.5,2816.5363,983.5,2818.5363,981.5,2816.5363" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="267.5" x="981.5" y="2807.1318">built fake server confirmation message with server id, extractedSessionIdMS and plaintext</text><path d="M779,2802.4333 L779,2815.9333 L970.5,2815.9333 L970.5,2807.4333 L965.5,2802.4333 L779,2802.4333 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,2802.4333 L965.5,2807.4333 L970.5,2807.4333 L965.5,2802.4333 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="181" x="782" y="2811.8818">Server builds body response for the request of the fake client</text><line style="stroke:#181818;stroke-width:0.5;" x1="978" x2="999" y1="2835.0658" y2="2835.0658"/><line style="stroke:#181818;stroke-width:0.5;" x1="999" x2="999" y1="2835.0658" y2="2841.5658"/><line style="stroke:#181818;stroke-width:0.5;" x1="978.5" x2="999" y1="2841.5658" y2="2841.5658"/><polygon fill="#181818" points="983.5,2839.5658,978.5,2841.5658,983.5,2843.5658,981.5,2841.5658" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="168.5" x="981.5" y="2832.1613">built fake "client_message_exchange" response message</text><path d="M761.5,2823.0363 L761.5,2845.5363 L970.5,2845.5363 L970.5,2828.0363 L965.5,2823.0363 L761.5,2823.0363 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M965.5,2823.0363 L965.5,2828.0363 L970.5,2828.0363 L965.5,2823.0363 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="197" x="764.5" y="2832.4848">Fake server constructs JSON "client_message_exchange" response</text><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="154" x="764.5" y="2841.3378">with extractedSessionIdMS, ivAM and ciphertextAM</text><polygon fill="#181818" points="273.75,2858.0953,268.75,2860.0953,273.75,2862.0953,271.75,2860.0953" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="975" y1="2860.0953" y2="2860.0953"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="187" x="276.75" y="2857.1908">HTTP 201 OK (Fake server's Message exchange JSON response)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2875.9483" y2="2875.9483"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2875.9483" y2="2882.4483"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2882.4483" y2="2882.4483"/><polygon fill="#181818" points="273.75,2880.4483,268.75,2882.4483,273.75,2884.4483,271.75,2882.4483" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="58" x="271.75" y="2873.0438">Parse request body</text><path d="M235.5,2889.9483 L267,2889.9483 L267,2894.8013 L262,2899.8013 L235.5,2899.8013 L235.5,2889.9483 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="32.206" style="stroke:#000000;stroke-width:0.75;" width="118" x="235.5" y="2889.9483"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="2897.3968">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="76.5" x="274.5" y="2896.8278">[request.status_code != 201]</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2911.6544" y2="2911.6544"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2911.6544" y2="2918.1544"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2918.1544" y2="2918.1544"/><polygon fill="#181818" points="273.75,2916.1544,268.75,2918.1544,273.75,2920.1544,271.75,2918.1544" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="271.75" y="2908.7499">Throws an exception</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2937.5074" y2="2937.5074"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2937.5074" y2="2944.0074"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2944.0074" y2="2944.0074"/><polygon fill="#181818" points="273.75,2942.0074,268.75,2944.0074,273.75,2946.0074,271.75,2944.0074" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="118" x="271.75" y="2934.6029">extract session id as extractedSessionId</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2959.8604" y2="2959.8604"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2959.8604" y2="2966.3604"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2966.3604" y2="2966.3604"/><polygon fill="#181818" points="273.75,2964.3604,268.75,2966.3604,273.75,2968.3604,271.75,2966.3604" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="83" x="271.75" y="2956.9559">extract iv as extractedIvHex</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="2982.2134" y2="2982.2134"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="2982.2134" y2="2988.7134"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="2988.7134" y2="2988.7134"/><polygon fill="#181818" points="273.75,2986.7134,268.75,2988.7134,273.75,2990.7134,271.75,2988.7134" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="122.5" x="271.75" y="2979.3089">extract ciphertext as extractedCiphertext</text><polygon fill="#181818" points="904,3002.5664,909,3004.5664,904,3006.5664,906,3004.5664" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="907" y1="3004.5664" y2="3004.5664"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="85" x="271.75" y="3001.6619">hexToBytes(extractedIvHex)</text><polygon fill="#181818" points="273.75,3018.4194,268.75,3020.4194,273.75,3022.4194,271.75,3020.4194" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="912" y1="3020.4194" y2="3020.4194"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="34" x="276.75" y="3017.5149">extractedIv</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="3036.2724" y2="3036.2724"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="3036.2724" y2="3042.7724"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="3042.7724" y2="3042.7724"/><polygon fill="#181818" points="273.75,3040.7724,268.75,3042.7724,273.75,3044.7724,271.75,3042.7724" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="51" x="271.75" y="3033.3679">store extractedIv</text><polygon fill="#181818" points="904,3056.6254,909,3058.6254,904,3060.6254,906,3058.6254" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="907" y1="3058.6254" y2="3058.6254"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="245.5" x="271.75" y="3055.7209">decryptMessageAes256CbcMode(extractedCiphertext, symmetricKey, extractedIv)</text><polygon fill="#181818" points="273.75,3072.4784,268.75,3074.4784,273.75,3076.4784,271.75,3074.4784" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="270.75" x2="912" y1="3074.4784" y2="3074.4784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="276.75" y="3071.5739">decryptedCiphertext</text><path d="M235.5,3081.9784 L267,3081.9784 L267,3086.8314 L262,3091.8314 L235.5,3091.8314 L235.5,3081.9784 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.75;"/><rect fill="none" height="70.912" style="stroke:#000000;stroke-width:0.75;" width="192.5" x="235.5" y="3081.9784"/><text fill="#000000" font-family="sans-serif" font-size="6.5" font-weight="bold" lengthAdjust="spacing" textLength="9" x="243" y="3089.4269">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.5" font-weight="bold" lengthAdjust="spacing" textLength="151" x="274.5" y="3088.8579">[decryptedCiphertext.find(clientMessageSent) == true]</text><path d="M270.5,3094.3314 L270.5,3107.8314 L393.5,3107.8314 L393.5,3099.3314 L388.5,3094.3314 L270.5,3094.3314 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M388.5,3094.3314 L388.5,3099.3314 L393.5,3099.3314 L388.5,3094.3314 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="112.5" x="273.5" y="3103.7799">Connection Test Result: Success (true)</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="235.5" x2="428" y1="3111.1844" y2="3111.1844"/><path d="M270.5,3114.1844 L270.5,3127.6844 L391.5,3127.6844 L391.5,3119.1844 L386.5,3114.1844 L270.5,3114.1844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><path d="M386.5,3114.1844 L386.5,3119.1844 L391.5,3119.1844 L386.5,3114.1844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.25;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="110.5" x="273.5" y="3123.6329">Connection Test Result: Failure (false)</text><line style="stroke:#181818;stroke-width:0.5;" x1="268.25" x2="289.25" y1="3142.3905" y2="3142.3905"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.25" x2="289.25" y1="3142.3905" y2="3148.8905"/><line style="stroke:#181818;stroke-width:0.5;" x1="268.75" x2="289.25" y1="3148.8905" y2="3148.8905"/><polygon fill="#181818" points="273.75,3146.8905,268.75,3148.8905,273.75,3150.8905,271.75,3148.8905" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="62" x="271.75" y="3139.486">Throws an exception</text><polygon fill="#181818" points="50.75,3166.2435,45.75,3168.2435,50.75,3170.2435,48.75,3168.2435" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:2.0,2.0;" x1="47.75" x2="260.25" y1="3168.2435" y2="3168.2435"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="64.5" x="53.75" y="3165.339">connectionTestResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="45.25" x2="66.25" y1="3186.5965" y2="3186.5965"/><line style="stroke:#181818;stroke-width:0.5;" x1="66.25" x2="66.25" y1="3186.5965" y2="3193.0965"/><line style="stroke:#181818;stroke-width:0.5;" x1="42.75" x2="66.25" y1="3193.0965" y2="3193.0965"/><polygon fill="#181818" points="47.75,3191.0965,42.75,3193.0965,47.75,3195.0965,45.75,3193.0965" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="6.5" lengthAdjust="spacing" textLength="42.5" x="48.75" y="3183.692">Program ends</text><!--SRC=[nLnjRziu4lxkNy7BuH0PyFfs5zZ3eRWkOETbazsw3UfqWVkoXYmnDX5Pyacoqzoll-6hI96KA3lRwuV2SJZ3cU7CF3D3jbKIPnXzF_rfD5eNNz75LKPmNgER_4ZA8j_1vmlqrmzaiwt_ZREiU1aX-BEFoveaP1_3oejTJ78KbOUSa_umla1nXHRmhRrMS8_cnPelur_u5hwx9azF1D_1phiurmYkx_maTmzn6U-g3qMSujAWuLzvAHUugk8DllbQbt5IaoA_ZHEIaVfLOxAukVNIt-H9-RgdX5_gDjtDbn7EKmGc5dQUrNMSFEFIPUcheempUvj530TGlWhpii_UHQRbK5GNGf2nJdvzvxE_dyqIbqTSjjZmBplOs8UYQ7sd8ccxZqMiSfwBvE0-6F5RwsIuBgvpcMS7REyYraUpXtjk5Vu5_EXRwt1h_WkNMqiIsuAIncT0GTbjFxx8QJv1xxOU_wLkFChy6DUOX_w8_es- -rcu7Ng7hafCVyj_ZYuW1LnCK8hNXyrj5c_63RtmoP6WL3okxnekXWKZFnTXKSL0OyRD1Ymp-72zPUR5DIwhQ8Dh_UTRak4SFdyeafYQ8HgF3QQ2qNUce9znVIZp2ec3OvpGBjvxvG6Q3Svn2S8_b4o7t_1hD0vQVrXd9EbQ3WSCw-VtltpyidWixl3NQBMNH5FGrzI9hcwfmxT0i1pDKBJ5NyUZ5Dl6RdOsZjwHpH79gphE4upWHDDNXyEa-dBO-EPhietp3OxsPP4Uc2i_56LjUqwZICFlvejcholgqCMcZFTRadmiG8WeftyloN-nRWSWClH8s0T602OSiPLv0Hjd-8blgssT5A1W2N9MwDVbfu_eWbEljXH7BzJg5r9l1UFxTA9lCL5hDcLns7y49veWTMepzbiQVLI2KKjfaTn0vhl7nmVqy6dvYFx-tDWGHNmjjMx1vEDwQq7C0KR9mFGiQHfKNz4_SYEIWuCdU5zBn6ESfyRQvHOZpDDGfIc2Ob12qxiXChNJjsjKb1WMa1iaaxQI1WosTbBizHtzgMFivg6b25lipamH8exYvCqVFOUeMrRoW1FYN12u3RhShU9BWqQTpUbIjhBM026JOhS_C1bvMg8YBbOpz1v5cpz0r37w6zgV8svelcnnaedJLbhBdrHGda4bjPP9VIvfYMe4kRjSKnbMA_zajlK7rC1CgJ4HwR8HQyS_CRh7GXR_J7KphnZvqpnebKIt4435Iwwd5wJgKOEOfLJ1WUPKbnWJWyALODan2IwNXgSz5QKiWyDIbQe8E_9nivCxCnk9goanpGIhzcbj2ecbmXPZ53sLnKuA6Xo4ek1LcLnP6lniI_Bd2f4QrE0P7TrVZoSM2xTZEAYPipaOcAVa86pWPJnr9u8-ovqG1mqd4Ghw6LJiirayT6mVLEtgF5hE8IfVUnTU5fhDGp-KwVGQccco1i6OJumGyEfnIyqrFHYslhI8dB0G8gG7ky9bL10svwYrjZ5he813CQlX8c5BKrJ3gtaBhLg8vNItHhfM5BWwOAiL28eDS45onCjjNE9qYPCI5DIpmgGLS6uO61f20y-sOjA195GyL5sk5gibFMuZVVqXlHH-dhkzWFvvt198SHMgeOes-Qvn_O9nhX27rjDSakaf_jGwiHKtTBfytK5GbqniiETgiUprYA0KY_byGOmfPhZwyQT_NAsJHP7Y2E3_YPGxrdOlgisaGvY9Yitq_XYOac7I0LL53KX6jR7npofBZ3CssxiILtlu2f2SBs0mQmSSgqqgq1KqehM9vgHQxJ6VE0wEcGbENJSAYWmT9eWSkJbyeGxE0ev_n08jA_07acze8SKcCgeE6Gy3JRlb_F7x7z2dtmnhjAePosECUYQytzHswEWt0soEFBOSsf0AIv_Ja3ggsZRxDsz8bTZ36bA7E8hJdzgGheSqf45IldL3EfSDwNfeGsg9-rODgLBQQ4Zd0GrfooKjKOSsfAA3wcz8DQ6xC7_kQVHQTS30g1jozYsqjy1-Ra0zMDqDzWRGG_X9XZ1rzyCV0YoW1C9K5Kdnz0H_Cmun0Fax7ALln93Y3jmt4t4NwfEZWNPjSU26mg6mDQaGmk3q8OifjF2AmA-bnhO7gFBY1MrZVffg5nF3Tzm4Y7NZpI7QO9P03D5m0Um6PozWG0v0M2Fo19mh0hvtykYqAx1cazRWkw-K3fgldXDOizN22AnPAx1c0O7bhA1dm0-p-bd8C3rXY1WKGxD5oFIlBuQwQcUdIw_s1PH1w-nrnTo7u7JI8U84vVZbbwQiXg_EZZGjj3jj0EnEdn7gHQUQVTepmWByZ-HnvYaEjQ7Ss1WCjihpWD9SDvmkEws_6x6ruY5Yy02oKsTD72FBNVnC2tVkiQAePqWE3WwLl36nd3htFe3MF1QOoa31HbeG6hWfhy513E92dwx4r3y0UJ2zoDsBLa80KPN0fMb9MYNvRK6nQRS7mU0ccIeEj1bchKZyohQ6wUfBNAPSDEs4rB6O7ADF9G9fWDE4K-HSWuh6eh0V9wO0Ugbbiaiso9Ms5ouGDD7LxmIDPgSPuhhR7jlDHyxRIZMoRRFHsanxTkj8gO9TJnTaE7hdhUDSrv6wwCGCQDaqYT3sNK_gbz9GU3uMyrVmfqZI-k-YOJqvekY8axee_tK0D_tdglvvxBNY4fPHApAjh-Cw1i-6XATNfGlZJhvrmzvJSBP7J2PEjgvKZHS97H2exe_TwDUQ7vb5fGFv-b5FpjzPBXcxuS-2FlTDlmTB1E_lP0H1Jh82Gfd7TvPwSkLnyLa4GpITJft6RiU1-HmWi0AbNktHYxgx0n7Lcozp-_Pp0XkXVJSobfbqTFGc3nT_SmJJxu7WBvLC7-0v43PPMhKgKq9JY3nQaRvXROoESKRWLaZM74ZM72OMwkTASpZuAYFaAFf2iWnbv1a3_JwkgW0KPEd_a2Hmha-7B6E5vEwGauHMCHpv0I5xVTiyh6XT59ac6FZU8QFT9NW3IA1iBRp9uzxyrEAijZYXz-yHL37OSQpiPSmxzA7OLEY2TzH8jjIqLi3o4f4fZTCB5i9Dio7wYy1J1_CVyXZE4DFUGh2KTXEdFA4yEeo8Ct0_buPFCVpc71MVOdYDbLv8T1cD72QsNXBjv1Cu-O08dWtn3FBni5lJoa7XudWq_3dHPp1tiRl_FLgHumUSR-gjCndrvWCefkv_BukQkkceC-mzujHGNa4S0VaZ0PthUBUFJXQ5ibXI5iD40UBrWS1fowwM5MAjLqvQ6QBlH2iqlaX4qLA5Z5FZhlO7-AgqrzlZABEVPYsxfmasbxIMV1qchBQI3dzXHE_WnsOMkv7l8aAt0d-HfPGQ_jAi5N3G2hd5wNfvvczz9RwL-3y7y79uVffsBnVu9TL504gnXcfBQOKW9b1_DiJtno2QnfR6nbUDYJlP95kSFDCnZwv0nWQdm8nKTJLXHrQnQfSMUf1x3p38gDaF0hbA4gypt9pvR7bR7FAKNaKq9KnMEnVOkTidw-EsB5wWDSnfpiRitR2E4UfpvsZ3w0gKkUwFPqyVoB5lwD2b6xSlxNd12G1ZrbG-raNMsrXthr6FTbsLfyCx865gUMl2j3ZR57kP7SFi4JYCeTaCoiJuMKujL9IANXoyLdRp_WBCRRK-l3tBBqB7lMVv1VlEUXW6rjpqUKmNrEqRd6lxoHkCnflS5MgYGQv2axVo4Mwo7YVfF0gEfip_mY2rNqx6x6ISTM4jFHSNnfxwaD22Mot-kZ3NE2p7PNp_sy9EAEuY2uNaBmUIygfs45iVI8VG3W3hBdRV3hGbS7TP3wK5hbZNnlRsl0wnjUY2S-ck0Uzy-W7TuOAj1DNvb8SSkryZjNZvr3q1uJjqFXlctymyDjZxh1Jse9ZdRdLnODnxY6p7a8r0jckcHutv9Xw9GgmQKWPy6szwOvSQQeWJQu9EAxNJVk3xkK715wOXCnw7yqezkRClpRtUff8WoxADkmrxviSSlP9LYhXxQSeKZdh54_jHGztJdfnhAlkB5oL5kuevwTbYm3xkDuosdISCTTrLZVVs_DG7XVJwINY0KTWeiRL_OjBzqB1tlW2rcb7MKAXLlvh2bAq-LAi4WWxzvJsLykmM-Krc6Lgn7ZpDe8WCKx50qjuwINzJwtd0uAuAc0ndDouQmzEREoGJkCdjRVjx-ex9pDB6Rj-grH_Kj_6y0M4eaw3A5_IL7tsa9B9YKCF__-pylyb4Y7t7hwcqxV-ynlzDN-e4FzJfwSZFmt7HCpkGtEslRuJWRpXty4AtMu5RqsPduRO7i_aBojcYXTlQWP_o34OJF02dXpoCySuRD53kWcIRdm-C5H3R98Ek4_paBkZj8GaSJJWloxnGUzgTbyR3U-FbkH-q0DKdzTaTj3LfEFc9nfLPqthlzwWVEeYcJoHF8-jkSspT-dzKT_Cq9ydploho7BF_yG8zKhVd5-hml8c_Se3tzC1ZhAxUJ-Hs2tVhXvAD3xDA-sUjPmHDSxMVg4tfddpBpjjxGVTGqdzskwEigv6H9aW- -Xy0]--></g></svg>