def hex_to_bytes(hexstr):
    return bytes.fromhex(hexstr)

def calculateSServer(A_hex, v_hex, u_hex, b_hex, N_hex):
    # Convert all inputs to integers
    A = int(A_hex, 16)
    v = int(v_hex, 16)
    u = int(u_hex, 16)
    b = int(b_hex, 16)
    N = int(N_hex, 16)
    # S = (A * v^u) ^ b mod N
    Avu = (A * pow(v, u, N)) % N
    S = pow(Avu, b, N)
    # Return as uppercase hex string, padded to even length
    S_hex = format(S, 'X')
    if len(S_hex) % 2 != 0:
        S_hex = '0' + S_hex
    return S_hex.upper()

if __name__ == "__main__":
    A_hex = (
        "F6FDBCA9750B211E9A12DE1D60E54C7942C65D1D30826E552824E10A0777FEA1"
        "B38EE8CE5F2AC5D3BE76886D3F630EF44584382E8C303D8249420D08586B52F0"
        "81D10B0D9C4187D9CE7153E5E3190B309E7255296BDD9E4166A515C48848BF6A"
        "0F18C8C711D75429628D0A209FC603A808683D526B651F0C43F82268C203F054"
        "3ED36219F7B4534F445B7025DB6799E8EA3290682EC59DB2872EC9455BCA3B31"
        "B6EF6C552E7CBC384270A87383AB60CA99CD72889E0F64B00DD01E00E4F4192A"
        "6DBCB55ADF0C2523F177F964B4DA78AA5D022BCDEF265888C446730B19CED207"
        "3C7123FE53FF0893A486C01B4B9B1433F7A8A7689C1A4A7E99AF13B4A9248523"
        "B815BAD5D14BC94C7A05114540D9F75DCDA5BB468BF2D2FDE33D5D6634BDA360"
        "69A7CA3690BBEF1CC5BF22D41A9A9785EA962BE8C2933E07B53709C1D58D1E48"
        "6B472BEF3F8FA4722AC5B64AB49823A9BD1076C9DC7979E62EA3C230586E2A97"
        "D163CC2E000C9F54E1F43AAB8DBB1C54768DFA9E3553D94EE76107969E992325")
    v_hex = (
        "1568E0B0AE00EA52EB8FE8442E1410AB59F17507D3C41B77E3CA36646CD9090D"
        "AEA70CC690BE9DD640FCE59C70DE913AFE98B68F6B116F28972EBF46C5C31DD0"
        "70A438DB0A0F68CBF66A3B41EA29B14891F4F58FC7A0BD75C2FA240DA70363B4"
        "4858B1531D05352BD1DFFB783C7F57D4720BD571FBB2D5C44A36A653A5B83F00"
        "98ECCDC8A22D9499EA1F4D114DDF4405F328BA816413D49136CB7D9919C36658"
        "94BD7603B9F1B5A9A66FFDCE170B39CA7F785E5002F39DFD949463393760B472"
        "96D229E9B3FBF49DFE2CB2915B25F9CEFDFCF3F97A25C24C5E33FBEE6C8F5C13"
        "56EE491549C91E932FDD7DDA4C68C2F7B3D637C798A89674C634973321567CB9"
        "C3D137F28109B5020E2588E08ABE0B38FD488FB8CB1A67E24C2CC6D3DEDC8FC4"
        "650DF9DDB296D6FE8E6366E387CF5F7B12D71DDD5E4337F90044006F2AB61C0B"
        "3BB02053E7365CC9E4F013EE6A44E9FC47B46E94DC7A4DE30A43D3D1BC395233"
        "58FD79F43B7C500ACD3A0F9908879909EB3AD25A36A66FF800297D6CC1159448"
        "909369E4FCDE5C83EA78AD17E31F96901DAE523230816E22E151ED1BEC6206BA"
        "3B2A475414694086342C434A10654EB6285D66B393E2D8C185BF667E2CE1726D"
        "49A61EEFCE89F23E6F37682002B056D55839FA0C1BF7A399878FC7CD6F9D5C3A"
        "7AFF2C4D709E90DBA3A562997F75593DA5EE0223362D5AD17CB8B45AD7D5D3F6"
        "D619DB80A1DBAC894AA4AE8D7E72D2B17F64BA3DCBC224229ED8AA8A39BB2812"
        "5D5FB29BCB4C2920FD231DB297307FE93727795DB1C37715ADAA62737A4DA13E"
        "0504EC7E42B60823667B1C69E2DF891355573B713C8CCB3533BCBC4BBCFFAB58"
        "B22EF2991D68642FFFF4E6C753C827A37A966638A16C23D41CB93CD638CB031B"
        "46F34257454B3D017077611070C9CA3ADFFA040987E52A2A363463A1D28F0076"
        "7046BD023636C0C3939965B380FB22154923A0EB19F28570093BF2C5208C85CC"
        "F69BFD00C30F731FF453F28CC6FCF1EA7FA4660C5547363CC6DB47ADBC2D034E"
        "4C46756087269CB9AC24644EE2CF632326BCBFE3479D61B1721D95C2A856E909"
        "2C39F2060E2F26131F2DCA79506915258B17DA7753ECFFAD6CB3F40918EE801D"
        "6776219A8C741A028BC9649ED8E704C1F119DBE277822A135E069E338DFF1245"
        "199FB0363B68F12FE377CFEFC05F4CEBDBA130AC3E5ABB68FB38D8ECC6164077"
        "808F635D9C5390E4E67E34025FCD58330F979A8AF77EFDC281EB06DA37FACB0E"
        "6AFC42D58253C64390A955C01C02412F68BE5C0F141F550AC9083E160D1CB27E"
        "6104C5EAA0BCCE3A0EBEB3675BB1394D7844D6EA7C9BB70626EBC8459F584925"
        "B2D4F3F7DFA46C34BF6F5FE04BB842965A75B4714003F5C20D8279E2183D6D54"
        "CCEE840C9A76BCB83F633B98E4E141BFF5EE1D8DCCC4F2932C693A1A5ED474DE")
    u_hex = (
        "121F773DEE392FF993A08983C3818EA4B9EA5599607E2745C35CB145A9A581FD"
        "F59D663345EAD48EC3D96B85BDE691DC46FB4E62446F0C52B5120D2FFBD7C340")
    b_hex = (
        "9CB52A1B2C3E796FA127EB79236B7141618AEBB9313ED7E35502B7DF63123C"
        "64FB935E4160F89DE3748254A045EF5F69305619A21C7E7ECC82A55BA8DBA6"
        "683F8F457CB600FD21EF6AB53ED14C35AF00C62CA77B0BDFFC115D13174821"
        "3577BE2D58712A4FED86837859AD124167D3BE3578FE1BAAFAEDE0AEB96E88"
        "8C6536CA32377BACDDEB3B52F593EB4D43D6313AECBEDE807C68B185869307"
        "BDFB0B775DC738503BFA7CFCB7D93C2894EBB2312EA6B6A3D45AA7B6F829EA"
        "D2AFFA1629C30D9CF65E48DA43A261449822818AA80324C8D37BCD7F94C590"
        "278CF5D926E01F635F46283A6A2257862024D86F8F0518128C766DBFC3F77F"
        "D6BEEF73A7F08CF5B7A142CFBB9FC3B40D820403F42C3001330F2D74353C13"
        "A631C7D219F18C9F8A3C923447A7A5A87D40564A2E8ACEDC69122BFC08D594"
        "C3CB808B9F761EB2567AA4306AA028C71353CCD9C0D292D54BAE912DFB5490"
        "9EB6772D0FB6B1BB8F7E292949B01249149856509DF80C827F1057867CBEDD"
        "065AD8B5FB3FDD9A11A5823EACBF8728CA436A9ECCB9FC88A33434CCE836C6"
        "292323D3CBA33E8BCD0AA5E907B64F1649A0A35E3EC4BAB99D8EA91568C68C"
        "FE8D5A2CD443D8D58D9715CE002A4575C46BAC735A3846ADD2E6CDDAFEFAC8"
        "799A2E339F6FAAA576D1D305C460F9C19D328348067BAEE89A1C6AF6E1D1A5"
        "42D1FBA1E982924D7E4F5257B59156D210F62C623F34BD6B3BC4D31BAE16FF"
        "E19AEF9E906A0B27CD9F908743C78207F5540AAA50DD69B5996A3B8CB57EDB"
        "255719853682E69D8E004DCE5789875DDF8F46A217B8BC6BCDCDC8A98C0491"
        "EB61E1565AA42BFD0DA7CAB35CF3128B61FB820C5321E759EC25C94DBAFE25"
        "09CEB605CC300A19E521DBF2F461B46FDF799B09332D10FB67E3ADC34E0D69"
        "6162F6D0E4BED14480B7A9C555697D86F649D02747278634B6F9EFEEF4B9DA"
        "D7358E68769A8A102085AFE43DF353CB8058B5B6269AED9B39A9105826A59B"
        "3254BC234D416C4917AF0FFACE256E093D4996120E794AC413D36A35FA2E52"
        "F9D8935CC173F70719C5C4072D321946508617A22323581C3170B23FA004E3"
        "465B831BE258C78EDE1C6BC5ADC84FA7ADFD2748E57B86D7B2269036CD07FB"
        "37340B16EB1C47209E7F6BCBF624BFFE81FA586C5BA8C95D7E5B2C8CC64B39"
        "3A9D743B3D05FB5A617E2E209870D852978FA5CBE17836E9C144490418A152"
        "DD72BA5318B48D7D817DEA3794F3013612C25315E7E60774E5305CECDF49B6"
        "D0BFB84572ABB355BF7453ABB30D4D2B3A48041587FEB7BBB983CEF9F8D79C"
        "587DA7A1A594FD8DD6F4013BFA6870BA07AC8FA177B54BAF1FCFB83273DF4C"
        "043670AADE717841C7A95C87BCBF8F554E9F2E81053290ED57F329611C7274"
        "E80DEFA13EE52B39D5705B4BD9B7C8DF3D40CBE48C03AD452617F0F5CDD028"
        "CA")
    N_hex = (
        "FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBE"
        "A63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51"
        "C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE"
        "9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8"
        "FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC98"
        "04F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C5"
        "5DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8A"
        "AAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7D"
        "B3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA"
        "06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD9"
        "46E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788"
        "719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB"
        "04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7"
        "ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FF"
        "B7DC90A6C08F4DF435C93402849236C3FAB4D27C7026C1D4DCB2602646DEC9751E763D"
        "BA37BDF8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918"
        "DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B332051512BD7AF426FB8F4"
        "01378CD2BF5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6D55E702F4698"
        "0C82B5A84031900B1C9E59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54B"
        "D407B22B4154AACC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58B"
        "B7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C04"
        "68043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DBE115974A3926F12FEE5E43877"
        "7CB6A932DF8CD8BEC4D073B931BA3BC832B68D9DD300741FA7BF8AFC47ED2576F6936B"
        "A424663AAB639C5AE4F5683423B4742BF1C978238F16CBE39D652DE3FDB8BEFC848AD9"
        "22222E04A4037C0713EB57A81A23F0C73473FC646CEA306B4BCBC8862F8385DDFA9D4B"
        "7FA2C087E879683303ED5BDD3A062B3CF5B3A278A66D2A13F83F44F82DDF310EE074AB"
        "6A364597E899A0255DC164F31CC50846851DF9AB48195DED7EA1B1D510BD7EE74D73FA"
        "F36BC31ECFA268359046F4EB879F924009438B481C6CD7889A002ED5EE382BC9190DA6"
        "FC026E479558E4475677E9AA9E3050E2765694DFC81F56E880B96E7160C980DD98EDD3"
        "DFFFFFFFFFFFFFFFFF") # prime N from group 7
    S_hex = calculateSServer(A_hex, v_hex, u_hex, b_hex, N_hex)
    print("S_hex:", S_hex)
