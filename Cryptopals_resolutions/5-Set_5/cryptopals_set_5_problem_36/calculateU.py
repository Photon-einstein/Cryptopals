import hashlib

def hex_to_bytes(hexstr):
    return bytes.fromhex(hexstr)

def calculate_u(hash_name, A_hex, B_hex):
    # Convert hex to bytes
    A_bytes = hex_to_bytes(A_hex)
    B_bytes = hex_to_bytes(B_hex)
    # Concatenate A || B
    input_bytes = A_bytes + B_bytes
    # Select hash function
    hash_name = hash_name.lower().replace('-', '')
    if hash_name == 'sha256':
        h = hashlib.sha256()
    elif hash_name == 'sha384':
        h = hashlib.sha384()
    elif hash_name == 'sha512':
        h = hashlib.sha512()
    else:
        raise ValueError("Unsupported hash: " + hash_name)
    h.update(input_bytes)
    return h.hexdigest().upper()

if __name__ == "__main__":
    A_hex = (
        "F6FDBCA9750B211E9A12DE1D60E54C7942C65D1D30826E552824E10A0777FEA1"
        "B38EE8CE5F2AC5D3BE76886D3F630EF44584382E8C303D8249420D08586B52F0"
        "81D10B0D9C4187D9CE7153E5E3190B309E7255296BDD9E4166A515C48848BF6A"
        "0F18C8C711D75429628D0A209FC603A808683D526B651F0C43F82268C203F054"
        "3ED36219F7B4534F445B7025DB6799E8EA3290682EC59DB2872EC9455BCA3B31"
        "B6EF6C552E7CBC384270A87383AB60CA99CD72889E0F64B00DD01E00E4F4192A"
        "6DBCB55ADF0C2523F177F964B4DA78AA5D022BCDEF265888C446730B19CED207"
        "3C7123FE53FF0893A486C01B4B9B1433F7A8A7689C1A4A7E99AF13B4A9248523"
        "B815BAD5D14BC94C7A05114540D9F75DCDA5BB468BF2D2FDE33D5D6634BDA360"
        "69A7CA3690BBEF1CC5BF22D41A9A9785EA962BE8C2933E07B53709C1D58D1E48"
        "6B472BEF3F8FA4722AC5B64AB49823A9BD1076C9DC7979E62EA3C230586E2A97"
        "D163CC2E000C9F54E1F43AAB8DBB1C54768DFA9E3553D94EE76107969E992325"
    )
    B_hex = (
        "F4D69379248D20EED58A337FB5E470B6C3ED3E3020DC88E51FED0DADA1FBAB41"
        "FD5A2E5502E2EC15373D069C309797747F08F1E7AD6453C42BF4858FFEE011AC"
        "1D09DF733B38C0D506B56D4EC8854D1DA15B69A40CB3CD6E12D90C6558C20CE2"
        "C4DB41E271008AE344FEE14BE3B33734D1D09EEEC40FE34DB81E462D608FBFBB"
        "E833EFDFACE5D7BA10DB46EAB4CFF490A99A8D65EAA4214746793286F29EE728"
        "9D7DD61B6DBD499088D80914A8E2ECD1257863C8F5821854605D1D723304DA25"
        "6F66C33CF4A87FE87A27E9CAC7B6A74CE6381587DDAB37FD3B8B70CE8B191B66"
        "F4ED27C8356CD02C6DC269C0651DB09EE07CE22064002DD624AFADAFF5393AC0"
        "422FABE39B1928B0B299B35311FDB46EE35C7E9FAC2467469A61705275B06D36"
        "FC588007F077B674126A56228C7B836271531293FBAE7FAA9F08E852F67C65EA"
        "2C598A9D7090BA64FE89A3364F87FE7B27BBED1862A01A42A348CD64AFEE58CC"
        "CA02B0764B813608C0A98DC9F815294D26746DF7DC28B79C6EABF08017406C06"
    )
    hash_name = "SHA-512"
    u = calculate_u(hash_name, A_hex, B_hex)
    print(f"u = {u}")